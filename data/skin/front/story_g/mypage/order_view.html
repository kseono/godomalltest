{*** 마이페이지 > 주문상세 | mypage/order_view.php ***}
{ # header }

<div class="contents">
    <div class="contents-inner mypage">

        <!-- 마이페이지 회원 요약정보 -->
        {=includeWidget('mypage/_member_summary.html')}
        <!-- 마이페이지 회원 요약정보 -->

        <div class="section">
            <div class="section-header">
                <h2 class="h2">{=__('주문/배송상세')}</h2>
                <p class="sub-text c-blue"><b>({=__('주문번호')} : {orderInfo.orderNo} )</b></p>
            </div>
            <div class="section-body">
                <!-- 주문상품 리스트 -->
                {=includeFile('mypage/_order_goods_list.html')}
                <!--// 주문상품 리스트 -->
            </div>
        </div>
        <!--{ ? orderInfo.gift }-->
        <div class="section">
            <div class="section-header">
                <h2 class="h2">{=__('사은품 정보')}</h2>
            </div>
            <div class="section-body">
                <div class="table1">
                    <table>
                        <colgroup>
                            <col style="width:130px;" />
                            <col />
                        </colgroup>
                        <tbody>
                        <!--{ @ orderInfo.gift}-->
                        <tr>
                            <!--{ ? .index_ == 0 }-->
                            <th class="ta-l" rowspan="{totalGiftCnt}">{=__('사은품 정보')}</th>
                            <!--{ / }-->
                            <td style="padding:10px;">{.imageUrl}&nbsp;&nbsp;{.giftNm}&nbsp;({.giveCnt} 개)&nbsp;|&nbsp;{.presentTitle}</td>
                        </tr>
                        <!--{ / }-->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <!--{ / }-->
        <div class="section">
            <div class="section-header">
                <h2 class="h2">{=__('주문자 정보')}</h2>
            </div>
            <div class="section-body">
                <div class="table1">
                    <table>
                        <colgroup>
                            <col style="width:130px;" />
                            <col />
                        </colgroup>
                        <tbody>
                        <tr>
                            <th class="ta-l">{=__('주문자 정보')}</th>
                            <td>{orderInfo.orderName}</td>
                        </tr>
                        <!--{ ? gd_is_login() == true && !gGlobal.isFront }-->
                        <tr>
                            <th class="ta-l">{=__('주소')}</th>
                            <td>
                                <!--{ ? gGlobal.isFront }-->
                                ({=gd_isset(orderInfo.orderZonecode)}) {=gd_isset(orderInfo.orderAddressSub)}, {=gd_isset(orderInfo.orderAddress)}, {=gd_isset(orderInfo.orderState)}, {=gd_isset(orderInfo.orderCity)}, {=gd_isset(orderInfo.orderCountry)}
                                <!--{ : }-->
                                ({orderInfo.orderZonecode}) {orderInfo.orderAddress} {orderInfo.orderAddressSub}
                                <!--{ / }-->
                            </td>
                        </tr>
                        <!--{ / }-->
                        <tr>
                            <th class="ta-l">{=__('전화번호')}</th>
                            <td>
                                <!--{ ? gGlobal.isFront }-->
                                (+{=gd_isset(orderInfo.orderPhonePrefix)})
                                <!--{ / }-->
                                {orderInfo.orderPhone}
                            </td>
                        </tr>
                        <tr>
                            <th class="ta-l">{=__('휴대폰 번호')}</th>
                            <td>
                                <!--{ ? gGlobal.isFront }-->
                                (+{=gd_isset(orderInfo.orderCellPhonePrefix)})
                                <!--{ / }-->
                                {orderInfo.orderCellPhone}
                            </td>
                        </tr>
                        <tr>
                            <th class="ta-l">{=__('이메일')}</th>
                            <td>{orderInfo.orderEmail}</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="section">
            <div class="section-header">
                <h2 class="h2">{=__('배송지 정보')}</h2>
            </div>
            <div class="section-body">
                <div class="table1">
                    <table>
                        <colgroup>
                            <col style="width:130px;" />
                            <col />
                        </colgroup>
                        <tbody>
                        <!--{ ? orderInfo.multiShippingFl == 'y' && multiOrderInfo }-->
                        <tr>
                            <th colspan="2" class="ta-l">{=__('메인 배송지')}</th>
                        </tr>
                        <!--{ / }-->
                        <!--{ ? orderInfo.deliveryVisit != 'y' }-->
                        <tr>
                            <th class="ta-l">{=__('배송자 정보')}</th>
                            <td>
                                {orderInfo.receiverName}
                                <!--<button type="button" class="normal-btn small1" onclick="pg_receipt_view('cash', '{orderInfo.orderNo}');"><em>배송지 변경</em></button>-->
                            </td>
                        </tr>
                        <tr>
                            <th class="ta-l">{=__('주소')}</th>
                            <td>
                                <!--{ ? gGlobal.isFront }-->
                                ({orderInfo.receiverZonecode}) {orderInfo.receiverAddressSub}, {orderInfo.receiverAddress}, {orderInfo.receiverState}, {orderInfo.receiverCity}, {orderInfo.receiverCountry}
                                <!--{ : }-->
                                ({orderInfo.receiverZonecode}) {orderInfo.receiverAddress} {orderInfo.receiverAddressSub}
                                <!--{ / }-->
                            </td>
                        </tr>
                        <tr>
                            <th class="ta-l">{=__('전화번호')}</th>
                            <td>
                                <!--{ ? gGlobal.isFront }-->(+ {orderInfo.receiverPhonePrefix})<!--{ / }-->
                                {orderInfo.receiverPhone}
                            </td>
                        </tr>
                        <tr>
                            <th class="ta-l">{=__('휴대폰 번호')}</th>
                            <td>
                                <!--{ ? gGlobal.isFront }-->(+ {orderInfo.receiverCellPhonePrefix})<!--{ / }-->
                                {orderInfo.receiverCellPhone}
                            </td>
                        </tr>
                        <tr>
                            <th class="ta-l">{=__('남기실 말씀')}</th>
                            <td>{orderInfo.orderMemo}</td>
                        </tr>
                        <!--{ / }-->
                        <!--{ ? orderInfo.deliveryVisit == 'a' || orderInfo.deliveryVisit == 'y' }-->
                        <tr>
                            <th class="ta-l">{=__('방문수령 정보')}</th>
                            <td>
                                <div class="table1">
                                <table>
                                    <colgroup>
                                        <col style="width:130px;" />
                                        <col />
                                    </colgroup>
                                    <tr>
                                        <th>{=__('방문 수령지 주소')}</th>
                                        <td>{=orderInfo.visitDeliveryInfo.address[orderInfo.infoSno][0]} <!--{ ? count(orderInfo.visitDeliveryInfo.address[orderInfo.infoSno]) > 1 }-->외 {=(count(orderInfo.visitDeliveryInfo.address[orderInfo.infoSno]) - 1)}건<!--{ / }--> <span class="button"><a class="skinbtn point2 ogl-buysettle btn-open-layer" data-order-no="{=orderInfo.orderNo}" data-goods-sno='{=json_encode(orderInfo.visitDeliveryInfo.goodsSno[orderInfo.infoSno])}' href="#visitAddressLayer">상품정보</a></span></td>
                                    </tr>
                                    <tr>
                                        <th>{=__('방문자 정보')}</th>
                                        <td>{orderInfo.visitName} / {orderInfo.visitPhone}</td>
                                    </tr>
                                    <tr>
                                        <th>{=__('메모')}</th>
                                        <td>{orderInfo.visitMemo}</td>
                                    </tr>
                                </table>
                                </div>
                            </td>
                        </tr>
                        <!--{ / }-->
                        </tbody>
                    </table>

                    <!--{ ? orderInfo.multiShippingFl == 'y' && multiOrderInfo }-->
                    <!--{ @ multiOrderInfo.receiverNm }-->
                    <table style="margin-top:10px;">
                        <colgroup>
                            <col style="width:130px;" />
                            <col />
                        </colgroup>
                        <tbody>
                        <tr>
                            <th colspan="2" class="ta-l">{=__('추가 배송지')} {=.index_ + 1}</th>
                        </tr>
                        <!--{ ? multiOrderInfo.deliveryVisit[.index_] != 'y' }-->
                        <tr>
                            <th class="ta-l">{=__('배송자 정보')}</th>
                            <td>
                                {multiOrderInfo.receiverNm[.index_]}
                                <!--<button type="button" class="normal-btn small1" onclick="pg_receipt_view('cash', '{orderInfo.orderNo}');"><em>배송지 변경</em></button>-->
                            </td>
                        </tr>
                        <tr>
                            <th class="ta-l">{=__('주소')}</th>
                            <td>
                                <!--{ ? gGlobal.isFront }-->
                                ({multiOrderInfo.receiverZonecode[.index_]}) {multiOrderInfo.receiverAddressSub[.index_]}, {multiOrderInfo.receiverAddress[.index_]}, {multiOrderInfo.receiverState[.index_]}, {multiOrderInfo.receiverCity[.index_]}, {multiOrderInfo.receiverCountry[.index_]}
                                <!--{ : }-->
                                ({multiOrderInfo.receiverZonecode[.index_]}) {multiOrderInfo.receiverAddress[.index_]} {multiOrderInfo.receiverAddressSub[.index_]}
                                <!--{ / }-->
                            </td>
                        </tr>
                        <tr>
                            <th class="ta-l">{=__('전화번호')}</th>
                            <td>
                                <!--{ ? gGlobal.isFront }-->(+ {multiOrderInfo.receiverPhonePrefix[.index_]})<!--{ / }-->
                                {multiOrderInfo.receiverPhone[.index_]}
                            </td>
                        </tr>
                        <tr>
                            <th class="ta-l">{=__('휴대폰 번호')}</th>
                            <td>
                                <!--{ ? gGlobal.isFront }-->(+ {multiOrderInfo.receiverCellPhonePrefix[.index_]})<!--{ / }-->
                                {multiOrderInfo.receiverCellPhone[.index_]}
                            </td>
                        </tr>
                        <tr>
                            <th class="ta-l">{=__('남기실 말씀')}</th>
                            <td>{multiOrderInfo.orderMemo[.index_]}</td>
                        </tr>
                        <!--{ / }-->
                        <!--{ ? multiOrderInfo.deliveryVisit[.index_] != 'n' }-->
                        <tr>
                            <th class="ta-l">{=__('방문수령 정보')}</th>
                            <td>
                                <div class="table1">
                                    <table>
                                        <colgroup>
                                            <col style="width:130px;" />
                                            <col />
                                        </colgroup>
                                        <tr>
                                            <th>{=__('방문 수령지 주소')}</th>
                                            <td>{=orderInfo.visitDeliveryInfo.address[multiOrderInfo.InfoSno[.index_]][0]} <!--{ ? count(orderInfo.visitDeliveryInfo.address[multiOrderInfo.InfoSno[.index_]]) > 1 }-->외 {=(count(orderInfo.visitDeliveryInfo.address[multiOrderInfo.InfoSno[.index_]]) - 1)}건<!--{ / }--> <span class="button"><a class="skinbtn point2 ogl-buysettle btn-open-layer" data-order-no="{=orderInfo.orderNo}" data-goods-sno='{=json_encode(orderInfo.visitDeliveryInfo.goodsSno[multiOrderInfo.InfoSno[.index_]])}' href="#visitAddressLayer">상품정보</a></span></td>
                                        </tr>
                                        <tr>
                                            <th>{=__('방문자 정보')}</th>
                                            <td>{multiOrderInfo.visitName[.index_]} / {multiOrderInfo.visitPhone[.index_]}</td>
                                        </tr>
                                        <tr>
                                            <th>{=__('메모')}</th>
                                            <td>{multiOrderInfo.visitMemo[.index_]}</td>
                                        </tr>
                                    </table>
                                </div>
                            </td>
                        </tr>
                        <!--{ / }-->
                        </tbody>
                    </table>
                    <!--{ / }-->
                    <!--{ / }-->
                </div>
            </div>
        </div>
        <!--{ ? empty(orderInfo.addField) === false }-->
        <div class="section">
            <div class="section-header">
                <h2 class="h2">{=__('추가 정보')}</h2>
            </div>
            <div class="section-body">
                <div class="table1">
                    <table>
                        <colgroup>
                            <col />
                        </colgroup>
                        <tbody>
                        <!--{ @ orderInfo.addField }-->
                        <!--{ ? .process == 'goods' }-->
                        <!--{ @ .data }-->
                        <tr>
                            <th class="ta-l">{=.name} : {=.goodsNm[..key_]}</th>
                        </tr>
                        <tr>
                            <td style="padding:10px 16px;">{=..value_}</td>
                        </tr>
                        <!--{ / }-->
                        <!--{ : }-->
                        <tr>
                            <th class="ta-l">{=.name}</th>
                        </tr>
                        <tr>
                            <td style="padding:10px 16px;">{=.data}</td>
                        </tr>
                        <!--{ / }-->
                        <!--{ / }-->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <!--{ / }-->

        <div class="section">
            <div class="section-header">
                <h2 class="h2">{=__('결제정보')}</h2>
            </div>
            <div class="section-body">
                <div class="table1">
                    <table>
                        <colgroup>
                            <col style="width:130px;" />
                            <col />
                        </colgroup>
                        <tbody>
                        <tr>
                            <th class="ta-l">{=__('상품 합계 금액')}</th>
                            <td>{=gd_global_order_currency_display(orderInfo.totalGoodsPrice, orderInfo.exchangeRate, orderInfo.currencyPolicy)}</td>
                        </tr>
                        <!--{ ? gGlobal.isFront }-->
                        <tr>
                            <th class="ta-l">{=__('총 무게')}</th>
                            <td>
                                {=number_format(orderInfo.totalDeliveryWeight, 2)}kg
                                {=__('상품무게 %s kg + 박스무게 %s kg', number_format(orderInfo.deliveryWeightInfo.goods, 2), number_format(orderInfo.deliveryWeightInfo.box, 2))}
                            </td>
                        </tr>
                        <!--{ / }-->
                        <tr>
                            <th class="ta-l">{=__('배송비')}</th>
                            <td>
                                {=gd_global_order_currency_display(orderDeliveryInfo.deliveryPolicyCharge, orderInfo.exchangeRate, orderInfo.currencyPolicy)}
                                <!--{ ? orderInfo.multiShippingFl == 'y' }-->
                                <!--{ ? orderDeliveryInfo.orderInfoCharge }-->
                                (<!--{ @ orderDeliveryInfo.orderInfoCharge }-->
                                <!--{ ? .index_ == 0 }-->{=__('메인 배송지')}<!--{ : }-->{=__('추가 배송지')}{=.index_}<!--{ / }--> : {=gd_global_currency_display(gd_isset(.value_))}
                                <!--{ / }-->)
                                <!--{ / }-->
                                <!--{ / }-->
                            </td>
                        </tr>
                        <!--{ ? orderDeliveryInfo.deliveryAreaCharge > 0}-->
                        <tr>
                            <th class="ta-l">{=__('지역별 배송비')}</th>
                            <td>{=gd_global_currency_display(gd_isset(orderDeliveryInfo.deliveryAreaCharge))}</td>
                        </tr>
                        <!--{ / }-->
                        <!--{ ? gGlobal.isFront }-->
                        <tr>
                            <th class="ta-l">{=__('해외배송 보험료')}</th>
                            <td><strong>{=gd_global_order_currency_display(gd_isset(orderInfo.totalDeliveryInsuranceFee), orderInfo.exchangeRate, orderInfo.currencyPolicy)}</strong></td>
                        </tr>
                        <!--{ / }-->
                        <tr>
                            <th class="ta-l">{=__('할인혜택')}</th>
                            <td>
                                <table class="table-reset inner-table">
                                    <tbody>
                                    <tr>
                                        <th class="ta-l">{=__('상품')}</th>
                                        <td class="ta-r">(-) {=gd_global_order_currency_display(orderInfo.totalGoodsDcPrice, orderInfo.exchangeRate, orderInfo.currencyPolicy)}</td>
                                    </tr>
                                    <!--{ ? gd_is_login() == true }-->
                                    <!--{ ? orderInfo.useMileage > 0 }-->
                                    <tr>
                                        <th class="ta-l">{mileageUse.name}</th>
                                        <td class="ta-r">(-) {=gd_global_order_money_format(orderInfo.useMileage, orderInfo.exchangeRate, orderInfo.currencyPolicy.globalCurrencyDecimal)} {mileageUse.unit}</td>
                                    </tr>
                                    <!--{ / }-->
                                    <!--{ ? orderInfo.useDeposit > 0 }-->
                                    <tr>
                                        <th class="ta-l">{depositUse.name}</th>
                                        <td class="ta-r">(-) {=gd_global_order_money_format(orderInfo.useDeposit, orderInfo.exchangeRate, orderInfo.currencyPolicy.globalCurrencyDecimal)} {depositUse.unit}</td>
                                    </tr>
                                    <!--{ / }-->
                                    <!--{ ? (orderInfo.totalMemberDcPrice + orderInfo.totalMemberOverlapDcPrice) > 0 }-->
                                    <tr>
                                        <th class="ta-l">{=__('회원')}</th>
                                        <td class="ta-r">(-) {=gd_global_order_currency_display(orderInfo.totalMemberDcPrice + orderInfo.totalMemberOverlapDcPrice, orderInfo.exchangeRate, orderInfo.currencyPolicy)}</td>
                                    </tr>
                                    <!--{ / }-->
                                    <!--{ ? (orderInfo.totalCouponOrderDcPrice + orderInfo.totalCouponGoodsDcPrice + orderInfo.totalCouponDeliveryDcPrice) > 0 }-->
                                    <tr>
                                        <th class="ta-l">{=__('쿠폰')}</th>
                                        <td class="ta-r">(-) {=gd_global_order_currency_display(orderInfo.totalCouponOrderDcPrice + orderInfo.totalCouponGoodsDcPrice + orderInfo.totalCouponDeliveryDcPrice, orderInfo.exchangeRate, orderInfo.currencyPolicy)}</td>
                                    </tr>
                                    <!--{ / }-->
                                    <!--{ ? orderInfo.totalEnuriDcPrice != 0 }-->
                                    <tr>
                                        <th class="ta-l">{=__('운영자 추가 할인')}</th>
                                        <td class="ta-r">
                                            <!--{ ? orderInfo.totalEnuriDcPrice < 0}-->
                                            (+)
                                            <!--{ : }-->
                                            (-)
                                            <!--{ / }-->
                                            {=gd_global_order_currency_display(orderInfo.absTotalEnuriDcPrice, orderInfo.exchangeRate, orderInfo.currencyPolicy)}
                                        </td>
                                    </tr>
                                    <!--{ / }-->
                                    <!--{ / }-->
                                    <tr>
                                        <th class="ta-l">{=__('총 할인')}</th>
                                        <td class="ta-r"><b class="c-red">{=gd_global_order_currency_display(orderInfo.useMileage + orderInfo.useDeposit + orderInfo.totalGoodsDcPrice + orderInfo.totalMemberDcPrice +
                                            orderInfo.totalMemberOverlapDcPrice + orderInfo.totalCouponOrderDcPrice + orderInfo.totalCouponGoodsDcPrice + orderInfo.totalCouponDeliveryDcPrice + orderInfo.totalEnuriDcPrice, orderInfo.exchangeRate, orderInfo.currencyPolicy)}</b></td>
                                    </tr>
                                    </tbody>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <th class="ta-l">{=__('총 결제 금액')}</th>
                            <td class="c-red final"><strong>{=gd_global_order_currency_display(orderInfo.settlePrice, orderInfo.exchangeRate, orderInfo.currencyPolicy)}</strong></td>
                        </tr>
                        <!--{ ? substr(orderInfo.settleKind, 0, 1) == 'o' }-->
                        <tr>
                            <th class="ta-l">{=__('승인금액')}</th>
                            <td><strong class="c-red">{=orderInfo.overseasSettleCurrency} {=orderInfo.overseasSettlePrice}</strong></td>
                        </tr>
                        <!--{ / }-->
                        <!--{ ? gd_isset(orderInfo.orderStatus) == 'f' && empty(orderInfo.pgFailReason) === false }-->
                        <tr>
                            <th class="ta-l">{=__('결제 실패 사유')}</th>
                            <td class="c-red">{=orderInfo.pgFailReason}</td>
                        </tr>
                        <!--{ / }-->
                        <tr>
                            <th class="ta-l">{=__('결제수단')}</th>
                            <td class="payment-method">
                                <strong>{orderInfo.settleName}</strong><br/>
                                <!--{ ? gd_isset(orderInfo.settleKind) == 'gb' }-->
                                {=__('입금은행')} : {=gd_isset(orderInfo.bankAccount[0])}<br/>
                                {=__('입금계좌')} : {=gd_isset(orderInfo.bankAccount[1])}<br/>
                                {=__('예금주명')} : {=gd_isset(orderInfo.bankAccount[2])}<br/>
                                {=__('입금금액')} : <strong class="c-red">{=gd_global_order_currency_display(gd_isset(orderInfo.settlePrice), orderInfo.exchangeRate, orderInfo.currencyPolicy)}</strong><br/>
                                {=__('입금자명')} : {=gd_isset(orderInfo.bankSender)}
                                <!--{ : }-->
                                <!--{ ? gd_isset(orderInfo.settleMethod) == 'c' }-->
                                {=gd_isset(orderInfo.pgSettleNm[0])}
                                <!--{ : gd_isset(orderInfo.settleMethod) == 'b' }-->
                                {=__('이체은행')} : {=gd_isset(orderInfo.pgSettleNm[0])}
                                <!--{ : gd_isset(orderInfo.settleMethod) == 'v' }-->
                                {=__('입금은행')} : {=gd_isset(orderInfo.pgSettleNm[0])}<br/>
                                {=__('가상계좌')} : {=gd_isset(orderInfo.pgSettleNm[1])}<br/>
                                <!--{ ? gd_isset(orderInfo.pgSettleNm[2]) != '' }--> {=__('예금자명')} : {=gd_isset(orderInfo.pgSettleNm[2])}<br/><!--{ / }-->
                                <!--{ ? gd_isset(orderInfo.pgSettleCd[0]) != '' }--> {=__('송금일자')} : {=gd_date_format('Y-m-d', gd_isset(orderInfo.pgSettleCd[0]))} 까지<br/><!--{ / }-->
                                {=__('입금금액')} : <strong class="c-red">{=gd_global_currency_display(gd_isset(orderInfo.settlePrice))}</strong>
                                <!--{ : gd_isset(orderInfo.settleMethod) == 'h' }-->
                                {=__('통신사')} : {=gd_isset(orderInfo.pgSettleNm[0])}<br/>
                                <!--{ ? gd_isset(orderInfo.pgSettleCd[0]) != '' }--> {=__('결제 휴대폰 번호')} : {=gd_isset(orderInfo.pgSettleCd[0])}<!--{ / }-->
                                <!--{ / }-->
                                <!--{ / }-->
                                <!--{ ? gd_isset(escrowConfirmFl) === true }-->
                                <!-- 에스크로 구매확인 레이어 -->
                                {=escrowScript}
                                <div id="pgEscrowConfirmLayer" class="layer-wrap dn"></div>
                                <!--//에스크로 구매확인 레이어 -->
                                <form id="frmEscrowConfirm" name="frmEscrowConfirm" action="./order_ps.php" method="post" target="ifrmProcess">
                                    <input type="hidden" name="mode" value="escrowConfirm"/>
                                    <input type="hidden" name="orderNo" value="{orderInfo.orderNo}"/>
                                    <input type="hidden" name="pgName" value="{orderInfo.pgName}"/>
                                    <input type="submit" value="{=__('에스크로 구매확인')}" class="normal-btn small1" />
                                </form>
                                <!--{ / }-->
                            </td>
                        </tr>
                        <!--{ ? gd_is_login() == true && orderInfo.totalMileage > 0 && gd_use_mileage() }-->
                        <tr>
                            <th class="ta-l">{=__('적립')} {mileageUse.name}</th>
                            <td>
                                <strong>{=__('적립 예정')} {mileageUse.name}</strong>
                                <table class="table-reset inner-table m1">
                                    <tbody>
                                    <!--{ ? (orderInfo.totalGoodsMileage + orderInfo.totalMemberMileage) > 0 }-->
                                    <tr>
                                        <th class="ta-l">{=__('구매')} {mileageUse.name}</th>
                                        <td class="ta-r">{=gd_money_format(orderInfo.totalGoodsMileage + orderInfo.totalMemberMileage)}{mileageUse.unit}</td>
                                    </tr>
                                    <!--{ / }-->
                                    <!--{ ? 0 > 0 }-->
                                    <tr>
                                        <th class="ta-l">{=__('후기작성')} {mileageUse.name}</th>
                                        <td class="ta-r">{=gd_money_format(0)}{mileageUse.unit}</td>
                                    </tr>
                                    <!--{ / }-->
                                    <!--{ ? (orderInfo.totalCouponGoodsMileage + orderInfo.totalCouponOrderMileage) > 0 }-->
                                    <tr>
                                        <th class="ta-l">{=__('추가')} {mileageUse.name}</th>
                                        <td class="ta-r">{=gd_money_format(orderInfo.totalCouponGoodsMileage + orderInfo.totalCouponOrderMileage)}{mileageUse.unit}</td>
                                    </tr>
                                    <!--{ / }-->
                                    <tr>
                                        <th class="ta-l">{=__('총')} {mileageUse.name}</th>
                                        <td class="ta-r"><b class="c-red">{=gd_money_format(orderInfo.totalMileage)}{mileageUse.unit}</b></td>
                                    </tr>
                                    </tbody>
                                </table>
                            </td>
                        </tr>
                        <!--{ / }-->
                        <!--{ ? gd_isset(orderInfo.settleReceipt) }-->
                        <tr>
                            <th class="ta-l">{=__('결제영수증')}</th>
                            <td>
                                <div class="button">
                                    <button type="button" class="normal-btn small1" onclick="pg_receipt_view('{=orderInfo.settleReceipt}', '{orderInfo.orderNo}');"><em>{=__('결제영수증 조회')}</em></button>
                                </div>
                            </td>
                        </tr>
                        <!--{ / }-->

                        <!--{ ? (empty(orderInfo.cash) === false && orderInfo.receiptFl == 'r') ||  (receipt['cashFl'] == 'y' && orderInfo.receiptFl == 'n') }-->
                        <tr>
                            <th class="ta-l">{=__('현금영수증')}</th>
                            <td>
                                <table class="table-reset inner-table">
                                    <tbody>
                                    <!--{ ? (empty(orderInfo.cash) === false && orderInfo.receiptFl == 'r') }-->
                                    <tr>
                                        <th class="ta-l">{=__('발행 용도')}</th>
                                        <td class="ta-r">
                                            <!--{ ? gd_isset(orderInfo.cash.useFl) == 'd' }-->{=__('소득공제용')}<!--{ / }-->
                                            <!--{ ? gd_isset(orderInfo.cash.useFl) == 'e' }-->{=__('지출증빙용')}<!--{ / }-->
                                        </td>
                                    </tr>
                                    <tr>
                                        <th class="ta-l">{=__('발행 현황')}</th>
                                        <td class="ta-r">
                                            <!--{ ? gd_isset(orderInfo.cash.statusFl) == 'r' }-->
                                            {=__('발급요청')}
                                            <!--{ : gd_isset(orderInfo.cash.statusFl) == 'y' }-->
                                            {=__('발행완료')}
                                            <!--{ : gd_isset(orderInfo.cash.statusFl) == 'c' }-->
                                            {=__('발행취소')}
                                            <!--{ : }-->
                                            {=__('발행오류')}
                                            <!--{ / }-->
                                        </td>
                                    </tr>
                                    <!--{ ? gd_isset(orderInfo.cash.statusFl) == 'y' || gd_isset(orderInfo.cash.statusFl) == 'c' }-->
                                    <tr>
                                        <th class="ta-l" colspan="2">
                                            <div class="button">
                                                <button type="button" class="normal-btn small1" onclick="pg_receipt_view('cash', '{orderInfo.orderNo}');"><em>{=__('현금영수증 출력')}</em></button>
                                            </div>
                                        </th>
                                    </tr>
                                    <!--{ / }-->
                                    <!--{ / }-->
                                    <!--{ ? (receipt['cashFl'] == 'y' && orderInfo.receiptFl == 'n') }-->
                                    <!--{ ? receipt['periodFl'] == 'y' }-->
                                    <tr>
                                        <th class="ta-l" colspan="2">
                                            <div class="button">
                                                <a href="#layer-cash-receipt-request" class="btn-open-fixlayer normal-btn small1" onclick="cash_receipt_toggle();"><em>{=__('현금영수증 발행')}</em></a>
                                            </div>
                                            <!-- 현금영수증 발행 레이어 -->
                                            <div id="layer-cash-receipt-request" class="favor-layer cash-receipt-request-layer dn">
                                                <div class="wrap">
                                                    <strong>{=__('현금영수증 발행')}</strong>
                                                    <form id="frmCashReceipt" name="frmCashReceipt" action="./order_ps.php" method="post" target="ifrmProcess">
                                                        <input type="hidden" name="mode" value="cashReceiptRequest"/>
                                                        <input type="hidden" name="orderNo" value="{orderInfo.orderNo}"/>
                                                        <div class="table2">
                                                            <table>
                                                                <colgroup>
                                                                    <col style="width:90px;"/>
                                                                    <col/>
                                                                </colgroup>
                                                                <tr>
                                                                    <th class="ta-l va-t">{=__('발행용도')}</th>
                                                                    <td class="va-t">
                                                                        <input type="radio" id="cashCert_d" name="cashUseFl" value="d" onclick="cash_receipt_toggle();" checked="checked"/>
                                                                        <label class="choice-s" for="cashCert_d">{=__('소득공제용')}</label>

                                                                        <input type="radio" id="cashCert_e" name="cashUseFl" value="e" onclick="cash_receipt_toggle();"/>
                                                                        <label class="choice-s" for="cashCert_e">{=__('지출증빙용')}</label>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <th class="ta-l va-t"><span class="cert-no-title">{=__('휴대폰번호')}</span></th>
                                                                    <td class="va-t">
                                                                        <div class="user-info" id="certNo_hp">
                                                                            <div class="txt-field hs" style="width:130px;">
                                                                                <input type="text" class="text number-only" name="cashCertNo[c]" value="{=gd_isset(memberInvoiceInfo['cash']['cellPhone'])}" placeholder="{=__('- 없이 입력하세요')}" maxlength="11"/>
                                                                            </div>
                                                                        </div>
                                                                        <div class="user-info" id="certNo_bno">
                                                                            <div class="txt-field hs" style="width:130px;">
                                                                                <input type="text" class="text number-only" name="cashCertNo[b]" value="{=str_replace('-', '', gd_isset(memberInvoiceInfo['cash']['cashBusiNo']))}" placeholder="{=__('- 없이 입력하세요')}" maxlength="10"/>
                                                                            </div>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="va-t button" colspan="2">
                                                                        <button type="button" class="normal-btn small1 btn-cash-receipt-request"><em>{=__('현금영수증 발행')}</em></button>
                                                                    </td>
                                                                </tr>
                                                            </table>
                                                        </div>
                                                    </form>
                                                    <button type="button" class="close" title="{=__('닫기')}">{=__('닫기')}</button>
                                                </div>
                                            </div>
                                            <!-- //현금영수증 발행 레이어 -->
                                        </th>
                                    </tr>
                                    <!--{ : }-->
                                    <tr>
                                        <th class="ta-l" colspan="2">
                                            {=__('발급불가 %s 발급요청은 결제완료 후 %s일 이내에만 가능합니다.%s', '(※', receipt['periodDay'], ')' )}
                                        </th>
                                    </tr>
                                    <!--{ / }-->
                                    <!--{ / }-->
                                    </tbody>
                                </table>

                            </td>
                        </tr>
                        <!--{ / }-->
                        <!--{ ? (empty(orderInfo.tax) === false && orderInfo.receiptFl == 't') ||  (receipt['taxFl'] == 'y' && orderInfo.receiptFl == 'n') }-->
                        <tr>
                            <th class="ta-l">{=__('세금계산서')}</th>
                            <td>
                                <table class="table-reset inner-table">
                                    <tbody>
                                    <!--{ ? (empty(orderInfo.tax) === false && orderInfo.receiptFl == 't') }-->
                                    <tr>
                                        <th class="ta-l">{=__('발행 현황')}</th>
                                        <td class="ta-l">
                                            <!--{ ? gd_isset(orderInfo.tax.statusFl) == 'r' }-->
                                            {=__('발급요청')}
                                            <!--{ : gd_isset(orderInfo.tax.statusFl) == 'y' }-->
                                            {=__('발행완료')}
                                            <!--{ : gd_isset(orderInfo.tax.statusFl) == 'c' }-->
                                            {=__('발행취소')}
                                            <!--{ : }-->
                                            {=__('발행오류')}
                                            <!--{ / }-->
                                        </td>
                                    </tr>
                                    <!--{ ? gd_isset(orderInfo.tax.statusFl) == 'y'  }-->

                                    <!--{ ? gd_isset(orderInfo.tax.issueFl) =='g'  }-->

                                    <tr>
                                        <th class="ta-l" colspan="2">
                                            <div class="button">
                                                <button type="button" class="normal-btn small1 btn-tax-invoice"><em>{=__('세금계산서 출력')}</em></button>
                                            </div>
                                        </th>
                                    </tr>
                                    <!--{ : }-->
                                    <tr>
                                        <th class="ta-l" colspan="2">
                                            <div>* {=__('전자세금계산서는 주문자정보의 이메일주소로 발송됩니다. %s 발행완료된 후 전자세금계산서 메일이 확인되지 않으면 고객센터로 문의주시기 바랍니다.', '<br/>&nbsp;&nbsp;')}</div>
                                        </th>
                                    </tr>
                                    <!--{ / }-->
                                    <!--{ / }-->
                                    <!--{ / }-->

                                    <!--{ ? (receipt['taxFl'] == 'y'  && orderInfo.receiptFl == 'n') }-->
                                    <!--{ ? (receipt.limitDateFl =='y') }-->
                                    <tr>
                                        <th class="ta-l" colspan="2">
                                            <div class="button">
                                                <a href="#layer-tax-invoice-request" class="btn-open-fixlayer normal-btn small1"><em>{=__('세금계산서 발행')}</em></a>
                                            </div>
                                            <!--{ ? taxinvoiceInfo }-->
                                            <div>{taxinvoiceInfo}</div>
                                            <!--{ / }-->
                                            <!-- 세금계산서 발행 레이어 -->
                                            <div id="layer-tax-invoice-request" class="favor-layer cash-receipt-request-layer dn" style="width:600px;">
                                                <div class="wrap">
                                                    <strong>
                                                        {=__('세금계산서 발행')}
                                                        <!--{ ? memberInvoiceInfo['tax']['memberTaxInfoFl'] == 'y' }-->
                                                        <button class="normal-btn small1 tax-info-init"><em>{=__('초기화')}</em></button>
                                                        <!--{ / }-->
                                                    </strong>
                                                    <form id="frmTaxInvoiceRequest" name="frmTaxInvoiceRequest" action="./order_ps.php" method="post" target="ifrmProcess">
                                                        <input type="hidden" name="mode" value="taxInvoiceRequest"/>
                                                        <input type="hidden" name="orderNo" value="{orderInfo.orderNo}"/>
                                                        <div class="table2">

                                                            <table id="tax_info" summary="{=__('세금계산서 입력폼입니다.')}" cellspacing="0" border="1">
                                                                <colgroup>
                                                                    <col style="width:95px;"/>
                                                                    <col/>
                                                                    <col style="width:95px;"/>
                                                                    <col/>
                                                                </colgroup>
                                                                <tr>
                                                                    <th scope="row">{=__('사업자번호')}</th>
                                                                    <td colspan="3">
                                                                        <div class="txt-field hs" style="width:130px">
                                                                            <input type="text" name="taxBusiNo" placeholder="{=__('- 없이 입력하세요')}" class="text" value="{=str_replace('-', '', gd_isset(memberInvoiceInfo['tax']['taxBusiNo']))}" maxlength="10"/>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <th scope="row">{=__('회사명')}</th>
                                                                    <td>
                                                                        <div class="txt-field hs" style="width:130px">
                                                                            <input type="text" name="taxCompany" class="text" value="{=gd_isset(memberInvoiceInfo['tax']['company'])}" maxlength="50" data-pattern="gdMemberNmGlobal"/>
                                                                        </div>
                                                                    </td>

                                                                    <th scope="row">{=__('대표자명')}</th>
                                                                    <td>
                                                                        <div class="txt-field hs" style="width:130px">
                                                                            <input type="text" name="taxCeoNm" class="text" value="{=gd_isset(memberInvoiceInfo['tax']['ceo'])}"/>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <th scope="row">{=__('업태')}</th>
                                                                    <td>
                                                                        <div class="txt-field hs" style="width:130px">
                                                                            <input type="text" name="taxService" class="text" value="{=gd_isset(memberInvoiceInfo['tax']['service'])}"/>
                                                                        </div>
                                                                    </td>
                                                                    <th scope="row">{=__('종목')}</th>
                                                                    <td>
                                                                        <div class="txt-field hs" style="width:130px">
                                                                            <input type="text" name="taxItem" class="text" value="{=gd_isset(memberInvoiceInfo['tax']['item'])}"/>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <th scope="row">{=__('사업장주소')}</th>
                                                                    <td colspan="3">

                                                                        <div class="post">
                                                                            <div class="txt-field hs" style="width:100px;float:left;margin-right:5px;">
                                                                                <input type="text" name="taxZonecode" value="{=gd_isset(memberInvoiceInfo['tax']['comZonecode'])}" readonly="readonly" class="text">
                                                                                <input type="hidden" name="taxZipcode" value="{=gd_isset(memberInvoiceInfo['tax']['comZipcode'])}">
                                                                                <span id="taxrZipcodeText" class="text"></span>

                                                                            </div>
                                                                            <button type="button" onclick="postcode_search('taxZonecode', 'taxAddress', 'taxZipcode');" class="normal-btn small2 post-search"><em>{=__('우편번호검색')}</em></button>
                                                                        </div>

                                                                        <div class="txt-field hs" style="width:423px;margin-top:10px;">
                                                                            <input type="text" name="taxAddress" class="text" value="{=gd_isset(memberInvoiceInfo['tax']['comAddress'])}"/>
                                                                        </div>
                                                                        <div class="txt-field hs" style="width:423px;margin-top:10px;">
                                                                            <input type="text" name="taxAddressSub" class="text" value="{=gd_isset(memberInvoiceInfo['tax']['comAddressSub'])}"/>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                                <!--{ ? taxInfo.eTaxInvoiceFl == 'y' }-->
                                                                <tr>
                                                                    <th class="row">{=__('발행 이메일')}</th>
                                                                    <td colspan="3">
                                                                        <div class="email">
                                                                            <span class="txt-field hs" style="width:193px;">
                                                                                <input type="text" name="taxEmail" id="idTaxEmail" class="text" placeholder="{=__('미입력 시 주문자의 이메일로 발행')}" value="{=gd_isset(memberInvoiceInfo['tax']['email'])}"/>
                                                                            </span>
                                                                            <div class="choice-select">
                                                                                <span class="st-hs">
                                                                                    <select id="taxEmailDomain" class="tune" style="width: 120px;">
                                                                                        <!--{ @ emailDomain }-->
                                                                                        <option value="{=.key_}">{=.value_}</option>
                                                                                        <!--{ / }-->
                                                                                    </select>
                                                                                </span>
                                                                            </div>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                                <!--{ / }-->
                                                                <tr>
                                                                    <td class="va-t button btn-layer" colspan="4">
                                                                        <button type="submit" class="point2 skinbtn btn-tax-invoice-request"><em>{=__('세금계산서 발행')}</em></button>
                                                                    </td>
                                                                </tr>
                                                            </table>
                                                        </div>
                                                    </form>
                                                    <button type="button" class="close" title="{=__('닫기')}">{=__('닫기')}</button>
                                                </div>
                                            </div>
                                            <!-- //현금영수증 발행 레이어 -->


                                        </th>
                                    </tr>
                                    <!--{ : }-->
                                    <tr>
                                        <th class="ta-l" colspan="2">
                                            {=__('발급불가 %s 결제완료 기준 다음 달  %s 일까지 신청 가능 가능합니다.%s', '(※ ', receipt['taxInvoiceLimitDate'], ')' )}<br />
                                            <!--{ ? taxinvoiceDeadline }-->
                                            <div>{taxinvoiceDeadline}</div>
                                            <!--{ / }-->
                                        </th>
                                    </tr>
                                    <!--{ / }-->
                                    <!--{ / }-->
                                    </tbody>
                                </table>
                            </td>
                        </tr>
                        <!--{ / }-->

                        <!--{ ? receipt['reception'] == 'y' || receipt['particularFl'] == 'y'}-->
                        <form id="printform" name="printform" action="./order_print.php" method="post" target="orderPrintPopup">
                            <input type="hidden" name="orderPrintMode" />
                            <input type="hidden" name="orderPrintCode" value="{orderInfo.orderNo}"/>
                        </form>
                        <!--{ / }-->

                        <!--{ ? receipt['particularFl'] == 'y' }-->
                        <tr>
                            <th class="ta-l">{=__('거래명세서')}</th>
                            <td><button type="button" class="normal-btn small1" onclick="order_print_popup('particular')"><em>{=__('거래명세서 인쇄')}</em></button></td>
                        </tr>
                        <!--{ / }-->

                        <!--{ ? receipt['reception'] == 'y' }-->
                        <tr>
                            <th class="ta-l">{=__('간이영수증')}</th>
                            <td><button type="button" class="normal-btn small1" onclick="order_print_popup('reception')"><em>{=__('간이영수증 인쇄')}</em></button></td>
                        </tr>
                        <!--{ / }-->

                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!--{ ? isHandle && totalRefundPrice > 0}-->
        <div class="section">
            <div class="section-header">
                <h2 class="h2">{=__('환불 정보')}</h2>
            </div>
            <div class="section-body">
                <div class="table1">
                    <table>
                        <colgroup>
                            <col style="width:130px;" />
                            <col />
                        </colgroup>
                        <tbody>
                        <tr>
                            <th class="ta-l">{=__('환불 금액')}</th>
                            <td class="c-red final">{=gd_global_currency_symbol()}<strong>{=gd_global_money_format(totalRefundPrice)}</strong>{=gd_global_currency_string()}</td>
                        </tr>
                        <tr>
                            <th class="ta-l">{=__('환불 내역')}</th>
                            <td>
                                <!--{ ? totalCompleteCashPrice > 0}-->
                                {=__('현금')} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;&nbsp;{=gd_global_currency_symbol()}<strong>{=gd_global_money_format(totalCompleteCashPrice)}</strong>{=gd_global_currency_string()}<br />
                                <!--{ / }-->
                                <!--{ ? totalCompletePgPrice > 0}-->
                                PG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;&nbsp;{=gd_global_currency_symbol()}<strong>{=gd_global_money_format(totalCompletePgPrice)}</strong>{=gd_global_currency_string()}<br />
                                <!--{ / }-->
                                <!--{ ? totalCompleteDepositPrice > 0}-->
                                {=__('예치금')} &nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;&nbsp;{=gd_global_currency_symbol()}<strong>{=gd_global_money_format(totalCompleteDepositPrice)}</strong>{=gd_global_currency_string()} ({=__('사용 예치금 환불')} {=gd_global_currency_symbol()}<strong>{=gd_global_money_format(totalRefundUseDeposit)}</strong>{=gd_global_currency_string()})<br />
                                <!--{ / }-->
                                <!--{ ? totalRefundUseMileage > 0}-->
                                {=__('마일리지')} &nbsp;:&nbsp;&nbsp;{=gd_global_currency_symbol()}<strong>{=gd_global_money_format(totalRefundUseMileage)}</strong>{=gd_global_currency_string()}<br />
                                <!--{ / }-->
                                <!--{ ? totalCompleteMileagePrice > 0}-->
                                {=__('기타')} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;&nbsp;{=gd_global_currency_symbol()}<strong>{=gd_global_money_format(totalCompleteMileagePrice)}</strong>{=gd_global_currency_string()}<br />
                                <!--{ / }-->
                            </td>
                        </tr>
                        <!--{ ? totalCompleteCashPrice > 0 }-->
                        <tr>
                            <th class="ta-l">{=__('환불 계좌정보')}</th>
                            <td>
                                <!--{ ? totalRefundData }-->
                                <!--{ @ totalRefundData }-->
                                <!--{ ? .account }-->
                                {=__('입금은행')} : {=nl2br(.bank)} | {=__('입금계좌')} : {=nl2br(.account)} | {=__('입금자명')} : {=nl2br(.depositor)} <br />
                                <!--{ / }-->
                                <!--{ / }-->
                                <!--{ / }-->
                            </td>
                        </tr>
                        <!--{ / }-->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <!--{ / }-->

        <!--{ ? isExchangeHandle }-->
            <!--{ @ exchangeHandleData }-->
                <!--{ ? .ehDifferencePrice < 0 }-->
                    <div class="section">
                        <div class="section-header">
                            <h2 class="h2">{=__('교환 추가결제 정보')}</h2>
                        </div>
                        <div class="section-body">
                            <div class="table1">
                                <table>
                                    <colgroup>
                                        <col style="width:130px;" />
                                        <col />
                                    </colgroup>
                                    <tbody>
                                    <tr>
                                        <th class="ta-l">{=__('추가결제 금액')}</th>
                                        <td class="c-red final">
                                            {=gd_global_currency_symbol()}<strong>{=gd_global_money_format(.ehAbsDifferencePrice)}</strong>{=gd_global_currency_string()}
                                        </td>
                                    </tr>
                                    <tr>
                                        <th class="ta-l">{=__('입금자명')}</th>
                                        <td class="c-red final">
                                            {.ehSettleName}
                                        </td>
                                    </tr>
                                    <tr>
                                        <th class="ta-l">{=__('결제계좌정보')}</th>
                                        <td class="c-red final">
                                            {.ehSettleBankAccountInfo}
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                <!--{ : }-->
                    <div class="section">
                        <div class="section-header">
                            <h2 class="h2">{=__('교환환불 정보')}</h2>
                        </div>
                        <div class="section-body">
                            <div class="table1">
                                <table>
                                    <colgroup>
                                        <col style="width:130px;" />
                                        <col />
                                    </colgroup>
                                    <tbody>
                                    <tr>
                                        <th class="ta-l">{=__('환불금액')}</th>
                                        <td class="c-red final">
                                            {=gd_global_currency_symbol()}<strong>{=gd_global_money_format(.ehAbsDifferencePrice)}</strong>{=gd_global_currency_string()}
                                        </td>
                                    </tr>
                                    <tr>
                                        <th class="ta-l">{=__('환불수단')}</th>
                                        <td class="c-red final">
                                            {.ehRefundNameStr}
                                        </td>
                                    </tr>
                                    <!--{ ? .ehRefundMethod == 'bank' }-->
                                    <tr>
                                        <th class="ta-l">{=__('결제계좌정보')}</th>
                                        <td class="c-red final">
                                            {.ehRefundBankName} / {.ehRefundBankAccountNumber} / {.ehRefundName}
                                        </td>
                                    </tr>
                                    <!--{ / }-->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                <!--{ / }-->
            <!--{ / }-->
        <!--{ / }-->
    </div>
</div>

<!-- 방문수령 주소 레이어 -->
<div id="visitAddressLayer" class="layer-wrap dn" data-remote="../mypage/layer_visit_address.php"></div>
<!-- 방문수령 주소 레이어 -->

<script type="text/javascript">
    $(document).ready(function () {
        $('input.number-only').on('keyup', function () {
            var value = $(this).val().replace(/[^0-9]/g, '');
            $(this).val(value);
        });
        // 현금영수증 신청
        $('.btn-cash-receipt-request').click(function (e) {
            var certCode = $('input[name=\'cashUseFl\']:checked').val();
            var pass = true;
            if (certCode == 'd') {
                if ($('input[name=\'cashCertNo[c]\']').val() == '') {
                    pass = false;
                    alert("{=__('휴대폰 번호를 입력해주세요.')}");
                }
            } else if (certCode == 'e') {
                if ($('input[name=\'cashCertNo[b]\']').val() == '') {
                    pass = false;
                    alert("{=__('사업자 번호를 입력해주세요.')}");
                }
            } else {
                pass = false;
                alert("{=__('발행용도를 선택해주세요.')}");
            }

            if (pass == true) {
                $('#frmCashReceipt').target = 'ifrmProcess'
                $('#frmCashReceipt').submit();
            }
        });

        <!--{ ? gd_isset(orderInfo.tax.statusFl) == 'y' && gd_isset(orderInfo.tax.issueFl) =='g'  }-->
        // 세금계산서 보기
        $('.btn-tax-invoice').click(function (e) {
            var win = popup({
                url: '../share/show_tax_invoice.php?orderNo={orderInfo.orderNo}'
                , target: 'tax_invoice'
                , width: 750
                , height: 600
                , resizable: 'yes'
                , scrollbars: 'yes'
            });
            win.focus();
            return win;

        });
        <!--{ / }-->

        <!--{ ? (receipt['taxFl'] == 'y' && orderInfo.receiptFl == 'n') }-->
        <!--{ ? taxInfo.eTaxInvoiceFl == 'y' }-->
        $.validator.addMethod(
            'taxEmailChk', function (value, element) {
                if ($('input[name="taxEmail"]').val() !==  '' && !$.validator.methods.email.call(this, $.trim(value), element)) {
                    $.validator.messages.taxEmailChk =  __('[세금계산서] 발행 이메일을 정확하게 입력하여 주세요.');
                    return false;
                }
                return true;
            },'');
        <!--{ / }-->

        // 세금계산서 신청
        $('#frmTaxInvoiceRequest').validate({
            onkeyup: onkeyup,
            submitHandler: function (form) {
                <!--{ ? taxInfo.eTaxInvoiceFl == 'y' }-->
                if($('#idTaxEmail').val().length==0){
                    $('#idTaxEmail').val('{orderInfo.orderEmail}');
                }
                <!--{ / }-->
                form.target = 'ifrmProcess';
                form.submit();
            },
            rules: {
                taxBusiNo: {
                    required: true,
                    businessnoKR: true
                },
                taxCompany: {
                    required: true
                },
                taxCeoNm: {
                    required: true
                },
                taxService: {
                    required: true
                },
                taxItem: {
                    required: true
                },
                <!--{ ? taxInfo.eTaxInvoiceFl == 'y' }-->
                taxEmail: {
                    taxEmailChk: true
                },
                <!--{ / }-->
                taxAddress: {
                    required: true
                }
            },
            messages: {
                taxBusiNo: {
                    required: "{=__('[세금계산서] 사업자번호를 입력하세요.')}"
                },
                taxCompany: {
                    required: "{=__('[세금계산서] 회사명을 입력하세요.')}"
                },
                taxCeoNm: {
                    required: "{=__('[세금계산서] 대표자명을 입력하세요.')}"
                },
                taxService: {
                    required: "{=__('[세금계산서] 업태를 입력하세요.')}"
                },
                taxItem: {
                    required: "{=__('[세금계산서] 종목을 입력하세요.')}"
                },
                taxAddress: {
                    required: "{=__('[세금계산서] 사업장주소를 입력하세요.')}"
                }
            }
        });

        //이메일세팅
        select_email_domain('taxEmail','taxEmailDomain');
        $("#taxEmailDomain_chosen").width("120px");

        <!--{ ? memberInvoiceInfo['tax']['memberTaxInfoFl'] == 'y' }-->
        // 세금계산서 입력 정보 초기화
        $('.tax-info-init').on('click', function (e) {
            e.preventDefault();
            $('#tax_info').find('input').val('');
        });
        <!--{ / }-->
        <!--{ / }-->
    });


    <!--{ ? (receipt['cashFl'] == 'y' && orderInfo.receiptFl == 'n' && receipt['periodFl'] == 'y') }-->
    /**
     * 현금영수증 인증방법 선택
     * (소득공제용 - 휴대폰 번호(c), 지출증빙용 - 사업자번호(b))
     */
    function cash_receipt_toggle() {
        var certCode = $('input[name=\'cashUseFl\']:checked').val();

        if (certCode == 'd') {
            $('input[name=\'cashCertFl\']').val('c');
            $('.cert-no-title').text("{=__('휴대폰번호')}");
            $('#certNo_hp').show();
            $('#certNo_bno').hide();
        } else {
            $('input[name=\'cashCertFl\']').val('b');
            $('.cert-no-title').text("{=__('사업자번호')}");
            $('#certNo_hp').hide();
            $('#certNo_bno').show();
        }
    }
    <!--{ / }-->


    <!--{ ? receipt['reception'] == 'y' || receipt['particularFl'] == 'y'}-->
    // 주문 프린트 팝업창
    function order_print_popup(orderPrintMode){
        var orderPrint = window.open('', 'orderPrintPopup', 'width=750,height=600,menubar=yes,scrollbars=yes,resizable=yes');
        $('input[name=orderPrintMode]').val(orderPrintMode);
        $('#printform').submit();
    }
    <!--{ / }-->

    /**
     * validator onkeyup 함수
     * @param element
     * @param event
     * @returns {boolean}
     */
    function onkeyup(element, event) {
        if (check_key_code2(event)) {
            return true;
        }
        if ($.isFunction(replace_keyup[$(element).data('pattern')])) {
            replace_keyup[$(element).data('pattern')](element);
        }
    }

    var regexp_test = function (string, pattern) {
        if (string === undefined || string.length < 1) {
            return false;
        }
        return pattern.test(string);
    };

    var replace_pattern = function (string, pattern, c) {
        if (string === undefined || string.length < 1) {
            return '';
        }
        return string.replace(pattern, c);
    };

    var replace_keyup = {
        gdEngNum: function (element) {
            element.value = replace_pattern(element.value, /[^\da-zA-Z]/g, '');
        },
        gdEngKor: function (element) {
            // IE11에서 초중종성 분리되는 현상때문에 test 후 replace 처리로 변경
            if (regexp_test(element.value, /[^a-zA-Zㄱ-ㅎㅏ-ㅣ가-힣\u119E\u11A2]/)) {
                element.value = replace_pattern(element.value, /[^a-zA-Zㄱ-ㅎㅏ-ㅣ가-힣\u119E\u11A2]/g, '');
            }
        },
        gdEngKorNum: function (element) {
            // IE11에서 초중종성 분리되는 현상때문에 test 후 replace 처리로 변경
            if (regexp_test(element.value, /[^a-zA-Zㄱ-ㅎㅏ-ㅣ가-힣0-9\u119E\u11A2]/)) {
                element.value = replace_pattern(element.value, /[^a-zA-Zㄱ-ㅎㅏ-ㅣ가-힣0-9\u119E\u11A2]/g, '');
            }

        },
        gdNum: function (element) {
            element.value = replace_pattern(element.value, /[^\d]/g, '');
        },
        gdEng: function (element) {
            element.value = replace_pattern(element.value, /[^a-zA-Z]/g, '');
        },
        gdKor: function (element) {
            if (regexp_test(element.value, /[^가-힣ㄱ-ㅎㅏ-ㅣ\u119E\u11A2]/)) {
                element.value = replace_pattern(element.value, /[^가-힣ㄱ-ㅎㅏ-ㅣ\u119E\u11A2]/g, '');
            }
        },
        gdMemberId: function (element) {
            element.value = replace_pattern(element.value, /[^\da-zA-Z\.\-_@]/g, '');
        },
        gdMemberNmGlobal: function (element) {
            // IE11에서 초중종성 분리되는 현상때문에 test 후 replace 처리로 변경
            if (regexp_test(element.value, /[\/\'\"\\\|]/)) {
                element.value = replace_pattern(element.value, /[\/\'\"\\\|]/g, '');
            }
        }
    };

    /**
     * jquery validation의 키 체크 함수
     * @param event
     * @returns {boolean}
     */
    function check_key_code2(event) {
        // Avoid revalidate the field when pressing one of the following keys
        /* Shift       => 16 Ctrl        => 17 Alt         => 18
         Caps lock   => 20 End         => 35 Home        => 36
         Left arrow  => 37 Up arrow    => 38 Right arrow => 39
         Down arrow  => 40 Insert      => 45 Num lock    => 144 AltGr key   => 225*/
        var excludedKeys = [
            16, 17, 18, 20, 35, 36, 37,
            38, 39, 40, 45, 144, 225
        ];

        return event.which === 9 || $.inArray(event.keyCode, excludedKeys) !== -1;
    }


</script>
<script type="text/javascript" src="../js/jquery/validation/additional/businessnoKR.js"></script>
{ # footer }
