{*** 회원가입 > 정보입력 | member/join.php ***}
{ # header }
<div class="join">
    <div class="top">
        <h2>{=__('회원가입')}</h2>
        <div>
            <span>
                <strong>01</strong>
                {=__('약관동의')}
            </span>
            <span class="this">
                <strong>02</strong>
                {=__('정보입력')}
            </span>
            <span class="end">
                <strong>03</strong>
                {=__('가입완료')}
            </span>
        </div>
    </div>
    <div class="join-form">
        <form id="formJoin" name="formJoin" action="{joinActionUrl}" method="post">
            <input type="hidden" name="rncheck" value="{data.rncheck}">
            <input type="hidden" name="dupeinfo" value="{data.dupeinfo}">
            <input type="hidden" name="pakey" value="{data.pakey}">
            <input type="hidden" name="foreigner" value="{data.foreigner}">
            <input type="hidden" name="adultFl" value="{data.adultFl}">
            <input type="hidden" name="mode" value="join">
            <fieldset>
                <legend>{=__('회원가입폼')}</legend>
                <!--{?joinField.businessinfo.use == 'y'}-->
                <div class="tit">
                    <h3>{=__('회원종류')}</h3>
                </div>
                <div class="border-top">
                    <div class="choice-check">
                        <span class="form-element">
                            <input type="radio" class="radio ignore" id="memberFlDefault" name="memberFl" value="personal" checked="checked">
                            <label for="memberFlDefault" class="choice on">{=__('개인회원')}</label>
                        </span>
                        <span class="form-element">
                            <input type="radio" class="radio ignore" id="memberFlBusiness" name="memberFl" value="business">
                            <label for="memberFlBusiness" class="choice">{=__('사업자회원')}</label>
                        </span>
                    </div>
                </div>
                <!--{/}-->
                <div class="tit">
                    <h3>{=__('기본정보')}</h3>

                    <p>{=__('표시는 반드시 입력하셔야 하는 항목입니다.')}</p>
                </div>
                <!-- 회원가입/정보 기본정보 -->{=includeWidget('member/_join_view.html')}<!-- 회원가입/정보 기본정보 -->
                <!-- 회원가입/정보 사업자정보 -->{=includeWidget('member/_join_view_business.html')}<!-- 회원가입/정보 사업자정보 -->
                <!-- 회원가입/정보 부가정보 -->{=includeWidget('member/_join_view_other.html')}<!-- 회원가입/정보 부가정보 -->
                <!-- 회원가입/자동등록 방지 -->{=includeWidget('member/_join_view_captcha.html')}<!-- 회원가입/회원가입/자동등록 방지 -->
            </fieldset>
            <div class="btn">
                <button type="button" class="skinbtn point1 j-cancel" id="btnCancel"><em>{=__('취소')}</em></button>
                <button type="button" class="skinbtn point2 j-join btn-join" value="{=__('회원가입')}"><em>{=__('회원가입')}</em>
                </button>
            </div>
        </form>
    </div>
</div>
<script type="text/javascript">
    var paycoProfile = {paycoProfile};
    var naverProfile = {naverProfile};
    var thirdPartyProfile = {thirdPartyProfile};
    var kakaoProfile = {kakaoProfile};
    var appleProfile = {appleProfile};
    var googleProfile = {googleProfile};

    $(document).ready(function () {
        var $formJoin = $('#formJoin');

        $(':text:first', $formJoin).focus();

        $('#btnCancel', $formJoin).click(function (e) {
            e.preventDefault();
            top.location.href = '/';
        });

        if ($('.js-datepicker').length) {
            $('.js-datepicker').datetimepicker({
                locale: '{=gGlobal.locale}',
                format: 'YYYY-MM-DD',
                dayViewHeaderFormat: 'YYYY MM',
                viewMode: 'days',
                ignoreReadonly: true,
                debug: false,
                keepOpen: false
            });
            $('.check-cal img').click(function (e) {
                $(this).prev('.js-datepicker').data('DateTimePicker').show();
            });
        }

        $('#btnPostcode').click(function (e) {
            e.preventDefault();
            $('#address-error, #addressSub-error').remove();
            $(':text[name=address], :text[name=addressSub]').removeClass('error c-red');
            postcode_search('zonecode', 'address', 'zipcode');
        });

        $('#btnCompanyPostcode').click(function (e) {
            e.preventDefault();
            $('#comAddress-error, #comAddressSub-error').remove();
            $(':text[name=comAddress], :text[name=comAddressSub]').removeClass('error c-red');
            postcode_search('comZonecode', 'comAddress', 'comZipcode');
        });

        <!--{?joinField.businessinfo.use == 'y'}-->
        $(':radio[name="memberFl"]').change(function () {
            var $businessinfo = $('.businessinfo');
            if (this.value == 'business') {
                $businessinfo.removeClass('dn');
                $businessinfo.find('input, select').removeClass('ignore');
            } else {
                $businessinfo.addClass('dn');
                $businessinfo.find('input, select').addClass('ignore');
            }
        });
        $(':radio[name="memberFl"]:checked').trigger('change');
        <!--{/}-->

        <!--{? (joinField.marriFl.use == 'y' && joinField.marriDate.use == 'y') || joinField.birthDt.use == 'y' }-->
        function sendDateData(year, month, type) {
            var dayType = '';
            var params = {
                year: year,
                month: month,
            };
            $.ajax('../share/date_select_json.php', {
                data: params,
                method: "POST",
                success: function (data) {
                    if (data !='' && data != null) {
                        if (type == 'marry') {
                            dayType = 'marriDay';
                        }else {
                            dayType = 'birthDay';
                        }
                        $('#'+dayType).empty();
                        $('#'+dayType).append(data);
                    }
                }
            });
        }
        <!--{/}-->

        <!--{? joinField.marriFl.use == 'y' && joinField.marriDate.use == 'y'}-->
        $(':radio[name="marriFl"]').change(function () {
            var $marridateinfo = $('.marridateinfo');
            if (this.value == 'y') {
                $marridateinfo.removeClass('dn');
            } else {
                $marridateinfo.addClass('dn');
                $('#marriYear option:eq(0)').prop('selected', true);
                $('#marriMonth option:eq(0)').prop('selected', true);
                $('#marriDay option:eq(0)').prop('selected', true);
            }
        });

        $('#marriYear').change(function () {
            var marriMonthVal = $('#marriMonth').val();
            if (marriMonthVal != '') {
                sendDateData($('#marriYear').val(), $('#marriMonth').val(), 'marry');
            }
        });
        $('#marriMonth').change(function () {
            var marriYearVal = $('#marriYear').val();
            if (marriYearVal != '') {
                sendDateData($('#marriYear').val(), $('#marriMonth').val(), 'marry');
            }
        });
        <!--{/}-->

        <!--{? joinField.birthDt.use == 'y'}-->
        $('#birthYear').change(function () {
            var birthMonthVal = $('#birthMonth').val();
            if ( birthMonthVal != '') {
                sendDateData($('#birthYear').val(), $('#birthMonth').val(), 'birth');
            }
        });
        $('#birthMonth').change(function () {
            var birthYearVal = $('#birthYear').val();
            if ( birthYearVal != '') {
                sendDateData($('#birthYear').val(), $('#birthMonth').val(), 'birth');
            }
        });
        <!--{/}-->

        <!--{? joinField.captcha.use == 'y'}-->
        $('#reload_captcha').click(function (e) {
            $('#captchaImg').removeAttr('src');
            setTimeout(function () {
                var someDate = new Date();
                someDate = someDate.getTime();
                $('#captchaImg').attr('src', '../member/captcha.php?ch=' + someDate);
            }, 1);
        }).trigger('click');
        <!--{/}-->

        select_email_domain('email');

        gd_member2.init($formJoin);

        $('.btn-join').click({form: $formJoin}, gd_member2.save);

        $(window).on('message', function(event) {
            if (event.originalEvent.data === 'callback_not_disabled') {
                callback_not_disabled();
            }
        });
    });


    /**
     * 회원가입시 Exception 발생하는 경우 회원가입 버튼 복원
     */
    function callback_not_disabled()
    {
        $('.btn-join').prop("disabled", false);
        $('.btn-join em').html("{=__('회원가입')}");
    }
</script>
{ # footer }
