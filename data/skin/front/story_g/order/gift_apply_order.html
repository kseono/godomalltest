<!--{ ? count(giftInfo) }-->
<div class="tit">
    <h3>{=__('사은품 선택')}</h3>
    <p>{=__('함께 받으실 사은품을 선택해주세요.')}</p>
</div>
<div class="table1 type1">
    <fieldset>
        <legend>{=__('사은품 선택')}</legend>
        <table class="w100">
            <colgroup>
                <col width="170px;" />
                <col />
            </colgroup>
            <thead>
            <tr>
                <th class="dn">{=__('사은품 지급')}</th>
                <th class="dn">{=__('사은품 선택')}</th>
            </tr>
            </thead>
            <tbody>
            <!--{ @ giftInfo }-->
            <tr>
                <!--{ @ .gift }-->
                <!--{ ? ..total > 0 }-->
                <td class="gift-condition">
                    {giftInfo.title} <br />
                    (<strong><!--{ ? ..selectCnt == 0 }-->{.total}<!--{ : }-->0<!--{ / }--></strong>/<!--{ ? ..selectCnt == 0 }-->{.total}<!--{ : }-->{..selectCnt}<!--{ / }-->)
                </td>
                <td class="gift-choice" data-select-count="">
                    <ul>
                        <!--{ @ ..multiGiftNo }-->
                        <li>
                            <input type="hidden" name="gift[{.key_}][{...index_}][goodsNo]" value="{.goodsNo}" />
                            <input type="hidden" name="gift[{.key_}][{...index_}][scmNo]" value="{...scmNo}" />
                            <input type="hidden" name="gift[{.key_}][{...index_}][selectCnt]" value="{..selectCnt}" class="gift-select-cnt" />
                            <input type="hidden" name="gift[{.key_}][{...index_}][giveCnt]" value="{..giveCnt}" />
                            <input type="hidden" name="gift[{.key_}][{...index_}][minusStockFl]" value="{...stockFl}" />
                            <input type="checkbox" name="gift[{.key_}][{...index_}][giftNo]" value="{...giftNo}" class="checkbox" id="line{.key_}-gift{...index_}"<!--{ ? ..selectCnt == 0 }--> checked="checked" readonly="readonly"<!--{ / }--> />
                            <label for="line{.key_}-gift{...index_}" <!--{ ? ..selectCnt == 0 }-->class="on"<!--{ / }-->>
                            {...imageUrl}
                            <span class="txt">{...giftNm} <small>({=__('%s개', ..giveCnt)})</small></span>
                            <span class="check"><!-- 선택한경우 활성 --></span>
                            </label>
                        </li>
                        <!--{ / }-->
                    </ul>
                </td>
                <!--{ / }-->
                <!--{ / }-->
            </tr>
            <!--{ / }-->
            </tbody>
        </table>
    </fieldset>
</div>
<!--{ / }-->
<script type="text/javascript">
    $(document).ready(function(){
        $('input[name="giftSelectCnt"]').val($('.gift-choice input[type=checkbox]').closest('tr').find('.gift-select-cnt').val());
        // 사은품 체크 및 체크된 수량 출력
        $('.gift-choice input[type=checkbox]').click(function(e){
            if($(this).prop('readonly') == false) {
                var selectCnt = $(this).closest('tr').find('.gift-select-cnt').val();
                var checkedCnt = $(this).closest('tr').find('input[type=checkbox]:checked').length;
                if (checkedCnt > selectCnt) {
                    alert("사은품은 최대 " + selectCnt + "개만 선택하실 수 있습니다.");
                    $(this).prop('checked', false).next('label').removeClass('on');

                    return false;
                }
                $('input[name="giftCheckCnt"]').val(checkedCnt);
                $(this).closest('.gift-choice').prev('.gift-condition').find('strong').text(checkedCnt);
            }
        });
    });
</script>