{*** 주문서 작성 | order/order.php ***}
{ # header }
<!-- 주문하기 시작 -->
<form name="frmOrder" id="frmOrder" action="./order_ps.php" method="post">
    <input type="hidden" name="csrfToken" value="{token}"/>
    <input type="hidden" name="orderChannelFl" value="shop"/>
    <input type="hidden" name="orderCountryCode" value="{=gd_isset(gMemberInfo['countryCode'])}" />
    <input type="hidden" name="orderZipcode" value="{=gd_isset(gMemberInfo['zipcode'])}" />
    <input type="hidden" name="orderZonecode" value="{=gd_isset(gMemberInfo['zonecode'])}" />
    <input type="hidden" name="orderState" value="{=gd_isset(gMemberInfo['state'])}" />
    <input type="hidden" name="orderCity" value="{=gd_isset(gMemberInfo['city'])}" />
    <input type="hidden" name="orderAddress" value="{=gd_isset(gMemberInfo['address'])}" />
    <input type="hidden" name="orderAddressSub" value="{=gd_isset(gMemberInfo['addressSub'])}" />
    <input type="hidden" name="tmpDeliverTab" value=""/>
    <!--{ ? !gGlobal.isFront }-->
    <input type="hidden" name="orderPhonePrefixCode" value="kr" />
    <input type="hidden" name="orderPhonePrefix" value="82" />
    <input type="hidden" name="orderCellPhonePrefixCode" value="kr" />
    <input type="hidden" name="orderCellPhonePrefix" value="82" />
    <input type="hidden" name="receiverCountryCode" value="kr" />
    <input type="hidden" name="receiverPhonePrefixCode" value="kr" />
    <input type="hidden" name="receiverPhonePrefix" value="82" />
    <input type="hidden" name="receiverCellPhonePrefixCode" value="kr" />
    <input type="hidden" name="receiverCellPhonePrefix" value="82" />
    <input type="hidden" name="receiverState" value="" />
    <input type="hidden" name="receiverCity" value="" />
    <!--{ / }-->
    <input type="hidden" name="chooseMileageCoupon" value="{chooseMileageCoupon}" />
    <input type="hidden" name="chooseCouponMemberUseType" value="{=couponConfig['chooseCouponMemberUseType']}" />
    <input type="hidden" name="totalCouponGoodsDcPrice" value="{totalCouponGoodsDcPrice}" />
    <input type="hidden" name="totalCouponGoodsMileage" value="{totalCouponGoodsMileage}" />
    <input type="hidden" name="totalMemberDcPrice" value="{=totalMemberDcPrice}" />
    <input type="hidden" name="totalMemberOverlapDcPrice" value="{=totalMemberOverlapDcPrice}" />
    <input type="hidden" name="deliveryFree" value="{deliveryFree}" />
    <input type="hidden" name="totalDeliveryFreePrice" value="" />
    <input type="hidden" name="cartGoodsCnt" value="{cartGoodsCnt}" />
    <input type="hidden" name="cartAddGoodsCnt" value="{cartAddGoodsCnt}" />
    <input type="hidden" name="productCouponChangeLimitType" value="{productCouponChangeLimitType}" />
    <input type="hidden" name="deliveryVisit" value="n" />
    <input type="hidden" name="returnUrl" value="{returnUrl}"/>
    <input type="hidden" name="mileageUseDeliveryFl" value="{mileageUse.useDeliveryFl}" />
    <input type="hidden" name="presentInfoNo" value="{presentInfoNo}" />
    <input type="hidden" name="giftSelectCnt" value="" />
    <input type="hidden" name="giftCheckCnt" value="" />

    <div class="pay">
        <h2 class="my_tit">{=__('주문 상품')}</h2>
        <ul class="my_goods v4">
            <!--{ @ cartInfo }-->
            <li data-cart-idx="{.key_}" data-goods-no="{$cartlst.goods_no}" data-goods-sub="{$cartlst.goods_sub}" data-goods-price="{$cartlst.price}" data-goods-cnt="{$cartlst.goods_cnt}" data-coupon-prd-idx="{$cnt}">
                <!--{ ? cartScmCnt > 1 }-->
                <strong><!--{=cartScmInfo[.key_]['companyNm']}--></strong>
                <!--{ / // end cartScmCnt}-->
                <!--{ @ .value_ }-->
                <!--{ @ ..value_ }-->
                <input type="hidden" name="cartSno[]" value="{...sno}"/>
                <input type="hidden" name="memberDcInfo[{...goodsNo}][{...optionSno}]" value='{...memberDcInfo}' />
                <input type="hidden" name="priceInfo[{...goodsNo}][{...optionSno}]" value='{...priceInfo}' />
                <input type="hidden" name="mileageInfo[{...goodsNo}][{...optionSno}]" value='{...mileageInfo}' />

                <div class="info order-goods-layout" data-goodsNo="{=...goodsNo}">
                    <input type="hidden" class="delivery-method-fl" value='{...deliveryMethodFl}' />
                    <input type="hidden" class="visit-address-use-fl" value='{...goodsDeliveryVisitAddressUseFl}' />
                    <input type="hidden" class="delivery-method-visit-area" value='{...deliveryMethodVisitArea}' />
                    <a href="../goods/goods_view.php?goodsNo={=...goodsNo}">
                        <div>
                            <div class="itemhead">
                                <div class="thmb">
                                    {=...goodsImage}
                                    <!--{ ? ...timeSaleFl }-->
                                    <span class="timesale-mask">
                                                <img src="../img/common/icon-timesale.png" alt="" class="icon-timesale">
                                                <span class="timetext">{=__('타임세일')}</span>
                                            </span><!--{ / // food-story 타임세일}-->
                                </div>
                            </div>
                            <div class="itembody">
                                <span class="elp2">{=...goodsNm}</span>
                                <dd>{=__('주문수량')} : {=...goodsCnt}</dd>
                                <!--{ ? ...orderPossible === 'n' }-->
                                <dd >{=__('구매 불가')}: {=...orderPossibleMessage}</dd>
                                <!--{ / }-->
                                <!--{ ? ...duplicationGoods === 'y' }-->
                                <dd >{=__('중복 상품')}</dd>
                                <!--{ / }-->

                                <!--{ @ ...option }-->
                                <!--{ ? ....optionName }-->
                                <dd>
                                    {=....optionName} :
                                    {=....optionValue}
                                    <!--{ ? ((....index_ + 1) == ....size_) && ....optionPrice != 0 && optionPriceFl == 'y' }-->
                                    (<!--{ ? ....optionPrice > 0 }-->+<!--{ / }-->{=gd_global_currency_display(....optionPrice)})
                                    <!--{ / }-->
                                    <!--{ ? ((....index_ + 1) == ....size_) }-->
                                        <!--{ ? empty(....optionSellStr) === false }-->[{=....optionSellStr}]<!--{ / }--><!--{ ? empty(....optionDeliveryStr) === false }-->[{=....optionDeliveryStr}]<!--{ / }-->
                                    <!--{ / }-->
                                </dd>
                                <!--{ / }-->
                                <!--{ / }-->

                                <!--{ @ ...optionText }-->
                                <!--{ ? ....optionValue }-->
                                <dd >
                                    {=....optionName} :
                                    {=....optionValue}
                                    <!--{ ? ....optionTextPrice != 0 && optionPriceFl == 'y' }-->
                                    (<!--{ ? ....optionTextPrice > 0 }-->+<!--{ / }-->{=gd_global_currency_display(....optionTextPrice)})
                                    <!--{ / }-->

                                </dd>
                                <!--{ / }-->
                                <!--{ / }-->
                            </div>
                        </div>
                        <strong class="prc">
                            <!--{ ? empty(...goodsPriceString) === false }-->
                            {=...goodsPriceString}
                            <!--{ : }-->
                            {=gd_global_currency_display((...price['goodsPriceSum'] + ...price['optionPriceSum'] + ...price['optionTextPriceSum']))}
                            <!--{ ? gGlobal.isFront }-->
                            <p class="add_currency">{=gd_global_add_currency_display((...price['goodsPriceSum'] + ...price['optionPriceSum'] + ...price['optionTextPriceSum']))}</p>
                            <!--{ / }-->
                            <!--{ / }-->
                        </strong>
                        <div style="text-align:right; color:#333;">
                            <!--{ ? ...goodsDeliveryFl === 'y' }-->
                            <!--{ ? ...index_ == '0' }-->
                            {=setDeliveryInfo[..key_]['goodsDeliveryMethod']}
                            <!--{ ? setDeliveryInfo[..key_]['fixFl'] === 'free' }-->
                            {=__('무료배송')}
                            <!--{ : }-->
                            <!--{ ? setDeliveryInfo[..key_]['goodsDeliveryWholeFreeFl'] === 'y' }-->
                            {=__('조건에 따른 배송비 무료')}
                            <!--{ ? empty(setDeliveryInfo[..key_]['goodsDeliveryWholeFreePrice']) === false }-->
                            <!--({=gd_global_currency_display(setDeliveryInfo[..key_]['goodsDeliveryWholeFreePrice'])})-->
                            <!--{ / }-->
                            <!--{ : }-->
                            <!--{ ? setDeliveryInfo[..key_]['goodsDeliveryCollectFl'] === 'later' }-->
                            <!--{ ? empty(setDeliveryInfo[..key_]['goodsDeliveryCollectPrice']) === false }-->
                            {=gd_global_currency_display(setDeliveryInfo[..key_]['goodsDeliveryCollectPrice'])}
                            <!--{ / }-->
                            <!--{ : }-->
                            <!--{ ? empty(setDeliveryInfo[..key_]['goodsDeliveryPrice']) === true }-->
                            {=__('무료배송')}
                            <!--{ : }-->
                            {=gd_global_currency_display(setDeliveryInfo[..key_]['goodsDeliveryPrice'])}
                            <!--{ / }-->
                            <!--{ / }-->
                            <!--{ / }-->
                            <!--{ / }-->

                            <!--{ ? empty(setDeliveryInfo[..key_]['goodsDeliveryMethodFlText']) === false }-->
                            ({setDeliveryInfo[..key_]['goodsDeliveryMethodFlText']}-<!--{ ? setDeliveryInfo[..key_]['goodsDeliveryCollectFl'] === 'later' && empty(setDeliveryInfo[..key_]['goodsDeliveryCollectPrice']) === false }-->{=__('착불')}<!--{ : }-->{=__('선결제')}<!--{ / }-->)
                            <!--{ / }-->
                            <!--{ / }-->
                            <!--{ : }-->
                            <!--{ ? ...sameGoodsDeliveryFl === 'y' }-->
                            <!--{ ? ...equalGoodsNo === true }-->
                            {=setDeliveryInfo[..key_][...goodsNo]['goodsDeliveryMethod']}
                            <!--{ ? setDeliveryInfo[..key_][...goodsNo]['fixFl'] === 'free' }-->
                            {=__('무료배송')}
                            <!--{ : }-->
                            <!--{ ? setDeliveryInfo[..key_][...goodsNo]['goodsDeliveryWholeFreeFl'] === 'y' }-->
                            {=__('조건에 따른 배송비 무료')}
                            <!--{ ? empty(setDeliveryInfo[..key_][...goodsNo]['goodsDeliveryWholeFreePrice']) === false }-->
                            <!--({=gd_global_currency_display(setDeliveryInfo[..key_][...goodsNo]['goodsDeliveryWholeFreePrice'])})-->
                            <!--{ / }-->
                            <!--{ : }-->
                            <!--{ ? setDeliveryInfo[..key_][...goodsNo]['goodsDeliveryCollectFl'] === 'later' }-->
                            <!--{ ? empty(setDeliveryInfo[..key_][...goodsNo]['goodsDeliveryCollectPrice']) === false }-->
                            {=gd_global_currency_display(setDeliveryInfo[..key_][...goodsNo]['goodsDeliveryCollectPrice'])}
                            <!--{ / }-->
                            <!--{ : }-->
                            <!--{ ? empty(setDeliveryInfo[..key_][...goodsNo]['goodsDeliveryPrice']) === true }-->
                            {=__('무료배송')}
                            <!--{ : }-->
                            {=gd_global_currency_display(setDeliveryInfo[..key_][...goodsNo]['goodsDeliveryPrice'])}
                            <!--{ / }-->
                            <!--{ / }-->
                            <!--{ / }-->
                            <!--{ / }-->

                            <!--{ ? empty(setDeliveryInfo[..key_][...goodsNo]['goodsDeliveryMethodFlText']) === false }-->
                            ({setDeliveryInfo[..key_][...goodsNo]['goodsDeliveryMethodFlText']}-<!--{ ? setDeliveryInfo[..key_][...goodsNo]['goodsDeliveryCollectFl'] === 'later' && empty(setDeliveryInfo[..key_][...goodsNo]['goodsDeliveryCollectPrice']) === false }-->{=__('착불')}<!--{ : }-->{=__('선결제')}<!--{ / }-->)
                            <!--{ / }-->
                            <!--{ / }-->
                            <!--{ : }-->
                            {=...goodsDeliveryMethod}
                            <!--{ ? ...goodsDeliveryFixFl === 'free' }-->
                            {=__('무료배송')}
                            <!--{ : }-->
                            <!--{ ? ...goodsDeliveryWholeFreeFl === 'y' }-->
                            {=__('조건에 따른 배송비 무료')}
                            <!--{ ? empty(...price['goodsDeliveryWholeFreePrice']) === false }-->
                            <!--<br/>({=gd_global_currency_display(...price['goodsDeliveryWholeFreePrice'])})-->
                            <!--{ / }-->
                            <!--{ : }-->
                            <!--{ ? ...goodsDeliveryCollectFl === 'later' }-->
                            <!--{ ? empty(...price['goodsDeliveryCollectPrice']) === false }-->
                            {=gd_global_currency_display(...price['goodsDeliveryCollectPrice'])}
                            <!--{ / }-->
                            <!--{ : }-->
                            <!--{ ? empty(...price['goodsDeliveryPrice']) === true }-->
                            {=__('무료배송')}
                            <!--{ : }-->
                            {=gd_global_currency_display(...price['goodsDeliveryPrice'])}
                            <!--{ / }-->
                            <!--{ / }-->
                            <!--{ / }-->
                            <!--{ / }-->

                            <!--{ ? empty(...goodsDeliveryMethodFlText) === false }-->
                            ({...goodsDeliveryMethodFlText}-<!--{ ? ...goodsDeliveryCollectFl === 'later' && empty(...price['goodsDeliveryCollectPrice']) === false }-->{=__('착불')}<!--{ : }-->{=__('선결제')}<!--{ / }-->)
                            <!--{ / }-->
                            <!--{ / }-->
                            <!--{ / }-->
                        </div>
                        <!--{ ? ...deliveryScheduleFl == 'y' }-->
                        <div style="text-align:right; color:#333;">
                            <!--{ ? ...deliveryScheduleType == 'send' }-->
                            {=...deliveryScheduleDate} 발송 예정
                            <!--{ : }-->
                            {=...deliveryScheduleGuideText}
                            <!--{ / }-->
                        </div>
                        <!--{ / }-->
                    </a>

                    <!--{ ? empty(...addGoods) === false }-->
                    <div class="add-goods-box">
                        <em class="add-title">{=__('추가상품')}</em>
                        <ul class="add-goods-list">
                            <!--{ @ ...addGoods }-->
                            <li>
                                <a href="#goods">
                                    <div class="add-goods-img">{=....addGoodsImage}</div>
                                    <div class="add-goods-content">
                                        <span class="title">{=....addGoodsNm}</span>
                                        <!--{ ? ....optionNm }-->
                                        <div>
                                            옵션: { =....optionNm }
                                        </div>
                                        <!--{ / }-->
                                        <div class="add-goods-text">
                                            <span class="goods-number">{=__('주문 수량')} : <em> {=number_format(....addGoodsCnt)}</em>{=__('개')}</span>
                                            <span class="goods-price"><em>{=gd_global_currency_display((....addGoodsPrice * ....addGoodsCnt))}</em></span>
                                        </div>
                                    </div>
                                </a>
                            </li>
                            <!--{ / // end ...addGoods loop }-->
                        </ul>
                    </div>
                    <!--{ / // end empty ...addGoods }-->



                </div>

                <!--{ / // end cartInfo inner loop2 }-->
                <!--{ / // end cartInfo inner loop1 }-->
            </li>
            <!--{ / // end cartInfo }-->
        </ul>

        <!-- 주문 간단 가입 시작 -->
        {=includeWidget('order/_simple_join.html')}
        <!-- 주문 간단 가입 끝 -->

        <!--{ ? gd_is_plus_shop(c.PLUSSHOP_CODE_GIFT) === true && giftConf.giftFl == 'y' }-->
        <div id="add-gift">
            {=includeFile('order/gift_apply_order.html')}
        </div>
        <!--{ / }-->
        <!--{ ? gd_is_login() === false }-->
        <!--{ ? gGlobal.isFront === false & guestUnder14Fl == 'y' }-->
        <h3 class="my_tit">
            <div class="inp_chk" id="termAgreeDiv" style="position:static; margin-top:10px;">
                <input type="checkbox" name="termAgreeUnder14" id="termAgree" class="sp">
                <label for="termAgree">
                    (필수) 만 14세 이상입니다.
                </label>
            </div>
        </h3>
        <!--{ / }-->
        <!--{ ? hasScmGoods === false }-->
        <h2 class="my_tit">
            <div class="inp_chk" style="position:static; margin-top:10px;">
                <input type="checkbox" name="allAgree" id="allAgree" class="sp">
                <label for="allAgree">
                    {=__('%s 의 모든 약관을 확인 하고 전체 동의 합니다. (전체 동의에 선택항목도 포함됩니다.)', serviceInfo['mallNm'])}
                </label>
            </div>
        </h2>
        <!--{ : }-->
        <h2 class="my_tit">
            <div class="inp_chk" style="position:static;margin-top:10px;">
                <input type="checkbox" name="allAgreeScm" id="allAgreeScm" class="sp">
                <label for="allAgreeScm">
                    {=__('%s 의 모든 약관을 확인 하고 전체 동의 합니다. (전체 동의에 선택항목도 포함됩니다.)', serviceInfo['mallNm'])}
                </label>
            </div>
        </h2>
        <!--{ / }-->
        <!--{ / }-->
        <!--{ ? hasScmGoods }-->
        <h2 class="my_tit">{=__('상품 공급사 개인정보 제공 동의')}</h2>
        <fieldset>
            <div class=" terms not-member termAgree-check" style="margin:10px;">
                <div class="ctt" style="padding:10px;border:1px solid #dddddd;max-height:100px;overflow-x:hidden;overflow-y:auto">{=nl2br(privateProvider['content'])}</div>
                <div class="inp_chk" style="position:static;margin:5px 15px;">
                    <input type="checkbox" name="termAgreePrivateProvider" id="termAgreePrivateProvider" class="sp require">
                    <label for="termAgreePrivateProvider" class="check-s"><strong class="c-red">({=__('필수')})</strong> {=__('상품 공급사 개인정보 제공 동의에 대한 내용을 확인 하였으며 이에 동의 합니다.')} </label>
                </div>
            </div>
        </fieldset>
        <!--{ / }-->
        <!--{ ? gd_is_login() === false }-->
        <h2 class="my_tit">{=__('비회원 주문에 대한 개인정보 수집 이용 동의')}</h2>
        <fieldset>
            <div class="pay_notice v2" style="overflow:hidden; height:120px; overflow-y:scroll; margin-top:10px;">{=nl2br(privateGuestOffer['content'])}</div>
            <div class="inp_chk" style="position:static;margin:5px 15px;">
                <input type="checkbox" name="termAgreeGuest" id="nomember_privacy_agree" class="sp">
                <label for="nomember_privacy_agree">
                    <strong class="c-red">({=__('필수')})</strong>
                    {=__('비회원 개인정보 수집 이용에 대한 내용을 확인 하였으며 이에 동의 합니다.')}
                </label>
            </div>
        </fieldset>
        <h2 class="my_tit">{=__('이용약관 동의')}</h2>
        <fieldset>
            <div class="pay_notice v2" style="overflow:hidden; height:120px; overflow-y:scroll; margin-top:10px;">{=nl2br(agreementInfo['content'])}</div>
            <div class="inp_chk" style="position:static;margin:5px 15px;">
                <input type="checkbox" name="termAgreeAgreement" id="termAgree_agreement" class="sp">
                <label for="termAgree_agreement">
                    <strong class="c-red">({=__('필수')})</strong>
                    {=__('이용약관에 대한 내용을 확인 하였으며 이에 동의 합니다.')}
                </label>
            </div>
        </fieldset>
        <!--{ ? gd_is_login() === false && privateMarketingFl }-->
        <h2 class="my_tit">{=privateMarketing['informNm']}</h2>
        <fieldset>
            <div class="pay_notice v2" style="overflow:hidden; height:120px; overflow-y:scroll; margin-top:10px;">{=nl2br(privateMarketing['content'])}</div>
            <div class="inp_chk" style="position:static;margin:5px 15px;">
                <input type="checkbox" name="termAgreePrivateMarketing" id="termAgree_privateMarketing" class="sp">
                <label for="termAgree_privateMarketing">
                    <strong class="c-red">({=__('선택')})</strong>
                    {=privateMarketing['informNm']}에 대한 내용을 확인 하였으며 이에 동의 합니다.
                </label>
            </div>
        </fieldset>
        <!--{ / }-->
        <!--{ / // end guest terms }-->

        <h2 class="my_tit">{=__('주문 고객')}</h2>
        <fieldset>
            <legend>{=__('주문고객 정보 영역')}</legend>
            <!--{ ? gGlobal.isFront === false && gd_is_login() === false && guestUnder14Fl == 's' }-->
            <div class="cert">
                <!--{ ? gd_isset(memberSessionName) || gd_isset(memberSessionPhone) }-->
                <p><strong class="c_point">본인인증이 완료되었습니다.</strong></p>
                <!--{ : }-->
                <!--{ ? ipinFl === true || authCellphoneFl === true }-->
                <p id="cert_txt">비회원으로 구매를 원하시면, 본인인증이 필요합니다.</p>
                <div class="cert_btn" id="btn_cert">
                    <ul>
                        <!--{ ? ipinFl === true }-->
                        <li><a href="javascript:authCellIpin()" class="btn">아이핀 본인인증</a></li>
                        <!--{ / }-->
                        <!--{ ? authCellphoneFl === true }-->
                        <li><a href="javascript:authCellPhone()" class="btn">휴대폰 본인인증</a></li>
                        <!--{ / }-->
                    </ul>
                </div>
                <!--{ / }-->
                <!--{ / }-->
            </div>
            <!--{ / }-->
            <div class="join_bx2">
                <div class="tbl">
                    <table class="tbl-order">
                        <caption>
                            <span>{=__('정보입력')}</span>
                        </caption>
                        <colgroup>
                            <col>
                            <col>
                        </colgroup>
                        <tbody>
                        <tr>
                            <th scope="row" class="required">
                                <label for="ordr_nm" class="tit">{=__('주문자')}</label>
                            </th>
                            <td>
                                <div class="inp_tx">
                                    <input type="text" id="ordr_nm" name="orderName" value="{? memberSessionName }{=memberSessionName}{ : }{=orderName}{ / }" maxlength="20">
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <th scope="row">
                                <label for="orderPhone" class="tit">{=__('전화번호')}</label>
                            </th>
                            <td>
                                <!--{ ? gGlobal.isFront }-->
                                <div class="inp_sel">
                                    {=gd_select_box('orderPhonePrefixCode', 'orderPhonePrefixCode', orderCountryPhone, null, gMemberInfo.phoneCountryCode, __('국가코드'), null, 'tune select-small')}
                                </div>
                                <!--{ / }-->
                                <div class="inp_tx">
                                    <input type="text" id="orderPhone" name="orderPhone" value="{=gd_isset(gMemberInfo['phone'])}" maxlength="20" title="{=__('전화번호')}">
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <th scope="row" class="required">
                                <label for="orderCellPhone" class="tit">{=__('휴대폰번호')}</label>
                            </th>
                            <td>
                                <!--{ ? gGlobal.isFront }-->
                                <div class="inp_sel">
                                    {=gd_select_box('orderCellPhonePrefixCode', 'orderCellPhonePrefixCode', orderCountryPhone, null, gMemberInfo['cellPhoneCountryCode'], __('국가코드'), null, 'tune select-small')}
                                </div>
                                <!--{ / }-->
                                <div class="inp_tx">
                                    <input type="text" id="orderCellPhone" name="orderCellPhone" value="{? memberSessionPhone }{=memberSessionPhone}{ : }{=gd_isset(gMemberInfo['cellPhone'])}{ / }" size="20" title="{=__('휴대전화')}">
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <th scope="row" class="required">
                                <label for="mail" class="tit">{=__('이메일')}</label>
                            </th>
                            <td>
                                <div class="cell_bx sel_area v2">
                                    <div class="cell">
                                        <div class="inp_tx">
                                            <input type="text" name="orderEmail" value="{=gd_isset(gMemberInfo['email'])}" id="mail">
                                        </div>
                                    </div>
                                    <div class="cell">
                                        <div class="inp_sel">
                                            <select id="emailDomain" name="email2" title="{=__('이메일 주소')}">
                                                <!--{ @ emailDomain }-->
                                                <option value="{=.key_}">{=.value_}</option>
                                                <!--{ / }-->
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </fieldset>

        <div class="shipping-info-area">
            <div class="shipping-info-table">
                <!-- 02 배송지정보 -->
                <h2 class="my_tit">
                    <b>{=__('배송정보')}</b>
                    <!--{ ? isUseMultiShipping === true }-->
                    <span class="inp_chk" style="position:relative; margin:0; float:right;">
                        <input type="checkbox" id="multiShippingFl" name="multiShippingFl" value="y" class="sp">
                        <label for="multiShippingFl">{=__('복수 배송지 이용')}</label>
                    </span>
                    <!--{ / }-->
                </h2>
                <div class="section">
                    <div class="section-body">

                        <div class="tab-section ty2">
                            <div class="order-send">
                                <!--{ ? gd_is_login() === true }-->
                                <div class="tab-btns">
                                    <div class="tab-btn active"><a href="#tab1">{=__('기본배송지')}</a></div>
                                    <div class="tab-btn"><a href="#tab2">{=__('배송지 목록')}</a></div>
                                    <div class="tab-btn"><a href="#tab3">{=__('직접 입력')}</a></div>
                                </div>
                                <!--{ / }-->
                                <div class="tab-contents">
                                    <div id="tab1" class="tab-content1 show">
                                        <div class="join_bx2">
                                            <div class="tbl order-table">
                                                <table class="tbl-order">
                                                    <colgroup>
                                                        <col>
                                                        <col>
                                                    </colgroup>
                                                    <tbody>
                                                    <!--{ ? gd_is_login() === false }-->
                                                    <tr>
                                                        <td colspan="2">
                                                            <div class="inp_chk" style="position:static;">
                                                                <input type="checkbox" id="shippingSameCheck" onclick="order_info_same();"  class="sp require">
                                                                <label for="shippingSameCheck">
                                                                    {=__('주문고객정보와 동일합니다.')}
                                                                </label>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                    <!--{ / }-->
                                                    <tr>
                                                        <th class="required"><label class="tit">{=__('이름')}</label></th>
                                                        <td>
                                                            <input type="text" name="receiverName" value="{basiceShippingAddress.shippingName}" maxlength="20" class="input-text wp100">
                                                        </td>
                                                    </tr>
                                                    <!--{ ? gGlobal.isFront }-->
                                                    <tr>
                                                        <th class="required"><label class="tit">{=__('국가')}</label></th>
                                                        <td>
                                                            <div class="inp_sel">
                                                                {=gd_select_box('receiverCountryCode', 'receiverCountryCode', countryAddress, null, recommendCountryCode, __('=선택해주세요='), null, 'tune select-small')}
                                                            </div>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th class="required"><label class="tit">{=__('도시')}</label></th>
                                                        <td>
                                                            <input type="text" name="receiverCity" value="{basiceShippingAddress.shippingCity}" maxlength="20" class="input-text wp100" />
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th class="required"><label class="tit">{=__('주/지방/지역')}</label></th>
                                                        <td>
                                                            <input type="text" name="receiverState" value="{basiceShippingAddress.shippingState}" maxlength="20" class="input-text wp100" />
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th class="required"><label class="tit">{=__('주소1')}</label></th>
                                                        <td>
                                                            <input type="text" name="receiverAddress" value="{basiceShippingAddress.shippingAddress}" class="input-text wp100" />
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th class="required"><label class="tit">{=__('주소2')}</label></th>
                                                        <td>
                                                            <input type="text" name="receiverAddressSub" value="{basiceShippingAddress.shippingAddressSub}" class="input-text wp100" />
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th class="required"><label class="tit">{=__('우편번호')}</label></th>
                                                        <td>
                                                            <input type="text" name="receiverZonecode" value="{basiceShippingAddress.shippingZonecode}" <!--{ ? !gGlobal.isFront }-->style="width:40px;"<!--{ / }--> class="input-text wp100" />
                                                            <input type="hidden" name="receiverZipcode" value="{basiceShippingAddress.shippingZipcode}"/>
                                                        </td>
                                                    </tr>
                                                    <!--{ : }-->
                                                    <tr>
                                                        <th class="required"><label class="tit">{=__('주소')}</label></th>
                                                        <td class="input_content input_address">
                                                            <div class="zipcode-block">
                                                                <div class="zipcode-flex">
                                                                    <label class="zipcode">
                                                                        <input type="text" class="input-text wp100" name="receiverZonecode" value="{basiceShippingAddress.shippingZonecode}"  readonly="readonly" >
                                                                    </label>
                                                                    <input type="hidden" name="receiverZipcode" value="{basiceShippingAddress.shippingZipcode}"/>
                                                                </div>
                                                                <div class="zipcode-fix">
                                                                    <button class="btn btn_gr post-search" type="button" id="btnPostcode" onclick="postcode_search('receiverZonecode', 'receiverAddress', 'receiverZipcode');">
                                                                        <em class="h35 arrow">{=__('우편번호')}</em>
                                                                    </button>
                                                                </div>
                                                            </div>
                                                            <div class="zipcode-block">
                                                                <input type="text" name="receiverAddress" value="{basiceShippingAddress.shippingAddress}" readonly="readonly" class="input-text wp100" >
                                                            </div>
                                                            <div class="zipcode-block">
                                                                <input type="text" name="receiverAddressSub" value="{basiceShippingAddress.shippingAddressSub}" class="input-text wp100">
                                                            </div>
                                                        </td>
                                                    </tr>
                                                    <!--{ / }-->
                                                    <tr>
                                                        <th><label class="tit">{=__('전화번호')}</label></th>
                                                        <td>
                                                            <!--{ ? gGlobal.isFront }-->
                                                            <div class="cell">
                                                                <div class="inp_sel">
                                                                    {=gd_select_box('receiverPhonePrefixCode', 'receiverPhonePrefixCode', countryPhone, null, null, __('국가코드'), null, 'tune select-small')}
                                                                </div>
                                                            </div>
                                                            <!--{ / }-->
                                                            <input type="text" id="receiverPhone" name="receiverPhone" value="{basiceShippingAddress.shippingPhone}" class="input-text wp100">
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th class="required"><label class="tit">{=__('휴대폰번호')}</label></th>
                                                        <td>
                                                            <!--{ ? gGlobal.isFront }-->
                                                            <div class="cell">
                                                                <div class="inp_sel">
                                                                    {=gd_select_box('receiverCellPhonePrefixCode', 'receiverCellPhonePrefixCode', countryPhone, null, null, __('국가코드'), null, 'tune select-small')}
                                                                </div>
                                                            </div>
                                                            <!--{ / }-->
                                                            <div class="cell">
                                                                <input type="text" id="receiverCellPhone" name="receiverCellPhone" value="{basiceShippingAddress.shippingCellPhone}" class="input-text wp100">
                                                            </div>
                                                        </td>
                                                    </tr>
                                                    <!--{ ? gGlobal.isFront == false && useSafeNumberFl == 'y'}-->
                                                    <tr>
                                                        <th><label class="tit">{=__('안심번호')}</label></th>
                                                        <td>
                                                            <div class="cell inp_chk" style="position:static;">
                                                                <input type="checkbox" name="receiverUseSafeNumberFl" id="receiverUseSafeNumberFl" class="sp" value="w" checked="checked">
                                                                <label for="receiverUseSafeNumberFl">{=__('안심번호 사용')}</label>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                    <!--{ / }-->
                                                    </tbody>
                                                </table>
                                            </div>
                                            <!--{ ? gd_is_login() === true && !gGlobal.isFront && reflectApplyMemberUseFl }-->
                                            <p id="memberinfoApplyTr1" class="shipping-save inp_chk" style="position:static;">
                                                <input type="checkbox" name="reflectApplyMember" class="sp" value="y" id="reflectApplyMember" />
                                                <label for="reflectApplyMember">{=__('위 내용을 회원정보에 반영합니다.')} <small>({=__('주소')}/{=__('전화번호')}/{=__('휴대폰번호')})</small></label>
                                            </p>
                                            <!--{ / }-->
                                        </div>
                                    </div>

                                    <div id="tab2" class="tab-content1">
                                        <div class="join_bx2">
                                            <div class="delivery-list-add"></div>
                                            <div class="delivery-list"></div>
                                            <input type="hidden" name="shippingCellPhonePrefix" value="" />
                                            <input type="hidden" name="shippingPhonePrefix" value="" />
                                            <input type="hidden" name="shippingSno" value="" />
                                            <div class="order-table-area">
                                                <div class="tbl order-table">
                                                    <table class="tbl-order">
                                                        <colgroup>
                                                            <col>
                                                            <col>
                                                        </colgroup>
                                                        <tbody>
                                                        <tr>
                                                            <th class="required"><label class="tit">{=__('이름')}</label></th>
                                                            <td>
                                                                <input type="text" name="shippingName" value="" maxlength="20" class="input-text wp100">
                                                            </td>
                                                        </tr>
                                                        <!--{ ? gGlobal.isFront }-->
                                                        <tr>
                                                            <th class="required"><label class="tit">{=__('국가')}</label></th>
                                                            <td>
                                                                <div class="inp_sel">
                                                                    {=gd_select_box('shippingCountryCode', 'shippingCountryCode', countryAddress, null, recommendCountryCode, __('=선택해주세요='), null)}
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <th class="required"><label class="tit">{=__('도시')}</label></th>
                                                            <td>
                                                                <input type="text" name="shippingCity" value="" maxlength="20" class="input-text wp100" />
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <th class="required"><label class="tit">{=__('주/지방/지역')}</label></th>
                                                            <td>
                                                                <input type="text" name="shippingState" value="" maxlength="20" class="input-text wp100" />
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <th class="required"><label class="tit">{=__('주소1')}</label></th>
                                                            <td>
                                                                <input type="text" name="shippingAddress" value="" class="input-text wp100" />
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <th class="required"><label class="tit">{=__('주소2')}</label></th>
                                                            <td>
                                                                <input type="text" name="shippingAddressSub" value="" class="input-text wp100" />
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <th class="required"><label class="tit">{=__('우편번호')}</label></th>
                                                            <td>
                                                                <input type="text" name="shippingZonecode" value="" <!--{ ? !gGlobal.isFront }-->style="width:40px;"<!--{ / }--> class="input-text wp100" />
                                                                <input type="hidden" name="shippingZipcode" value=""/>
                                                            </td>
                                                        </tr>
                                                        <!--{ : }-->
                                                        <tr>
                                                            <th class="required"><label class="tit">{=__('주소')}</label></th>
                                                            <td class="input_content input_address">
                                                                <div class="zipcode-block">
                                                                    <div class="zipcode-flex">
                                                                        <label class="zipcode">
                                                                            <input type="text" class="input-text wp100" name="shippingZonecode" value=""  readonly="readonly" >
                                                                        </label>
                                                                        <input type="hidden" name="shippingZipcode" value=""/>
                                                                    </div>
                                                                    <div class="zipcode-fix">
                                                                        <button class="btn btn_gr post-search" type="button" id="btnPostcode" onclick="postcode_search('shippingZonecode', 'shippingAddress', 'shippingZipcode');">
                                                                            <em class="h35 arrow">{=__('우편번호')}</em>
                                                                        </button>
                                                                    </div>
                                                                </div>
                                                                <div class="zipcode-block">
                                                                    <input type="text" name="shippingAddress" value="" readonly="readonly" class="input-text wp100" >
                                                                </div>
                                                                <div class="zipcode-block">
                                                                    <input type="text" name="shippingAddressSub" value="" class="input-text wp100">
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        <!--{ / }-->
                                                        <tr>
                                                            <th><label class="tit">{=__('전화번호')}</label></th>
                                                            <td>
                                                                <!--{ ? gGlobal.isFront }-->
                                                                <div class="cell">
                                                                    <div class="inp_sel">
                                                                        {=gd_select_box('shippingPhonePrefixCode', 'shippingPhonePrefixCode', countryPhone, null, null, __('국가코드'), null, 'tune select-small')}
                                                                    </div>
                                                                </div>
                                                                <!--{ / }-->
                                                                <input type="text" id="shippingPhone" name="shippingPhone" value="" class="input-text wp100">
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <th class="required"><label class="tit">{=__('휴대폰번호')}</label></th>
                                                            <td>
                                                                <!--{ ? gGlobal.isFront }-->
                                                                <div class="cell">
                                                                    <div class="inp_sel">
                                                                        {=gd_select_box('shippingCellPhonePrefixCode', 'shippingCellPhonePrefixCode', countryPhone, null, null, __('국가코드'), null, 'tune select-small')}
                                                                    </div>
                                                                </div>
                                                                <!--{ / }-->
                                                                <div class="cell">
                                                                    <input type="text" id="shippingCellPhone" name="shippingCellPhone" value="{basiceShippingAddress.shippingCellPhone}" class="input-text wp100">
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        <!--{ ? gGlobal.isFront == false && useSafeNumberFl == 'y'}-->
                                                        <tr>
                                                            <th><label class="tit">{=__('안심번호')}</label></th>
                                                            <td>
                                                                <div class="cell inp_chk" style="position:static;">
                                                                    <input type="checkbox" name="shippingUseSafeNumberFl" id="shippingUseSafeNumberFl" class="sp" value="w" checked="checked">
                                                                    <label for="shippingUseSafeNumberFl">{=__('안심번호 사용')}</label>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        <!--{ / }-->
                                                        </tbody>
                                                    </table>
                                                </div>
                                                <!--{ ? gd_is_login() === true }-->
                                                <p class="shipping-save inp_chk" style="position:static;">
                                                    <input type="checkbox" name="shippingDefault" class="sp" value="y" id="shippingDefault" />
                                                    <label for="shippingDefault">{=__('기본 배송지로 설정합니다.')}</label>
                                                </p>
                                                <!--{ / }-->
                                                <!--{ ? gd_is_login() === true && !gGlobal.isFront }-->
                                                <p id="memberinfoApplyTr2" class="shipping-save inp_chk" style="position:static;">
                                                    <input type="checkbox" name="reflectApplyShippingMember" class="sp" value="y" id="reflectApplyShippingMember" />
                                                    <label for="reflectApplyShippingMember">{=__('위 내용을 회원정보에 반영합니다.')} <small>({=__('주소')}/{=__('전화번호')}/{=__('휴대폰번호')})</small></label>
                                                </p>
                                                <!--{ / }-->
                                            </div>
                                        </div>
                                    </div>

                                    <div id="tab3" class="tab-content1">
                                        <div class="join_bx2">
                                            <div class="tbl order-table">
                                                <table class="tbl-order">
                                                    <colgroup>
                                                        <col>
                                                        <col>
                                                    </colgroup>
                                                    <tbody>
                                                    <tr>
                                                        <td colspan="2">
                                                            <div class="inp_chk" style="position:static;">
                                                                <input type="checkbox" id="shippingSameCheck" onclick="order_info_same();"  class="sp require">
                                                                <label for="shippingSameCheck">
                                                                    {=__('주문고객정보와 동일합니다.')}
                                                                </label>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th class="required"><label class="tit">{=__('이름')}</label></th>
                                                        <td>
                                                            <input type="text" class="input-text wp100" name="directName">
                                                        </td>
                                                    </tr>
                                                    <!--{ ? gGlobal.isFront }-->
                                                    <tr>
                                                        <th class="required"><label class="tit">{=__('국가')}</label></th>
                                                        <td>
                                                            <div class="inp_sel">
                                                                {=gd_select_box('directCountryCode', 'directCountryCode', countryAddress, null, recommendCountryCode, __('=선택해주세요='), null)}
                                                            </div>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th class="required"><label class="tit">{=__('도시')}</label></th>
                                                        <td>
                                                            <input type="text" name="directCity" value="" maxlength="20" class="input-text wp100" />
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th class="required"><label class="tit">{=__('주/지방/지역')}</label></th>
                                                        <td>
                                                            <input type="text" name="directState" value="" maxlength="20" class="input-text wp100" />
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th class="required"><label class="tit">{=__('주소1')}</label></th>
                                                        <td>
                                                            <input type="text" name="directAddress" value="" class="input-text wp100" />
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th class="required"><label class="tit">{=__('주소2')}</label></th>
                                                        <td>
                                                            <input type="text" name="directAddressSub" value="" class="input-text wp100" />
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th class="required"><label class="tit">{=__('우편번호')}</label></th>
                                                        <td>
                                                            <input type="text" name="directZonecode" value="" <!--{ ? !gGlobal.isFront }-->style="width:40px;"<!--{ / }--> class="input-text wp100" />
                                                            <input type="hidden" name="directZipcode" value=""/>
                                                        </td>
                                                    </tr>
                                                    <!--{ : }-->
                                                    <tr>
                                                        <th class="required"><label class="tit">{=__('주소')}</label></th>
                                                        <td class="input_content input_address">
                                                            <div class="zipcode-block">
                                                                <div class="zipcode-flex">
                                                                    <label class="zipcode">
                                                                        <input type="text" name="directZonecode" class="input-text wp100"  size="5">
                                                                    </label>
                                                                    <input type="hidden" name="directZipcode">
                                                                </div>
                                                                <div class="zipcode-fix">
                                                                    <button class="btn btn_gr post-search" type="button" onclick="postcode_search('directZonecode', 'directAddress', 'directZipcode');">
                                                                        {=__('우편번호')}
                                                                    </button>

                                                                </div>
                                                            </div>
                                                            <div class="zipcode-block">
                                                                <input type="text" class="input-text wp100" name="directAddress" readonly="readonly" value="">
                                                            </div>
                                                            <div class="zipcode-block">
                                                                <input type="text" class="input-text wp100" name="directAddressSub" value="">
                                                            </div>
                                                        </td>
                                                    </tr>
                                                    <!--{ / }-->
                                                    <tr>
                                                        <th><label class="tit">{=__('전화번호')}</label></th>
                                                        <td>
                                                            <!--{ ? gGlobal.isFront }-->
                                                            <div class="cell">
                                                                <div class="inp_sel">
                                                                    {=gd_select_box('directPhonePrefixCode', 'directPhonePrefixCode', countryPhone, null, null, __('국가코드'), null, 'tune select-small')}
                                                                </div>
                                                            </div>
                                                            <!--{ / }-->
                                                            <input type="text" name="directPhone" class="input-text wp100">
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th class="required"><label class="tit">{=__('휴대폰번호')}</label></th>
                                                        <td>
                                                            <!--{ ? gGlobal.isFront }-->
                                                            <div class="cell">
                                                                <div class="inp_sel">
                                                                    {=gd_select_box('directCellPhonePrefixCode', 'directCellPhonePrefixCode', countryPhone, null, null, __('국가코드'), null, 'tune select-small')}
                                                                </div>
                                                            </div>
                                                            <!--{ / }-->
                                                            <input type="text" name="directCellPhone" class="input-text wp100">
                                                        </td>
                                                    </tr>
                                                    <!--{ ? gGlobal.isFront == false && useSafeNumberFl == 'y'}-->
                                                    <tr>
                                                        <th><label class="tit">{=__('안심번호')}</label></th>
                                                        <td>
                                                            <div class="cell inp_chk" style="position:static;">
                                                                <input type="checkbox" name="directUseSafeNumberFl" id="directUseSafeNumberFl" class="sp" value="w" checked="checked">
                                                                <label for="directUseSafeNumberFl">{=__('안심번호 사용')}</label>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                    <!--{ / }-->
                                                    </tbody>
                                                </table>
                                            </div>
                                            <!--{ ? gd_is_login() === true }-->
                                            <p class="shipping-save inp_chk" style="position:static;">
                                                <input type="checkbox" value="y" id="reflectApplyDelivery" name="reflectApplyDelivery"  class="sp require">
                                                <label for="reflectApplyDelivery">
                                                    {=__('배송지 목록에 추가합니다.')}
                                                </label>
                                            </p>
                                            <!--{ / }-->
                                            <!--{ ? gd_is_login() === true && !gGlobal.isFront }-->
                                            <p id="memberinfoApplyTr3" class="shipping-save inp_chk" style="position:static;">
                                                <input type="checkbox" name="reflectApplyDirectMember" class="sp" value="y" id="reflectApplyDirectMember" />
                                                <label for="reflectApplyDirectMember">{=__('위 내용을 회원정보에 반영합니다.')} <small>({=__('주소')}/{=__('전화번호')}/{=__('휴대폰번호')})</small></label>
                                            </p>
                                            <!--{ / }-->
                                        </div>
                                    </div>
                                </div>
                                <div class="join_bx2">
                                    <div class="tbl order-table">
                                        <table>
                                            <tr>
                                                <th><label class="tit">{=__('남기실 말씀')}</label></th>
                                                <td>
                                                    <input type="text" name="orderMemo" class="input-text wp100">
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            <div class="order-visit dn">
                                <h2 class="my_tit">
                                    <b>{=__('방문수령 정보')}</b>
                                    <!--{ ? isUseMultiShipping === true }-->
                                    <span class="inp_chk dn" style="position:relative; margin:0; float:right;">
                                        <input type="checkbox" id="visitMultiShippingFl" value="y" class="sp">
                                        <label for="visitMultiShippingFl">{=__('복수 배송지 이용')}</label>
                                    </span>
                                    <!--{ / }-->
                                </h2>
                                <div class="tbl">
                                <table class="order-table">
                                    <tr>
                                        <th><label class="tit">{=__('방문 수령지 주소')}</label></th>
                                        <td>
                                            <span class="delivery-method-visit-area-txt"></span>
                                            <input type="hidden" name="visitAddress" value="">
                                        </td>
                                    </tr>
                                    <tr>
                                        <th class="required"><label class="tit">{=__('방문자명')}</label></th>
                                        <td>
                                            <input type="text" name="visitName" value="" class="input-text wp100" />
                                        </td>
                                    </tr>
                                    <tr>
                                        <th class="required"><label class="tit">{=__('방문자연락처')}</label></th>
                                        <td>
                                            <input type="text" name="visitPhone" value="" class="input-text wp100" />
                                        </td>
                                    </tr>
                                    <tr>
                                        <th><label class="tit">{=__('메모')}</label></th>
                                        <td>
                                            <input type="text" name="visitMemo" value="" maxlength="250" class="input-text wp100" />
                                        </td>
                                    </tr>
                                </table>
                                </div>
                            </div>
                            <!--{ ? isUseMultiShipping === true }-->
                            <div class="join_bx2 select-goods-area dn" data-shipping-no="0">
                                <div class="tbl order-table">
                                    <table>
                                        <tr>
                                            <th class="required"><label class="tit">{=__('배송상품')}</label></th>
                                            <td>
                                                <input type="hidden" name="selectGoods[0]" value="">
                                                <input type="hidden" name="multiDelivery[0]" value="0">
                                                <a class="btn btn_w btn-open-layer shipping-goods-select">{=__('상품선택')}</a>
                                            </td>
                                        </tr>
                                    </table>
                                    <div class="my_goods v3 v4 select-goods order-goods dn" style="background:#fff;">
                                        <table class="info check btn_list" style="display:table; margin-left:0;"></table>
                                    </div>
                                </div>
                            </div>
                            <a class="btn shipping-add-btn btn_g1 dn">+ {=__('배송지 추가')}</a>
                            <!--{ / }-->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--{ ? addFieldInfo.addFieldConf == 'y' }-->
        <input type="hidden" name="addFieldConf" value="{=addFieldInfo.addFieldConf}" />
        <h2 class="my_tit">{=__('추가 정보')}</h2>
        <fieldset>
            <legend>{=__('추가 정보 영역')}</legend>
            <div class="join_bx2">
                <div class="tbl">
                    <table class="tbl-order">
                        <caption>
                            <span>{=__('정보입력')}</span>
                        </caption>
                        <colgroup>
                            <col>
                        </colgroup>
                        <tbody>
                        <!--{ @ addFieldInfo.data }-->
                        <tr>
                            <th scope="row"><label class="tit">{=gd_isset(.orderAddFieldName)}</label></th>
                        </tr>
                        <tr>
                            <td>
                                {=gd_isset(.orderAddFieldHtml)}
                            </td>
                        </tr>
                        <!--{ / }-->
                        </tbody>
                    </table>
                </div>
            </div>
        </fieldset>
        <!--{ / }-->

        <h2 class="my_tit">{=__('할인 및 최종결제금액')}</h2>
        <fieldset>

            <div class="join_bx2">
                <div class="tbl">
                    <table class="tbl-order-payment">
                        <caption>
                            <span>{=__('정보입력')}</span>
                        </caption>
                        <colgroup>
                            <col>
                            <col>
                        </colgroup>
                        <tbody>
                        <tr>
                            <th scope="row"><label class="tit">{=__('상품 금액')}</label></th>
                            <td>
                                <strong class="total"  id="totalGoodsPrice" >{=gd_global_currency_display(totalGoodsPrice)}</strong>
                                <!--{ ? gGlobal.isFront }-->
                                <span class="add_currency">{=gd_global_add_currency_display(totalGoodsPrice)}</span>
                                <!--{ / }-->
                            </td>
                        </tr>
                        <!--{ ? gGlobal.isFront }-->
                        <tr>
                            <th scope="row">{=__('총 무게')}</th>
                            <td>
                                {=number_format(totalDeliveryWeight.total, 2)}kg<br>
                                <span>( {=__('상품무게 %s kg + 박스무게 %s kg', number_format(totalDeliveryWeight.goods, 2), number_format(totalDeliveryWeight.box, 2))} )</span>
                            </td>
                        </tr>
                        <!--{ / }-->
                        <tr>
                            <th scope="row"><label class="tit">{=__('배송비')}</label></th>
                            <td>
                                {=gd_global_currency_symbol()}<span id="totalDeliveryCharge">{=gd_global_money_format(totalDeliveryCharge)}</span>{=gd_global_currency_string()}
                                <!--{ ? gGlobal.isFront && gGlobal.useAddCurrency }-->
                                {=gd_global_add_currency_symbol()}<span id="totalDeliveryChargeAdd" class="add_currency">{=gd_global_add_money_format(totalDeliveryCharge)}</span>{=gd_global_add_currency_string()}
                                <!--{ / }-->
                                <div class="multi-shipping-text"></div>
                            </td>
                        </tr>
                        <tr id="rowDeliveryInsuranceFee" class="dn">
                            <th scope="row"><label class="tit">{=__('해외배송 보험료')}</label></th>
                            <td>
                                {=gd_global_currency_symbol()}<span id="deliveryInsuranceFee">0</span>{=gd_global_currency_string()}
                                <!--{ ? gGlobal.isFront && gGlobal.useAddCurrency }-->
                                {=gd_global_add_currency_symbol()}<span id="deliveryInsuranceFeeAdd" class="add_currency">0</span>{=gd_global_add_currency_string()}
                                <!--{ / }-->
                                <input type="hidden" name="deliveryInsuranceFee" value="0">
                                <input type="hidden" name="deliveryInsuranceFeeAdd" value="0">
                            </td>
                        </tr>
                        <tr id="rowDeliverAreaCharge" class="dn">
                            <th scope="row"><label class="tit">{=__('지역별 배송비')}</label></th>
                            <td>
                                {=gd_global_currency_symbol()}<span id="deliveryAreaCharge">0</span>{=gd_currency_string()}
                                <input type="hidden" name="totalDeliveryCharge" value="{totalDeliveryCharge}">
                                <input type="hidden" name="deliveryAreaCharge" value="0">
                            </td>
                        </tr>
                        <tr>
                            <th scope="row"><label class="tit">{=__('할인 및 적립')}</label></th>
                            <td>
                                <div class="pay-benefits">
                                    <p id="sale-default" class="sale">{=__('할인')} : <strong>(-) {=gd_global_currency_symbol()}<b class="total-member-dc-price">{=gd_global_money_format(totalGoodsDcPrice + totalSumMemberDcPrice + totalCouponGoodsDcPrice + totalMyappDcPrice)}</b>{=gd_global_currency_string()}</strong>
                                        <!--{ ? gGlobal.isFront && gGlobal.useAddCurrency }-->
                                        <span class="total-member-dc-price-add add_currency">{=gd_global_add_currency_display(totalGoodsDcPrice + totalSumMemberDcPrice + totalCouponGoodsDcPrice + totalMyappDcPrice)}</span>
                                        <!--{ / }-->
                                        <span>
                                            (
                                            {=__('상품')} {=gd_global_currency_display(totalGoodsDcPrice)},
                                            {=__('회원')} <span class="member-dc-price">{=gd_global_currency_display(totalSumMemberDcPrice)}</span>,
                                            {=__('쿠폰')} <span class="goods-coupon-dc-price">{=gd_global_currency_display(totalCouponGoodsDcPrice)}</span>
                                            <!--{ ? totalMyappDcPrice > 0 }-->,
                                            {=__('모바일앱')} <span class="goods-myapp-dc-price">{=gd_global_currency_display(totalMyappDcPrice)}</span>
                                            <!--{ / }-->
                                            )
                                        </span>
                                    </p>
                                    <p id="sale-without-member" class="sale dn">{=__('할인')} : <strong>(-) {=gd_global_currency_symbol()}<b class="total-member-dc-price-without-member">{=gd_global_money_format(totalGoodsDcPrice +totalCouponGoodsDcPrice + totalMyappDcPrice)}</b>{=gd_global_currency_string()}</strong>
                                        <span>
                                            (
                                            {=__('상품')} {=gd_global_currency_display(totalGoodsDcPrice)},
                                            {=__('회원')} {=gd_global_currency_display(0)},
                                            {=__('쿠폰')} <span class="goods-coupon-dc-price-without-member">{=gd_global_currency_display(totalCouponGoodsDcPrice)}</span>
                                            <!--{ ? totalMyappDcPrice > 0 }-->,
                                            {=__('모바일앱')} <span class="goods-myapp-dc-price">{=gd_global_currency_display(totalMyappDcPrice)}</span>
                                            <!--{ / }-->
                                            )
                                        </span>
                                    </p>
                                    <!--{ ? gd_is_login() === true }-->
                                    <!--{ ? deliveryFree == 'y' && totalDeliveryCharge > 0 }-->
                                    <p class="sale">
                                        배송비 할인 : <strong>(-) {=gd_currency_symbol()}<b class="delivery-free">0</b>{=gd_currency_string()}</strong> <span>({=__('회원등급 배송할인')})</span>
                                    </p>
                                    <!--{ / }-->
                                    <!--{ ? mileage.useFl === 'y' }-->
                                    <p id="mileage-default" class="mileage">
                                        {=__('적립')} {=mileage.name} :
                                        <strong>(+) <b class="total-member-mileage">{=gd_global_money_format(totalMileage)}</b>{=mileage.unit}</strong><br>
                                        <span>
                                            (
                                            {=__('상품')} <span class="goods-mileage">{=gd_global_money_format(totalGoodsMileage)}</span>{=mileage.unit},
                                            {=__('회원')} <span class="member-mileage">{=gd_global_money_format(totalMemberMileage)}</span>{=mileage.unit},
                                            {=__('쿠폰')} <span class="goods-coupon-add-mileage">{=gd_global_money_format(totalCouponGoodsMileage)}</span>{=mileage.unit}
                                            )
                                        </span>
                                    </p>
                                    <p id="mileage-without-member" class="mileage dn m-withoutmember">
                                        {=__('적립')} {=mileage.name} :
                                        <strong>(+) <b class="total-member-mileage-without-member">{=gd_global_money_format(totalGoodsMileage + totalCouponGoodsMileage)}</b>{=mileage.unit}</strong><br>
                                        <span>
                                            (
                                            {=__('상품')} {=gd_global_money_format(totalGoodsMileage)}{=mileage.unit},
                                            {=__('회원')} {=gd_global_money_format(0)}{=mileage.unit},
                                            {=__('쿠폰')} <span class="goods-coupon-add-mileage-without-member">{=gd_global_money_format(totalCouponGoodsMileage)}</span>{=mileage.unit}
                                            )
                                        </span>
                                    </p>
                                    <!--{ / }-->
                                </div>
                            </td>
                        </tr>
                        <!--{ : }-->
                        <!--{ ? totalGoodsDcPrice > 0 }-->
                        <tr>
                            <th scope="row"><label class="tit">{=__('상품 할인')}</label></th>
                            <td>
                                {=gd_global_currency_display(totalGoodsDcPrice)}
                            </td>
                        </tr>
                        <!--{ / }-->
                        <!--{ / }-->
                        <!--{ ? (couponUse == 'y' && couponConfig['chooseCouponMemberUseType'] != 'member') && gd_is_login() === true }-->
                        <tr>
                            <th scope="row">
                                <label class="tit">{=__('보유쿠폰 사용')}</label>
                            </th>
                            <td>
                                <span class="tx">
                                    <input type="hidden" name="couponApplyOrderNo" value="" />
                                    <input type="hidden" name="totalCouponOrderDcPrice" value="" />
                                    <input type="hidden" name="totalCouponOrderPrice" value="" />
                                    <input type="hidden" name="totalCouponOrderMileage" value="" />
                                    <input type="hidden" name="totalCouponDeliveryDcPrice" value="" />
                                    <input type="hidden" name="totalCouponDeliveryPrice" value="" />
                                    <div class="pay-benefits order-coupon-benefits dn">
                                        <em class="sale">{=__('주문할인')} : (-) {=gd_global_currency_symbol()}<b id="useDisplayCouponDcPrice">{=gd_global_money_format(0)}</b>{=gd_global_currency_string()}</em><br/>
                                        <em class="sale">{=__('배송비할인')} :(-) {=gd_global_currency_symbol()}<b id="useDisplayCouponDelivery">{=gd_global_money_format(0)}</b>{=gd_global_currency_string()}</em><br/>
                                        <em class="mileage">
                                            {=__('적립')} {=mileage.name} :(+) <b id="useDisplayCouponMileage">{=gd_global_money_format(0)}</b>{=mileage.unit}
                                        </em>
                                    </div>
                                    <a href="#couponOrderApplyLayer" class="btn btn_gr single-btn btn-open-layer">
                                      <em class="h28">{=__('쿠폰 조회 및 적용')}</em>
                                    </a>
                                </span>
                            </td>
                        </tr>
                        <!--{ / // end couponUse }-->
                        <!--{ ? mileageUse.payUsableFl === 'y' }-->
                        <tr>
                            <th scope="row">
                                <label class="tit">{=mileage.name} {=__('사용')}</label>
                            </th>
                            <td>
                                <!--{ ? gd_is_login() == false }-->
                                <span class="tx">{=__('회원만 사용 가능합니다')}</span>
                                <!--{ : }-->

                                <div class="input_content">
                                    <div class="fluid-block">
                                        <!--{ ? mileageUse.usableFl == 'y' }-->
                                        <div class="fluid-float">
                                        <span class="inp_chk" style="position:static;">
                                            <input type="checkbox" class="checkbox sp"  id="useMileageAll" onclick="mileage_use_all();" ><label for="useMileageAll">{=__('전액사용')}</label>
                                        </span>
                                        </div>
                                        <!--{ / // end mileageUse_usableFl }-->
                                        <div class="fluid-fix">
                                            <div class="input-won">
                                                <input type="number" class="input-text wp100"  name="useMileage" value="" onblur="mileage_use_check('y', 'y', 'y');">
                                            </div>
                                        </div>
                                    </div>
                                    <p class="point-view">
                                        <span class="">({=__('보유')} {=mileage.name} : <em class="red">{=gd_global_money_format(gMemberInfo.mileage)}{=mileage.unit}</em>)</span><br/>
                                        <span class="js-mileageInfoArea"></span>
                                    </p>
                                </div>
                                <!--{ / // end is_login_false }-->
                            </td>
                        </tr>
                        <!--{ / // end mileageUse_payUsableFl }-->
                        <!--{ ? depositUse.payUsableFl === 'y' }-->
                        <tr>
                            <th scope="row">
                                <label class="tit">{=depositUse.name} {=__('사용')}</label>
                            </th>
                            <td>
                                <!--{ ? gd_is_login() == false }-->
                                <span class="tx">{=__('회원만 사용 가능합니다')}</span>
                                <!--{ : }-->

                                <div class="input_content">
                                    <div class="fluid-block">
                                        <div class="fluid-float">
                                        <span class="inp_chk" style="position:static;">
                                            <input type="checkbox" class="checkbox sp" id="useDepositAll" onclick="deposit_use_all();"><label for="useDepositAll">{=__('전액사용')}</label>
                                        </span>
                                        </div>
                                        <div class="fluid-fix">
                                            <div class="input-won">
                                                <input type="number" class="input-text wp100"name="useDeposit" value="" onblur="deposit_use_check();">
                                            </div>
                                        </div>
                                    </div>
                                    <p class="point-view">
                                        <span class="">({=__('보유')} {=depositUse.name} : <em class="red">{=gd_global_money_format(gMemberInfo.deposit)}</em>)</span>
                                    </p>
                                </div>
                                <!--{ / // end is_login_false }-->
                            </td>
                        </tr>
                        <!--{ / // end depositUse_payUsableFl }-->
                        </tbody>
                    </table>
                </div>
            </div>
        </fieldset>

        <div class="sum_prc_wrap">
            <dl class="sum_prc">
                <dt>{=__('최종 결제금액')}</dt>
                <dd>
                    <input type="hidden" name="settlePrice" value="{=gd_global_money_format(totalSettlePrice, false)}">
                    <input type="hidden" name="overseasSettlePrice" value="0" />
                    <input type="hidden" name="overseasSettleCurrency" value="KRW" />
                    <span class="c-red">{=gd_global_currency_symbol()}
                        <strong id="totalSettlePriceView">{=gd_global_money_format(totalSettlePrice)}</strong>
                        {=gd_global_currency_string()}
                        <br>
                        <!--{ ? gGlobal.isFront && gGlobal.useAddCurrency }-->
                        <span class="add_currency">{=gd_global_add_currency_symbol()}<strong id="totalAddSettlePrice">{=gd_global_add_money_format(totalSettlePrice)}</strong>{=gd_global_add_currency_string()}</span>
                        <!--{ / }-->
                    </span>
                </dd>
            </dl>
        </div>

        <div class="how-to-pay">
            <div class="js-pay-content">
                <!--{ ? isset(payco) && !isset(settle.general.pp) }-->
                <!-- 페이코 컨텐츠 -->
                <div id="settlekind_payco" class="process">
                    <h2 class="my_tit pay_tit">
                        <img src="/data/commonimg/payment_check_off.png" alt="" class="js-payment-check-payco" onclick="settlekind_toggle_check('payco');" />
                        <div class="payco_tit">
                            {payco}
                        </div>
                    </h2>
                    <ul class="pay_mth_payco js-gd5-settlekind-payco">
                        <!--{ @ settle.payco }-->
                        <!--{ ? .value_.useFl == 'y' }-->
                        <li>
                            <span class="inp_rdo payco">
                                <img src="/data/commonimg/payco_mobile_{=.key_}_icon_off.png" alt="{=.value_.name}" class="js-payco-icon-{=.key_}" width="100%" onclick="payco_toggle('{=.key_}');" />
                                <input type="radio" name="settleKind" id="settleKind_payco_{=.key_}" value="{=.key_}" class="sp"/>
                            </span>
                        </li>
                        <!--{ / }-->
                        <!--{ / }-->
                    </ul>
                </div>
                <!--// 페이코 컨텐츠 -->
                <!--{ / }-->

                <h2 class="my_tit pay_tit">
                    <img src="/data/commonimg/payment_check_off.png" alt="" class="js-payment-check-general" onclick="settlekind_toggle_check('general')" />
                    {=__('결제 수단 선택')}
                </h2>
                <ul class="pay_mth">
                    <!--{ ? isset(settle.general) }-->
                    <li>
                        <span class="inp_rdo" id="span-payment2">
                            <input type="radio" name="payment" id="payment2" class="sp" onclick="settlekind_toggle()" />
                            <label for="payment2">{=__('일반결제')}</label>
                        </span>
                    </li>
                    <!--{ / }-->
                    <!--{ ? isset(settle.escrow) }-->
                    <li>
                        <span class="inp_rdo" id="span-payment3">
                            <input type="radio" name="payment" id="payment3" class="sp" onclick="settlekind_toggle()" />
                            <label for="payment3">{=__('에스크로결제')}</label>
                        </span>
                    </li>
                    <!--{ / }-->
                    <!--{ ? isset(settle.overseas) }-->
                    <li>
                        <span class="inp_rdo" id="span-payment4">
                            <input type="radio" name="payment" id="payment4" class="sp" onclick="settlekind_toggle()" />
                            <label for="payment4">{=__('해외PG')}</label>
                        </span>
                    </li>
                    <!--{ / }-->
                </ul>

                <!-- 에스크로 컨텐츠 -->
                <div id="settlekind_escrow" class="process dn">
                    <h2 class="my_tit js-gd5-settlekind-escrow">{=__('에스크로')}</h2>
                    <ul class="pay_mth js-gd5-settlekind-escrow">
                        <p class="pay_notice v2">{=dataEggBanner('order')}</p>
                        <!--{ @ settle.escrow }-->
                        <!--{ ? .value_.useFl == 'y' }-->
                        <li>
                            <span class="inp_rdo">
                                <input type="radio" name="settleKind" id="settleKind_{=.key_}" value="{=.key_}" class="sp"/>
                                <label for="settleKind_{=.key_}">{=.value_.name}</label>
                            </span>
                        </li>
                        <!--{ / // end useFl }-->
                        <!--{ / // end settle_escrow }-->
                    </ul>
                </div>
                <!-- //에스크로 컨텐츠 -->

                <!--{ ? settle.overseas }-->
                <!-- 해외PG 컨텐츠 -->
                <div id="settlekind_overseas" class="process dn">
                    <h2 class="my_tit js-gd5-settlekind-overseas">{=__('해외PG')}</h2>
                    <ul class="pay_mth js-gd5-settlekind-overseas">
                        <!--{ @ settle.overseas }-->
                        <!--{ ? .value_.useFl == 'y' }-->
                        <li>
                            <span class="inp_rdo">
                                <input type="radio" name="settleKind" id="settleKind_{=.key_}" value="{=.key_}" class="sp"/>
                                <label for="settleKind_{=.key_}"><img src="/data/commonimg/overseas_mobile_{=.key_}_icon.png" alt="{=.value_.name}" width="60%" /></label>
                            </span>
                        </li>
                        <!--{ / // end useFl }-->
                        <!--{ / // end settle_overseas }-->
                    </ul>
                    <!--{ @ settle.overseas }-->
                    <!--{ ? .value_.useFl == 'y' }-->

                    <div class="dn" id="settlekind_overseas_{.key_}" data-settle-currency="{=.value_.pgCurrency}" data-settle-symbol="{=.value_.pgSymbol}" data-settle-decimal="{=.value_.pgDecimal}" data-settle-format="{=.value_.pgDecimalFormat}">
                        <!--{ ? .key_ == 'ou' }-->
                        <p class="pay_mth">* {=__('모바일 환경에서는 %s유니온페이 관련 프로그램%s이 설치되어야 정상적인 결제가 진행되므로 사전 확인바랍니다.','<a href="https://yunshanfu.unionpay.com" target="_blank" style="color:#117EF9; text-decoration:underline;">','</a>')}</p>
                        <!--{ / }-->
                        <h2 class="my_tit js-gd5-settlekind-overseas-{.key_}">{=.value_.name}</h2>
                        <fieldset class="js-gd5-settlekind-overseas-{.key_}">
                            <legend>{=__('승인금액')}</legend>
                            <div class="join_bx2">
                                <div class="tbl">
                                    <table>
                                        <colgroup>
                                            <col>
                                            <col>
                                        </colgroup>
                                        <tbody>
                                        <tr>
                                            <th>
                                                <label class="tit">{=__('승인금액')}</label>
                                            </th>
                                            <td>
                                                <div class="c-red overseas_settelprice" id="overseas_settelprice_{.key_}">0</div>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                        </fieldset>
                    </div>
                    <!--{ / }-->
                    <!--{ / }-->
                </div>
                <!-- //해외PG 컨텐츠 -->
                <!--{ / }-->

                <!-- 일반결제 컨텐츠 -->
                <div id="settlekind_general" class="process dn">
                    <h2 class="my_tit js-gd5-settlekind-general">{=__('일반결제')}</h2>
                    <ul class="pay_mth js-gd5-settlekind-general">
                        <!--{ @ settle.general }-->
                        <!--{ ? .value_.useFl == 'y' }-->
                        <li id="settlekind_type_{=.key_}">
                            <span class="inp_rdo">
                                <input type="radio" name="settleKind" id="settleKind_{=.key_}" value="{=.key_}" class="sp" />
                                <label for="settleKind_{=.key_}">{=.value_.name}</label>
                            </span>
                        </li>
                        <!--{ / // end useFl }-->
                        <!--{ / // end settle_general }-->
                    </ul>
                    <!--{ ? isset(settle.general.gb) }-->
                    <p class="js-gd5-settlekind-general pay_notice v2">( {=settle.general.gb.name}의 경우 입금확인 후부터 배송단계가 진행됩니다 )</p>
                    <!--{ / // end settle_general_gb }-->
                    <!-- //일반결제 컨텐츠 -->

                    <!--{ ? isset(settle.general.gb) }-->
                    <!-- 무통장입금 컨텐츠 -->
                    <div id="settlekind_general_gb" class="dn">
                        <h2 class="my_tit js-gd5-settlekind-general-gb">{=__('무통장입금')}</h2>
                        <fieldset class="js-gd5-settlekind-general-gb">
                            <legend>{=__('무통장입금 영역')}</legend>
                            <div class="join_bx2">
                                <div class="tbl">
                                    <table>
                                        <caption>
                                            <span>{=__('정보입력')}</span>
                                        </caption>
                                        <colgroup>
                                            <col>
                                            <col>
                                        </colgroup>
                                        <tbody>
                                        <tr>
                                            <th>
                                                <label for="bankAccount" class="tit">{=__('계좌정보')}</label>
                                            </th>
                                            <td>
                                                <div class="inp_sel">
                                                    <select name="bankAccount" id="bankAccount">
                                                        <option value="">{=__('선택하세요')}</option>
                                                        <!--{ @bank }-->
                                                        <option value="{.sno}">{.bankName} {.accountNumber} {.depositor}</option>
                                                        <!--{ / }-->
                                                    </select>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <th>
                                                <label class="tit" for="bankSender">{=__('입금자명')}</label>
                                            </th>
                                            <td>
                                                <div class="inp_tx">
                                                    <input type="text" name="bankSender" id="bankSender"/>
                                                </div>
                                            </td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </fieldset>
                    </div>
                    <!-- //무통장입금 컨텐츠 -->
                    <!--{ / // end settle_general_gb }-->

                    <!-- 신용카드 컨텐츠 -->
                    <!--{ ? isset(settle.general.pc) }-->
                    <h2 class="js-gd5-settlekind-general-pc my_tit" id="settlekind_general_pc">{=__('신용카드')}</h2>
                    <!--{ / // end settle_general_pc }-->
                    <!-- //신용카드 컨텐츠 -->

                    <!-- 계좌이체 컨텐츠 -->
                    <!--{ ? isset(settle.general.pb) }-->
                    <h2 class="js-gd5-settlekind-general-pb my_tit " id="settlekind_general_pb">{=__('계좌이체')}</h2>
                    <!--{ / }-->
                    <!-- //계좌이체 컨텐츠 -->

                    <!-- 가상계좌 컨텐츠 -->
                    <!--{ ? isset(settle.general.pv) }-->
                    <h2 class="js-gd5-settlekind-general-pv my_tit" id="settlekind_general_pv">{=__('가상계좌')}</h2>
                    <!--{ / }-->
                    <!-- //가상계좌 컨텐츠 -->

                    <!-- 휴대폰 컨텐츠 -->
                    <!--{ ? isset(settle.general.ph) }-->
                    <h2 class="js-gd5-settlekind-general-ph my_tit" id="settlekind_general_ph">{=__('휴대폰')}</h2>
                    <!--{ / }-->
                    <!-- //휴대폰 컨텐츠 -->

                    <!-- 페이코 포인트 -->
                    <!--{ ? isset(settle.general.pe) }-->
                    <h2 class="js-gd5-settlekind-general-pe my_tit" id="settlekind_general_pe">{=__('페이코 포인트')}</h2>
                    <!--{ / }-->
                    <!-- //페이코 포인트 -->
                </div>
            </div>
            <!--{ ? receipt['cashFl'] == 'y' || receipt['taxFl'] == 'y' }-->
            <h2 class="js-gd5-receipt-select my_tit">{=__('영수증 발급신청')}</h2>
            <ul class="js-gd5-receipt-select pay_mth block">
                <li>
                <span class="inp_rdo" id="non_receipt_view">
                    <input type="radio" name="receiptFl" id="receipt_non" value="n" class="sp" onclick="receipt_display();">
                    <label for="receipt_non">
                        <span class="cash_receipt_non">{=__('신청안함')}</span>
                        <span class="cash_receipt_pg">{=__('현금영수증')} (※ {=__('결제창에서 신청')})</span>
                    </label>
                </span>
                </li>
                <!--{ ? receipt['cashFl'] == 'y' }-->
                <li>
                <span class="inp_rdo" id="cash_receipt_view">
                    <input type="radio" name="receiptFl" id="receipt_cash" value="r" class="sp" onclick="receipt_display();">
                    <label for="receipt_cash">{=__('현금영수증')}</label>
                </span>
                </li>
                <!--{ / // end receipt_cashFl }-->
                <!--{ ? receipt['taxFl'] == 'y' }-->
                <li>
                <span class="inp_rdo">
                    <input type="radio" name="receiptFl" id="receipt_tax" value="t" class="sp" onclick="receipt_display();">
                    <label for="receipt_tax">{=__('세금계산서')}</label>
                </span>
                </li>
                <!--{ / // end receipt_taxFl }-->
            </ul>
            <!--{ / // end receipt }-->

            <!-- 현금영수증 컨텐츠 -->
            <!--{ ? receipt['cashFl'] == 'y' }-->
            <div id="cash_receipt_info" class="js-receipt dn">
                <h2 class="js-gd5-receipt-select js-gd5-cash-receipt-info my_tit">{=__('현금영수증')}</h2>
                <ul class="js-gd5-receipt-select js-gd5-cash-receipt-info pay_mth">
                    <li class="use">
                        <input type="hidden" name="cashCertFl" value="c"/>
                        <span class="inp_rdo">
                        <input type="radio" name="cashUseFl" id="cashCert_d" value="d" class="sp" checked="checked" onclick="cash_receipt_toggle();">
                        <label for="cashCert_d">{=__('소득공제용')}</label>
                    </span>
                    </li>
                    <li>
                    <span class="inp_rdo">
                        <input type="radio" name="cashUseFl" id="cashCert_e" value="e" class="sp" onclick="cash_receipt_toggle();">
                        <label for="cashCert_e">{=__('지출증빙용')}</label>
                    </span>
                    </li>
                </ul>
                <fieldset class="js-gd5-receipt-select js-gd5-cash-receipt-info">
                    <legend>{=__('현금영수증 영역')}</legend>
                    <div class="join_bx2">
                        <div class="tbl">
                            <table>
                                <caption>
                                    <span>{=__('정보입력')}</span>
                                </caption>
                                <colgroup>
                                    <col>
                                    <col>
                                </colgroup>
                                <tbody>
                                <tr id="certNo_hp">
                                    <th scope="row">
                                        <label class="tit">{=__('휴대폰번호')}</label>
                                    </th>
                                    <td>
                                        <div class="inp_tx">
                                            <input type="text" name="cashCertNo[c]" class="number-only" placeholder="{=__('- 없이 입력하세요')}" maxlength="11" value="{=str_replace('-', '', gd_isset(memberInvoiceInfo['cash']['cellPhone']))}"/>
                                        </div>
                                    </td>
                                </tr>
                                <tr id="certNo_bno">
                                    <th scope="row">
                                        <label class="tit">{=__('사업자번호')}</label>
                                    </th>
                                    <td>
                                        <div class="inp_tx">
                                            <input type="text" name="cashCertNo[b]" class="number-only" placeholder="{=__('- 없이 입력하세요')}" maxlength="10" value="{=str_replace('-', '', gd_isset(memberInvoiceInfo['cash']['cashBusiNo']))}"/>
                                        </div>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </fieldset>
            </div>
            <!--{ / // end receipt_cashFl }-->
            <!-- //현금영수증 컨텐츠 -->

            <!-- 세금계산서 컨텐츠 -->
            <!--{ ? receipt['taxFl'] == 'y' }-->
            <div id="tax_info" class="js-receipt dn">
                <h2 class="js-gd5-receipt-select js-gd5-tax-info my_tit">
                    {=__('세금계산서')}
                    <!--{ ? memberInvoiceInfo['tax']['memberTaxInfoFl'] == 'y' }-->
                    <button class="btn btn_gr single-btn tax-info-init dn"><em>{=__('초기화')}</em></button>
                    <!--{ / }-->
                </h2>
                <fieldset class="js-gd5-receipt-select  js-gd5-tax-info">
                    <legend>{=__('세금계산서 정보 영역')}</legend>
                    <div class="join_bx2">
                        <div class="tbl">
                            <table>
                                <caption>
                                    <span>{=__('정보입력')}</span>
                                </caption>
                                <colgroup>
                                    <col>
                                    <col>
                                </colgroup>
                                <tbody>
                                <tr>
                                    <th scope="row">
                                        <label for="taxBusiNo" class="tit">{=__('사업자번호')}</label>
                                    </th>
                                    <td>
                                        <div class="inp_tx">
                                            <input type="text" name="taxBusiNo" id="taxBusiNo" placeholder="({=__('-생략')})" value="{=str_replace('-', '', gd_isset(memberInvoiceInfo['tax']['taxBusiNo']))}" maxlength="10"/>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <th scope="row">
                                        <label for="taxCompany" class="tit">{=__('회사명')}</label>
                                    </th>
                                    <td>
                                        <div class="inp_tx">
                                            <input type="text" name="taxCompany" id="taxCompany" value="{=gd_isset(memberInvoiceInfo['tax']['company'])}" maxlength="50" data-pattern="gdMemberNmGlobal"/>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <th scope="row">
                                        <label for="taxCeoNm" class="tit">{=__('대표자명')}</label>
                                    </th>
                                    <td>
                                        <div class="inp_tx">
                                            <input type="text" name="taxCeoNm" id="taxCeoNm" value="{=gd_isset(memberInvoiceInfo['tax']['ceo'])}"/>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <th scope="row">
                                        <label for="taxService" class="tit">{=__('업태')}</label>
                                    </th>
                                    <td>
                                        <div class="inp_tx">
                                            <input type="text" name="taxService" id="taxService" value="{=gd_isset(memberInvoiceInfo['tax']['service'])}"/>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <th scope="row">
                                        <label for="taxItem" class="tit">{=__('종목')}</label>
                                    </th>
                                    <td>
                                        <div class="inp_tx">
                                            <input type="text" name="taxItem" id="taxItem" value="{=gd_isset(memberInvoiceInfo['tax']['item'])}"/>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <th scope="row">
                                        <label for="taxAddress" class="tit">{=__('사업장주소')}</label>
                                    </th>
                                    <td>
                                        <div class="mr v2">
                                            <div class="cell_bx">
                                                <div class="cell">
                                                    <div class="inp_tx">
                                                        <input type="text" name="taxZonecode" id="taxZonecode" readonly="readonly" value="{=gd_isset(memberInvoiceInfo['tax']['comZonecode'])}">
                                                        <input type="hidden" name="taxZipcode" id="taxZipcode" value="{=gd_isset(memberInvoiceInfo['tax']['comZipcode'])}">
                                                    </div>
                                                    <button type="button" class="btn btn_gr" onclick="postcode_search('taxZonecode', 'taxAddress', 'taxZipcode');">{=__('우편번호')}</button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="inp_tx">
                                            <input type="text" name="taxAddress" id="taxAddress" value="{=gd_isset(memberInvoiceInfo['tax']['comAddress'])}"/>
                                        </div>
                                        <div class="inp_tx">
                                            <input type="text" name="taxAddressSub" value="{=gd_isset(memberInvoiceInfo['tax']['comAddressSub'])}"/>
                                        </div>
                                    </td>
                                </tr>
                                <!--{ ? taxInfo.eTaxInvoiceFl == 'y' }-->
                                <tr>
                                    <th scope="row">
                                        <label for="mail" class="tit">{=__('발행 이메일')}</label>
                                    </th>
                                    <td >
                                        <div class="cell_bx sel_area v2">
                                            <div class="cell">
                                                <div class="inp_tx">
                                                    <input type="text" name="taxEmail" id="taxEmail" value="{=gd_isset(memberInvoiceInfo['tax']['email'])}" placeholder="{=__('미입력 시 주문자의 이메일로 발행')}"/>
                                                </div>
                                            </div>
                                            <div class="cell">
                                                <div class="inp_sel">
                                                    <select id="taxEmailDomain" name="email2" title="{=__('이메일 주소')}">
                                                        <!--{ @ emailDomain }-->
                                                        <option value="{=.key_}">{=.value_}</option>
                                                        <!--{ / }-->
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                <!--{ / }-->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </fieldset>
            </div>
            <!--{ / // end receipt_taxFl }-->
            <!-- //세금계산서 컨텐츠 -->
        </div>

        <!--{ ? orderPolicy.reagreeConfirmFl == 'y' }-->
        <h2 class="my_tit">{=__('청약의사 재확인')}</h2>
        <fieldset>
            <div class="inp_chk" style="position:static;margin:5px 15px;">
                <input type="checkbox" name="termAgree_orderCheck" id="termAgree_orderCheck" class="sp require">
                <label for="termAgree_orderCheck">
                    <strong>({=__('필수')})</strong>
                    {=__('구매하실 상품의 결제정보를 확인하였으며, 구매진행에 동의합니다.')}
                </label>
            </div>
        </fieldset>
        <!--{ / }-->

        <div class="btn_pay_wrap">
            <ul class="btn_bx">
                <li>
                    <!--{ ? settleOrderPossible }-->
                    <button type="submit" id="payment-btn" class="btn btn_r js_btn_pay">{=__('결제하기')}</button>
                    <!--{ : }-->
                    <p class="caution-msg1">{=__('주문하시는 상품의 결제 수단이 상이 하여 결제가 불가능합니다.')}</p>
                    <div class="btn">
                        <span class="btn btn-positive btn-w btn_payment">{=__('결제불가')}</span>
                    </div>
                    <!--{ / }-->
                </li>
            </ul>
        </div>
    </div>
</form>

<!-- 주문하기 끝 -->

<!--{ ? couponUse == 'y' }-->
<!-- 주문 쿠폰 적용하기 레이어 -->
<div id="couponOrderApplyLayer" class="btm-fix-layer apply-coupon" data-key="apply-coupon"></div>
<!--//주문 쿠폰 적용하기 레이어 -->
<!--{ / }-->
<!-- PG 결제 적용하기 레이어 -->
<div id="pgSettlementApplyLayer" class="btm-fix-layer pg-layer" data-key="pg-layer"></div>
<!--//PG 결제 적용하기 레이어 -->
<!-- 나의 배송지 관리 레이어 -->
<script id="myShippingList" type="text/html">
    <li class="delivery-item">
        <div class="del-head inp_rdo">

            <input type="radio" id="input<%=idx%>" name="shipping" class="sp">
            <label for="input<%=idx%>"></label>

        </div>
        <div class="del-body">
            <label for="input1">
                <div class="del-name">
                    <span class="shipping-name"><strong><%=shippingName%></strong></span>
                    <% if (defaultFl == 'y') { %>
                    <span class="c-orange">({=__('기본배송지')})</span>
                    <% } %>
                </div>
                <div class="del-address">
                    <span class="shipping-zonecode"><%=shippingZonecode%></span>
                    <% if (shippingZipcode != '') { %>
                    (
                    <span class="shipping-zipcode"><%=shippingZipcode%></span>
                    )
                    <% } %>
                    <!--{ ? gGlobal.isFront }-->
                    <span class="shipping-addresssub"><%=shippingAddressSub%></span>,
                    <span class="shipping-address"><%=shippingAddress%></span>,
                    <span class="shipping-state"><%=shippingState%></span>,
                    <span class="shipping-city"><%=shippingCity%></span>,
                    <span class="shipping-country"><%=shippingCountry%></span>
                    <span class="shipping-country-code dn"><%=shippingCountryCode%></span>
                    <!--{ : }-->
                    <span class="shipping-address"><%=shippingAddress%></span>
                    <span class="shipping-addresssub"><%=shippingAddressSub%></span>
                    <!--{ / }-->
                </div>
                <div class="del-callnum">
                    <!--{ ? gGlobal.isFront }-->
                    (+<span class="shipping-cellphone-prefix"><%=shippingCellPhonePrefix%></span>)
                    <span class="shipping-cellphone-prefixcode dn"><%=shippingCellPhonePrefixCode%></span>
                    <!--{ / }-->
                    <span class="shipping-cellphone"><%=shippingCellPhone%></span>

                    <span class="dn">
                        <!--{ ? gGlobal.isFront }-->
                        (+<span class="shipping-phone-prefix"><%=shippingPhonePrefix%></span>)
                        <span class="shipping-phone-prefixcode dn"><%=shippingPhonePrefixCode%></span>
                        <!--{ / }-->
                        <span class="shipping-phone"><%=shippingPhone%></span>
                    </span>
                </div>
            </label>
        </div>
    </li>
</script>

<!--{ ? isUseMultiShipping === true }-->
<script type="text/html" class="template" id="multiShippingRow">
    <div class="shipping-info-table" style="margin-top:20px;">
        <h2 class="my_tit">
            {=__('추가 배송지')}<b class="no"><%=no%></b>
            <span style="position:relative; margin:0; float:right;">
                <button class="btn btn_gr shipping-remove-btn" style="height:28px; line-height:26px; padding:0 5px; margin-top:4px;">- {=__('삭제')}</button>
            </span>
        </h2>
        <div class="section">
            <div class="section-body">
                <div class="tab-section ty2">
                    <div class="order-send">
                    <!--{ ? gd_is_login() === true }-->
                    <div class="tab-btns">
                        <div class="tab-btn"><a href="#tab2">{=__('배송지 목록')}</a></div>
                        <div class="tab-btn active"><a href="#tab3">{=__('직접 입력')}</a></div>
                    </div>
                    <!--{ / }-->
                    <div>
                        <div>
                            <div class="join_bx2">
                                <div class="delivery-list-add"></div>
                                <div class="delivery-list"></div>
                                <input type="hidden" name="shippingCellPhonePrefixAdd[<%=no%>]" value="" />
                                <input type="hidden" name="shippingPhonePrefixAdd[<%=no%>]" value="" />
                                <input type="hidden" name="shippingSnoAdd[<%=no%>]" value="" />
                                <input type="hidden" name="deliveryVisitAdd[<%=no%>]" class="shipping-delivery-visit" value="n" />
                                <div class="multi-order-table-area">
                                    <div class="tbl order-table">
                                        <table class="tbl-order">
                                            <colgroup>
                                                <col>
                                                <col>
                                            </colgroup>
                                            <tbody>
                                            <tr>
                                                <th class="required"><label class="tit">{=__('이름')}</label></th>
                                                <td>
                                                    <input type="text" name="shippingNameAdd[<%=no%>]" value="" maxlength="20" class="input-text wp100">
                                                </td>
                                            </tr>
                                            <!--{ ? gGlobal.isFront }-->
                                            <tr>
                                                <th class="required"><label class="tit">{=__('국가')}</label></th>
                                                <td>
                                                    <div class="inp_sel">
                                                        {=gd_select_box('shippingCountryCodeAdd[<%=no%>]', 'shippingCountryCodeAdd[<%=no%>]', countryAddress, null, recommendCountryCode, __('=선택해주세요='), null)}
                                                    </div>
                                                </td>
                                            </tr>
                                            <tr>
                                                <th class="required"><label class="tit">{=__('도시')}</label></th>
                                                <td>
                                                    <input type="text" name="shippingCityAdd[<%=no%>]" value="" maxlength="20" class="input-text wp100" />
                                                </td>
                                            </tr>
                                            <tr>
                                                <th class="required"><label class="tit">{=__('주/지방/지역')}</label></th>
                                                <td>
                                                    <input type="text" name="shippingStateAdd[<%=no%>]" value="" maxlength="20" class="input-text wp100" />
                                                </td>
                                            </tr>
                                            <tr>
                                                <th class="required"><label class="tit">{=__('주소1')}</label></th>
                                                <td>
                                                    <input type="text" name="shippingAddressAdd[<%=no%>]" value="" class="input-text wp100" />
                                                </td>
                                            </tr>
                                            <tr>
                                                <th class="required"><label class="tit">{=__('주소2')}</label></th>
                                                <td>
                                                    <input type="text" name="shippingAddressSubAdd[<%=no%>]" value="" class="input-text wp100" />
                                                </td>
                                            </tr>
                                            <tr>
                                                <th class="required"><label class="tit">{=__('우편번호')}</label></th>
                                                <td>
                                                    <input type="text" name="shippingZonecodeAdd[<%=no%>]" value="" <!--{ ? !gGlobal.isFront }-->style="width:40px;"<!--{ / }--> class="input-text wp100" />
                                                    <input type="hidden" name="shippingZipcodeAdd[<%=no%>]" value=""/>
                                                </td>
                                            </tr>
                                            <!--{ : }-->
                                            <tr>
                                                <th class="required"><label class="tit">{=__('주소')}</label></th>
                                                <td class="input_content input_address">
                                                    <div class="zipcode-block">
                                                        <div class="zipcode-flex">
                                                            <label class="zipcode">
                                                                <input type="text" class="input-text wp100" name="shippingZonecodeAdd[<%=no%>]" value=""  readonly="readonly" >
                                                            </label>
                                                            <input type="hidden" name="shippingZipcodeAdd[<%=no%>]" value=""/>
                                                        </div>
                                                        <div class="zipcode-fix">
                                                            <button class="btn btn_gr postcode-search post-search" data-no="<%=no%>" type="button" id="btnPostcode">
                                                                <em class="h35 arrow">{=__('우편번호')}</em>
                                                            </button>
                                                        </div>
                                                    </div>
                                                    <div class="zipcode-block">
                                                        <input type="text" name="shippingAddressAdd[<%=no%>]" value="" readonly="readonly" class="input-text wp100" >
                                                    </div>
                                                    <div class="zipcode-block">
                                                        <input type="text" name="shippingAddressSubAdd[<%=no%>]" value="" class="input-text wp100">
                                                    </div>
                                                </td>
                                            </tr>
                                            <!--{ / }-->
                                            <tr>
                                                <th><label class="tit">{=__('전화번호')}</label></th>
                                                <td>
                                                    <!--{ ? gGlobal.isFront }-->
                                                    <div class="cell">
                                                        <div class="inp_sel">
                                                            {=gd_select_box('shippingPhonePrefixCodeAdd[<%=no%>]', 'shippingPhonePrefixCodeAdd[<%=no%>]', countryPhone, null, null, __('국가코드'), null, 'tune select-small')}
                                                        </div>
                                                    </div>
                                                    <!--{ / }-->
                                                    <input type="text" id="shippingPhoneAdd[<%=no%>]" name="shippingPhoneAdd[<%=no%>]" value="" class="input-text wp100">
                                                </td>
                                            </tr>
                                            <tr>
                                                <th class="required"><label class="tit">{=__('휴대폰번호')}</label></th>
                                                <td>
                                                    <!--{ ? gGlobal.isFront }-->
                                                    <div class="cell">
                                                        <div class="inp_sel">
                                                            {=gd_select_box('shippingCellPhonePrefixCodeAdd[<%=no%>]', 'shippingCellPhonePrefixCodeAdd[<%=no%>]', countryPhone, null, null, __('국가코드'), null, 'tune select-small')}
                                                        </div>
                                                    </div>
                                                    <!--{ / }-->
                                                    <div class="cell">
                                                        <input type="text" id="shippingCellPhoneAdd[<%=no%>]" name="shippingCellPhoneAdd[<%=no%>]" value="{basiceShippingAddress.shippingCellPhone}" class="input-text wp100">
                                                    </div>
                                                </td>
                                            </tr>
                                            <!--{ ? gGlobal.isFront == false && useSafeNumberFl == 'y'}-->
                                            <tr>
                                                <th><label class="tit">{=__('안심번호')}</label></th>
                                                <td>
                                                    <div class="cell inp_chk" style="position:static;">
                                                        <input type="checkbox" name="shippingUseSafeNumberFlAdd[<%=no%>]" id="shippingUseSafeNumberFlAdd[<%=no%>]" class="sp" value="w" checked="checked">
                                                        <label for="shippingUseSafeNumberFlAdd[<%=no%>]">{=__('안심번호 사용')}</label>
                                                    </div>
                                                </td>
                                            </tr>
                                            <!--{ / }-->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                <!--{ ? gd_is_login() === true }-->
                                <p class="shipping-save inp_chk" style="position:static;">
                                    <input type="checkbox" value="y" id="reflectApplyDeliveryAdd[<%=no%>]" name="reflectApplyDeliveryAdd[<%=no%>]"  class="sp require">
                                    <label for="reflectApplyDeliveryAdd[<%=no%>]">
                                        {=__('배송지 목록에 추가합니다.')}
                                    </label>
                                </p>
                                <!--{ / }-->
                            </div>
                        </div>
                    </div>
                    <div class="join_bx2">
                        <div class="tbl order-table">
                            <table>
                                <tr>
                                    <th><label class="tit">{=__('남기실 말씀')}</label></th>
                                    <td>
                                        <input type="text" name="orderMemoAdd[<%=no%>]" class="input-text wp100">
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    </div>

                    <div class="order-visit dn">
                        <h2 class="my_tit">
                            {=__('추가 방문수령 정보')}<b class="no"><%=no%></b>
                            <span style="position:relative; margin:0; float:right;">
                                <button class="btn btn_gr shipping-visit-remove-btn" style="height:28px; line-height:26px; padding:0 5px; margin-top:4px;">- {=__('삭제')}</button>
                            </span>
                        </h2>
                        <div class="tbl">
                            <table class="order-table">
                                <tr>
                                    <th><label class="tit">{=__('방문 수령지 주소')}</label></th>
                                    <td>
                                        <span class="delivery-method-visit-area-txt"></span>
                                        <input type="hidden" name="visitAddressAdd[<%=no%>]" value="">
                                    </td>
                                </tr>
                                <tr>
                                    <th class="required"><label class="tit">{=__('방문자명')}</label></th>
                                    <td>
                                        <input type="text" name="visitNameAdd[<%=no%>]" value="" class="input-text wp100" />
                                    </td>
                                </tr>
                                <tr>
                                    <th class="required"><label class="tit">{=__('방문자연락처')}</label></th>
                                    <td>
                                        <input type="text" name="visitPhoneAdd[<%=no%>]" value="" class="input-text wp100" />
                                    </td>
                                </tr>
                                <tr>
                                    <th><label class="tit">{=__('메모')}</label></th>
                                    <td>
                                        <input type="text" name="visitMemoAdd[<%=no%>]" value="" maxlength="250" class="input-text wp100" />
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div class="join_bx2 select-goods-area" data-shipping-no="<%=no%>">
                        <div class="tbl order-table">
                            <table>
                                <tr>
                                    <th class="required"><label class="tit">{=__('배송상품')}</label></th>
                                    <td>
                                        <input type="hidden" name="selectGoods[<%=no%>]" value="">
                                        <input type="hidden" name="multiDelivery[<%=no%>]" value="0">
                                        <a class="btn btn_w btn-open-layer shipping-goods-select">{=__('상품선택')}</a>
                                    </td>
                                </tr>
                            </table>
                            <div class="my_goods v3 v4 select-goods order-goods" style="background:#fff;">
                                <table class="info check btn_list" style="display:table; margin-left:0;"></table>
                            </div>
                        </div>
                    </div>
                    <a class="btn shipping-add-btn btn_g1">+ {=__('배송지 추가')}</a>
                </div>
            </div>
        </div>
    </div>
</script>
<!--{ / }-->

<!-- 레이어 호출시 딤처리 -->
<div id="layerDim" class="dn">&nbsp;</div>
<!-- //레이어 호출시 딤처리 -->


<!-- //나의 배송지 관리 레이어 -->
<script type="text/javascript" src="../js/jquery/jquery.serialize.object.js"></script>
<script type="text/javascript" src="../js/jquery/validation/additional/businessnoKR.js"></script>
{=fbInitiateCheckoutScript}


<script type="text/javascript">
    <!--
    var deliveryList = '';
    // 마일리지 사용 정보
    var mileageUse = {
        'usableFl' : '{=mileageUse.usableFl}',
        'minimumHold' : parseInt('{=mileageUse.minimumHold}'),
        'minimumLimit' : parseInt('{=mileageUse.minimumLimit}'),
        'orderAbleLimit' : parseInt('{=mileageUse.orderAbleLimit}'),
        'orderAbleStandardPrice' : parseInt('{=mileageUse.orderAbleStandardPrice}'), // '최소 상품구매금액 제한' 을 비교하기 위한 계산된 구매금액
        'useDeliveryFl' : '{=mileageUse.useDeliveryFl}',
        'maximumLimit' : '{=mileageUse.maximumLimit}',
        'oriMaximumLimit' : parseInt('{=mileageUse.oriMaximumLimit}'), // 변형되지 않은 설정 그대로의 값 - %는 원으로 계산되어 나옴
    };

    $(document).ready(function(){
        <!--{ ? !shippingDefaultFl && gd_is_login() === true }-->
        $('.tab-btn > a[href="#tab3"]').trigger('click');
        $('input[name=tmpDeliverTab]').val('direct');
        <!--{ / }-->
        // 결제창 닫기
        $(document).on('click', '#pgSettlementApplyLayer .close-btn', function(e){
            close_layer($('#pgSettlementApplyLayer'));
        });

        $('input.number-only').on('keyup', function () {
            var value = $(this).val().replace(/[^0-9]/g, '');
            $(this).val(value);
        });

        // 배송지 목록탭 클릭시 바인딩
        $('.tab-btn > a[href*="#tab"]').bind('click', function(e){
            var shippingNo = 0;
            <!--{ ? isUseMultiShipping === true }-->
            if ($('input[name="multiShippingFl"]').prop('checked') === true) {
                var href = $(this).attr('href');
                shippingNo = $('.tab-btn > a[href="' + href + '"]').index(this);

                if (shippingNo > 0) {
                    return;
                }
            }
            <!--{ / }-->
            switch ($(this).attr('href')) {
                // 기본배송지
                case '#tab1':
                    $('input[name=tmpDeliverTab]').val('receiver');
                    $('select[name="receiverCountryCode"]').trigger('change');
                    get_delivery_area_charge($('input[name=receiverAddress]').val(), $('input[name=receiverAddressSub]').val());
                    break;

                // 배송지목록
                case '#tab2':
                    $('input[name=tmpDeliverTab]').val('shipping');
                    $('.order-table-area').hide();
                    var self = $($(this).attr('href'));
                    var params = {
                        mode: 'shipping_list'
                    };
                    self.addClass('loading');
                    $.post('../order/order_ps.php', params, function(data){
                        deliveryList = data;
                        $('.delivery-list-add').eq(shippingNo).empty().append('<span class="btn-shipping"><a href="../mypage/layer_shipping_address_regist.php?type=order_regist' + shippingNo + '" data-toggle="modal" data-target="#popup-shipping" data-type="post" data-cache="false">{=__('배송지 추가')}</a></span>');
                        $('.delivery-list').eq(shippingNo).empty();
                        self.removeClass('loading');
                        if (data.length > 0) {
                            $.each(data, function(idx){
                                var json = $(this)[0];
                                $('.delivery-list-add').eq(shippingNo).append('<span class="btn-shipping btn-shipping-receiver"><a data-sno="' + json.sno + '">' + json.shippingTitle + '</a></span>');
                                if (idx === 0) {
                                    insertShippingData(json);
                                }
                            });
                        } else {
                            $('.delivery-list').eq(shippingNo).empty().append('<div class="no-shipping"><b>{=__('등록된 기본배송지가 없습니다.')}</b><br />({=__('기본배송지는 "배송지 목록"에서 추가할 수 있습니다.')})</div>');
                        }
                    });
                    break;

                // 직접입력
                case '#tab3':
                    $('input[name=tmpDeliverTab]').val('direct');
                    $('input[name="directAddressSub"]').blur();
                    break;
            }
        });

        $(document).on('click', '.btn-shipping-receiver', function(){
            var shippingNo = 0;
            var idx = $('.delivery-list-add:eq(' + shippingNo + ') .btn-shipping-receiver').index(this);
            <!--{ ? isUseMultiShipping === true }-->
            if ($('input[name="multiShippingFl"]').prop('checked') === true && $(this).data('shipping-no') > 0) {
                shippingNo = $(this).data('shipping-no');
                idx = $('.delivery-list-add:eq(' + shippingNo + ') .btn-shipping-receiver').index(this);
            }
            <!--{ / }-->

            if (deliveryList[idx]) {
                insertShippingData(deliveryList[idx], shippingNo);
            }
        });

        // 배송지목록 radio 선택시
        $(document).on('click', 'input[name=shipping]:radio', function(e){
            var obj = $(this).closest('.delivery-item').find('.del-body');
            $('input[name=shippingName]').val(obj.find('.shipping-name').text());
            $('input[name=shippingZipcode]').val(obj.find('.shipping-zipcode').text());
            $('input[name=shippingZonecode]').val(obj.find('.shipping-zonecode').text());
            $('input[name=shippingCountry]').val(obj.find('.shipping-country').text());
            $('input[name=shippingCountryCode]').val(obj.find('.shipping-country-code').text());
            $('input[name=shippingState]').val(obj.find('.shipping-state').text());
            $('input[name=shippingCity]').val(obj.find('.shipping-city').text());
            $('input[name=shippingAddress]').val(obj.find('.shipping-address').text());
            $('input[name=shippingAddressSub]').val(obj.find('.shipping-addresssub').text());
            $('input[name=shippingPhonePrefix]').val(obj.find('.shipping-phone-prefix').text());
            $('input[name=shippingPhonePrefixCode]').val(obj.find('.shipping-phone-prefixcode').text());
            $('input[name=shippingPhone]').val(obj.find('.shipping-phone').text());
            $('input[name=shippingCellPhonePrefix]').val(obj.find('.shipping-cellphone-prefix').text());
            $('input[name=shippingCellPhonePrefixCode]').val(obj.find('.shipping-cellphone-prefixcode').text());
            $('input[name=shippingCellPhone]').val(obj.find('.shipping-cellphone').text());
        });

        <!--{ ? couponUse == 'y' }-->
        // 쿠폰 적용/변경 레이어
        $('.btn-open-layer').bind('click', function(e) {
            e.preventDefault();
            if ($(this).attr('href') == '#couponOrderApplyLayer') {
                // 마일리지 쿠폰 중복사용 체크
                const checkMileageCoupon = choose_mileage_coupon('coupon');
                if (!checkMileageCoupon) {
                    return false;
                }

                const cartIdx = [];
                $('input[name="cartSno[]"]').each(function() {
                    cartIdx.push($(this).val());
                });

                const params = {
                    mode: 'coupon_apply_order',
                    cartSno: cartIdx,
                    couponApplyOrderNo: $('input:hidden[name="couponApplyOrderNo"]').val(),
                    totalCouponOrderDcPrice: $('input:hidden[name="totalCouponOrderDcPrice"]').val(),
                    totalCouponOrderPrice: $('input:hidden[name="totalCouponOrderPrice"]').val(),
                    totalCouponOrderMileage: $('input:hidden[name="totalCouponOrderMileage"]').val(),
                    totalCouponDeliveryDcPrice: $('input:hidden[name="totalCouponDeliveryDcPrice"]').val(),
                    totalCouponDeliveryPrice: $('input:hidden[name="totalCouponDeliveryPrice"]').val(),
                };

                $.ajax({
                    url: '/order/layer_coupon_apply_order.php',
                    type: 'POST',
                    data: params,
                    cache: false,
                    timeout: 30000
                }).done(function(response) {
                    if (response.error === 0) {
                        alert(response.message);
                    } else {
                        $('#popup-coupon-apply').empty().append(response).show();
                    }
                });
            }
        });

        // 쿠폰 취소
        $('.btn-coupon-cancel').bind('click', function(e){
            var cartSno = $(this).data('cartsno');
            $('[name="cart[cartSno]"]').val(cartSno);
            $('#frmCart input[name=\'mode\']').val('couponDelete');
            $('#frmCart').attr('method', 'post');
            $('#frmCart').attr('target', 'ifrmProcess');
            $('#frmCart').attr('action', '../order/cart_ps.php');
            $('#frmCart').submit();

            return false;
        });
        <!--{ / }-->

        // 세금계산서 관련 체크용
        var checkTax = function() {
            if ($('#settleKind_gb').is(':checked') && $('#receipt_tax').is(':checked')) {
                return true;
            }
            return false;
        }

        // 무통장입금 체크
        var checkBank = function() {
            if ($('#settleKind_gb').is(':checked') && parseInt($('input[name=settlePrice]').val()) > 0) {
                return true;
            }
            return false;
        }

        <!--{ ? receipt['taxFl'] == 'y'  && taxInfo.eTaxInvoiceFl == 'y' }-->
        $.validator.addMethod(
            'taxEmailChk', function (value, element) {
                if($('input[name=receiptFl]:checked').val() =='t' && $('input[name=taxEmail]').val() !=  '' && !$.validator.methods.email.call(this, $.trim(value), element)){
                    $.validator.messages.taxEmailChk =  __('[세금계산서] 발행 이메일을 정확하게 입력하여 주세요.');
                    return false;
                }
                return true;
            },'');
        <!--{ / }-->
        /*
         * 비회원 주문 전체 동의 체크박스 이벤트
         */
        <!--{ ? gd_is_login() === false }-->
        // 14세 동의 항목 체크박스 이벤트
        if ($("#termAgreeDiv").length > 0) {
            $('#termAgreeDiv :checkbox', $('#frmOrder')).change(function (e) {
                var $termsTarget = $(e.target), $termsLabel = $termsTarget.siblings('label');
                var isTermsTargetChecked = $termsTarget.prop('checked') === true;
                if (isTermsTargetChecked) {
                    $termsTarget.val('y');
                    $termsLabel.addClass('on');
                } else {
                    $termsTarget.val('n');
                    $termsLabel.removeClass('on');
                }
            });
        }
        <!--{ ? hasScmGoods === false }-->
        $('#allAgree', $('#frmOrder')).change(function (e) {
            e.preventDefault();
            var $target = $(e.target), $checkboxAgreement = $('#termAgree_agreement'),  $checkboxGuest = $('#nomember_privacy_agree'), $labelAgree = $checkboxAgreement.siblings('label'), $labelGuest = $checkboxGuest.siblings('label'), $checkboxMarketing = $('#termAgree_privateMarketing'), $labelMarketing = $checkboxMarketing.siblings('label');
            if ($target.prop('checked') === true) {
                $checkboxAgreement.prop('checked', true).val('y');
                $labelAgree.addClass('on');
                $checkboxGuest.prop('checked', true).val('y');
                $labelGuest.addClass('on');
                <!--{ ? privateMarketingFl }-->
                $checkboxMarketing.prop('checked', true).val('y');
                $labelMarketing.addClass('on');
                <!--{ / }-->
            } else {
                $checkboxAgreement.prop('checked', false).val('n');
                $labelAgree.removeClass('on');
                $checkboxGuest.prop('checked', false).val('n');
                $labelGuest.removeClass('on');
                <!--{ ? privateMarketingFl }-->
                $checkboxMarketing.prop('checked', false).val('n');
                $labelMarketing.removeClass('on');
                <!--{ / }-->
            }
        });
        <!--{ : }-->
        $('#allAgreeScm', $('#frmOrder')).change(function (e) {
            e.preventDefault();
            var $target = $(e.target), $checkboxAgreement = $('#termAgree_agreement'),  $checkboxGuest = $('#nomember_privacy_agree'), $labelAgree = $checkboxAgreement.siblings('label'), $labelGuest = $checkboxGuest.siblings('label'), $checkboxScm = $('#termAgreePrivateProvider'), $labelScm = $checkboxScm.siblings('label'), $checkboxMarketing = $('#termAgree_privateMarketing'), $labelMarketing = $checkboxMarketing.siblings('label');
            if ($target.prop('checked') === true) {
                $checkboxAgreement.prop('checked', true).val('y');
                $labelAgree.addClass('on');
                $checkboxGuest.prop('checked', true).val('y');
                $labelGuest.addClass('on');
                $checkboxScm.prop('checked', true).val('y');
                $labelScm.addClass('on');
                <!--{ ? privateMarketingFl }-->
                $checkboxMarketing.prop('checked', true).val('y');
                $labelMarketing.addClass('on');
                <!--{ / }-->
            } else {
                $checkboxAgreement.prop('checked', false).val('n');
                $labelAgree.removeClass('on');
                $checkboxGuest.prop('checked', false).val('n');
                $labelGuest.removeClass('on');
                $checkboxScm.prop('checked', false).val('n');
                $labelScm.removeClass('on');
                <!--{ ? privateMarketingFl }-->
                $checkboxMarketing.prop('checked', false).val('n');
                $labelMarketing.removeClass('on');
                <!--{ / }-->
            }
        });
        <!--{ / }-->
        <!--{ / }-->
        // 폼 체크
        $('#frmOrder').validate({
            onkeyup: onkeyup,
            submitHandler: function (form) {
                <!--{ ? giftConf.giftFl == 'y' }-->
                var selectCnt = $('input[name="giftSelectCnt"]').val();
                if (selectCnt > 0) {
                    var checkCnt = $('input[name="giftCheckCnt"]').val();
                    if (checkCnt < selectCnt) {
                        pass = false;
                        alert(__('사은품은 최소 %s개 이상 선택하셔야 합니다.', selectCnt));
                        document.getElementById('add-gift').scrollIntoView();
                        $('input[type=checkbox][name*="gift"]').eq(0).focus();
                        return false;
                    }
                }
                <!--{ / }-->

                <!--{ ? memberGuestAuthFl != 'y' }-->
                if ($(".cert_btn").length > 0 && $(".cert_btn").css('display') != "none") {
                    pass = false;
                    alert(__('본인인증을 진행해주세요.'));
                    $(".cert_btn").attr("tabindex", -1).focus();
                    return false;
                }
                <!--{ / }-->

                <!--{ ? isUseMultiShipping === true }-->
                if ($('input[name="multiShippingFl"]').prop('checked') === true) {
                    var msg = '';
                    var cartGoodsCnt = 0;
                    var cartAddGoodsCnt = 0;

                    $('input[name^="selectGoods"]').each(function(index){
                        if (index > 0) {
                            var shippingDeliveryVisit = $('input[name="deliveryVisitAdd[' + index + ']"]').val();

                            if (shippingDeliveryVisit != 'y') {
                                if (!$('input[name="shippingNameAdd[' + index + ']"]').val()) {
                                    $('input[name="shippingNameAdd[' + index + ']"]').focus();
                                    msg = __('받으실 분 정보를 입력해 주세요.');
                                    return false;
                                }
                                if (!$('input[name="shippingZonecodeAdd[' + index + ']"]').val()) {
                                    $('input[name="shippingZonecodeAdd[' + index + ']"]').focus();
                                    msg = __('받으실 곳 우편번호 정보를 입력해 주세요.');
                                    return false;
                                }
                                if (!$('input[name="shippingAddressAdd[' + index + ']"]').val()) {
                                    $('input[name="shippingAddressAdd[' + index + ']"]').focus();
                                    msg = __('받으실 곳 주소 정보를 입력해 주세요.');
                                    return false;
                                }
                                if (!$('input[name="shippingAddressSubAdd[' + index + ']"]').val()) {
                                    $('input[name="shippingAddressSubAdd[' + index + ']"]').focus();
                                    msg = __('받으실 곳 주소 정보를 입력해 주세요.');
                                    return false;
                                }
                                if (!$('input[name="shippingCellPhoneAdd[' + index + ']"]').val()) {
                                    $('input[name="shippingCellPhoneAdd[' + index + ']"]').focus();
                                    msg = __('받으실 분 휴대폰 번호 정보를 입력해 주세요.');
                                    return false;
                                }
                            }
                            if (shippingDeliveryVisit != 'n') {
                                if (!$('input[name="visitNameAdd[' + index + ']"]').val()) {
                                    $('input[name="visitNameAdd[' + index + ']"]').focus();
                                    msg = __('방문자명을 입력해 주세요.');
                                    return false;
                                }
                                if (!$('input[name="visitPhoneAdd[' + index + ']"]').val()) {
                                    $('input[name="visitPhoneAdd[' + index + ']"]').focus();
                                    msg = __('방문자연락처를 입력해 주세요.');
                                    return false;
                                }
                            }

                            for (var i = 0; i < index ; i++) {
                                var prevShippingDeliveryVisit = $('input[name="deliveryVisitAdd[' + i + ']"]').val();
                                var prevShippingZoneCode = $('input[name="shippingZonecodeAdd[' + i + ']"]').val();
                                var prevShippingAddressSub = $('input[name="shippingAddressSubAdd[' + i + ']"]').val();

                                if (i == 0) {
                                    var addressHead = 'receiver';
                                    if ($('input[name="tmpDeliverTab"]').val()) {
                                        addressHead = $('input[name="tmpDeliverTab"]').val();
                                    }
                                    prevShippingZoneCode = $('input[name="' + addressHead + 'Zonecode"]').val();
                                    prevShippingAddressSub = $('input[name="' + addressHead + 'AddressSub"]').val();
                                }

                                if (shippingDeliveryVisit != 'y' && prevShippingDeliveryVisit != 'y' && prevShippingZoneCode == $('input[name="shippingZonecodeAdd[' + index + ']"]').val() && prevShippingAddressSub == $('input[name="shippingAddressSubAdd[' + index + ']"]').val()) {
                                    msg = __('복수 배송지를 이용 시에는 동일 배송지를 선택할 수 없습니다.');
                                    return false;
                                }
                            }
                        }
                        if ($(this).val()) {
                            $.parseJSON($(this).val()).forEach(function(ele){
                                if (ele.goodsCnt > 0) {
                                    cartGoodsCnt += parseInt(ele.goodsCnt);
                                }
                                if (ele.addGoodsTotalCnt > 0) {
                                    cartAddGoodsCnt += parseInt(ele.addGoodsTotalCnt);
                                }
                            });
                        } else {
                            msg = __('배송지마다 최소 1개 이상의 주문상품이 선택되어야 합니다.');
                            return false;
                        }
                    });

                    if (msg) {
                        alert(msg);
                        return false;
                    }

                    if (cartGoodsCnt != $('input[name="cartGoodsCnt"]').val() || cartAddGoodsCnt != $('input[name="cartAddGoodsCnt"]').val()) {
                        alert(__('배송지가 설정되지 않은 주문상품이 존재합니다.'));
                        return false;
                    }
                }
                <!--{ / }-->

                var pass = true;
                $('input:checkbox[id*="termAgree_"].require').each(function (idx, item) {
                    var $item = $(item);
                    if (!$item.prop('checked')) {
                        pass = false;
                        alert("{=__('청약의사 재확인을 동의해 주셔야 주문을 진행하실 수 있습니다.')}");
                        return false;
                    }
                });

                if (pass && $('input[name=settleKind]').length == 0 && $('#totalSettlePriceView').html() != '0') {
                    alert(__('선택된 결제 수단이 없습니다.'));
                    return false;
                }

                // 쿠폰 사용기간 체크
                if ($('input[name="totalCouponGoodsDcPrice"]').val() > 0 || $('input[name="totalCouponGoodsMileage"]').val() > 0 || $('input[name="totalCouponOrderDcPrice"]').val() > 0 || $('input[name="totalCouponOrderMileage"]').val() > 0 || $('input[name="totalCouponDeliveryDcPrice"]').val() > 0) {
                    var chkCartSno = [];
                    var couponApplyOrderNo = $('input:hidden[name="couponApplyOrderNo"]').val();
                    $('input[name="cartSno[]"]').each(function(idx){
                        chkCartSno.push($(this).val());
                    });
                    var checkCouponType = false;
                    var totalCouponGoodsDcPrice = 0;
                    var totalCouponGoodsMileage = 0;
                    var totalCouponOrderDcPrice = 0;
                    var totalCouponOrderMileage = 0;
                    var totalCouponDeliveryDcPrice = 0;
                    var orderCouponApplyNoArr = new Array();
                    $.ajax({
                        method: "POST",
                        cache: false,
                        async: false,
                        url: "../order/cart_ps.php",
                        data: {mode: 'CheckCouponTypeArr', cartSno : chkCartSno, couponApplyOrderNo : couponApplyOrderNo },
                        success: function (data) {
                            checkCouponType = data.isSuccess;
                            // 쿠폰 금액 재정의
                            if (checkCouponType) {
                                // 상품쿠폰
                                if (data.memberCouponSalePrice > 0) {
                                    totalCouponGoodsDcPrice = parseInt($('input[name=totalCouponGoodsDcPrice]').val()) - data.memberCouponSalePrice;
                                }

                                if (data.memberCouponAddMileage > 0) {
                                    totalCouponGoodsMileage = parseInt($('input[name=totalCouponGoodsMileage]').val()) - data.memberCouponAddMileage;
                                }

                                // 주문 및 배송비쿠폰
                                if (data.setCouponApplyOrderNo || data.resetCouponApplyOrderNo) {
                                    $('input:hidden[name="couponApplyOrderNo"]').val(data.setCouponApplyOrderNo);
                                    orderCouponApplyNoArr = data.resetCouponApplyOrderNo.split('{c.INT_DIVISION}');
                                    $.each(orderCouponApplyNoArr, function (index, val) {
                                        if ($('#check'+val).data('type') == 'sale') {
                                            totalCouponOrderDcPrice = parseInt($('input[name=totalCouponOrderDcPrice]').val()) - parseInt($('#check'+val).data('price'));
                                        } else if ($('#check'+val).data('type') == 'add') {
                                            totalCouponOrderMileage = parseInt($('input[name=totalCouponOrderMileage]').val()) - parseInt($('#check'+val).data('price'));
                                        } else if ($('#check'+val).data('type') == 'delivery') {
                                            totalCouponDeliveryDcPrice = parseInt($('input[name=totalCouponDeliveryDcPrice]').val()) - parseInt($('#check'+val).data('price'));
                                        }
                                    });
                                }
                            }
                        },
                        error: function (e) {
                        }
                    });

                    if(checkCouponType) {
                        // 상품 적용쿠폰
                        if (totalCouponGoodsDcPrice > 0) {
                            $('input[name=totalCouponGoodsDcPrice]').val(totalCouponGoodsDcPrice);
                        }

                        if (totalCouponGoodsMileage > 0) {
                            $('input[name=totalCouponGoodsMileage]').val(totalCouponGoodsMileage);
                        }

                        if (orderCouponApplyNoArr) {
                            // 주문 적용쿠폰
                            if (totalCouponOrderDcPrice >= 0) {
                                $('input[name=totalCouponOrderDcPrice]').val(totalCouponOrderDcPrice);
                                $('input[name=totalCouponOrderPrice]').val(totalCouponOrderDcPrice);
                            }

                            if (totalCouponOrderMileage >= 0) {
                                $('input[name=totalCouponOrderMileage]').val(totalCouponOrderMileage);
                            }

                            // 배송비 적용쿠폰
                            if (totalCouponDeliveryDcPrice >= 0) {
                                $('input[name=totalCouponDeliveryPrice]').val(totalCouponDeliveryDcPrice);
                                $('input[name=totalCouponDeliveryDcPrice]').val(totalCouponDeliveryDcPrice);
                            }
                        }
                        set_recalculation();
                        set_real_settle_price();
                        alert('사용할 수 없는 쿠폰이 있어 제외 후 주문을 진행합니다.');
                    }
                }

                if (pass) {
                    //무통장 주문결제시에 버튼 비활성화
                    if($('input[name=settleKind]:checked').val() ==  'gb' || $('#totalSettlePriceView').html() == '0'){
                        changePaymentButton(0);
                    }
                    form.target = 'ifrmProcess'
                    form.submit();
                }
            },
            rules: {
                <!--{ ? gd_is_login() == false }-->
                termAgreeGuest: 'required',
                termAgreeAgreement: 'required',
                termAgreePrivate: 'required',
                termAgreeUnder14: {
                    required: function () {
                        return $("#termAgreeDiv").attr("tabindex", -1).focus();
                    }
                },
                <!--{ / }-->
                <!--{? hasScmGoods}-->
                termAgreePrivateProvider: 'required',
                <!--{ / }-->
                orderName: 'required',
                orderCellPhone: 'required',
                orderEmail: 'required',
                receiverName: {
                    required: function () {
                        return $('#tab1').hasClass('show') && !$('.order-send:eq(0)').hasClass('dn');
                    }
                },
                receiverZonecode: {
                    required: function () {
                        return $('#tab1').hasClass('show') && !$('.order-send:eq(0)').hasClass('dn');
                    }
                },
                receiverZonecode: {
                    required: function () {
                        return $('#tab1').hasClass('show') && !$('.order-send:eq(0)').hasClass('dn');
                    },
                    <!--{ ? !gGlobal.isFront }-->
                    number: true,
                    <!--{ : }-->
                    alphanumeric: true,
                    <!--{ / }-->
                },
                receiverAddress: {
                    required: function () {
                        return $('#tab1').hasClass('show') && !$('.order-send:eq(0)').hasClass('dn');
                    }
                },
                receiverAddressSub: {
                    required: function () {
                        return $('#tab1').hasClass('show') && !$('.order-send:eq(0)').hasClass('dn');
                    }
                },
                receiverCellPhone: {
                    required: function () {
                        return $('#tab1').hasClass('show') && !$('.order-send:eq(0)').hasClass('dn');
                    }
                },
                shipping: {
                    required: function () {
                        return $('#tab2').hasClass('show') && !$('.order-send:eq(0)').hasClass('dn');
                    }
                },
                directName: {
                    required: function () {
                        return $('#tab3').hasClass('show') && !$('.order-send:eq(0)').hasClass('dn');
                    }
                },
                directZonecode: {
                    required: function () {
                        return $('#tab3').hasClass('show') && !$('.order-send:eq(0)').hasClass('dn');
                    },
                    <!--{ ? !gGlobal.isFront }-->
                    number: true,
                    <!--{ : }-->
                    alphanumeric: true,
                    <!--{ / }-->
                },
                directAddress: {
                    required: function () {
                        return $('#tab3').hasClass('show') && !$('.order-send:eq(0)').hasClass('dn');
                    }
                },
                directAddressSub: {
                    required: function () {
                        return $('#tab3').hasClass('show') && !$('.order-send:eq(0)').hasClass('dn');
                    }
                },
                directCellPhone: {
                    required: function () {
                        return $('#tab3').hasClass('show') && !$('.order-send:eq(0)').hasClass('dn');
                    }
                },
                visitName: {
                    required: function () {
                        return !$('.order-visit:eq(0)').hasClass('dn');
                    }
                },
                visitPhone: {
                    required: function () {
                        return !$('.order-visit:eq(0)').hasClass('dn');
                    }
                },
                bankSender: {
                    required: checkBank
                },
                bankAccount: {
                    required: checkBank
                },
                taxBusiNo: {
                    required: checkTax,
                    businessnoKR: checkTax
                },
                taxCompany: {
                    required: checkTax
                },
                taxCeoNm: {
                    required: checkTax
                },
                taxService: {
                    required: checkTax
                },
                taxItem: {
                    required: checkTax
                },
                <!--{ ? receipt['taxFl'] == 'y'  && taxInfo.eTaxInvoiceFl == 'y' }-->
                taxEmail: {
                    taxEmailChk: true
                },
                <!--{ / }-->
                taxAddress: {
                    required: checkTax
                },
                'cashCertNo[c]': {
                    required: function() {
                        return $('#settleKind_gb').is(':checked') && $('#receipt_cash').is(':checked') && $('#cashCert_d').is(':checked');
                    },
                    minlength: function() {
                        if ($('#settleKind_gb').is(':checked') && $('#receipt_cash').is(':checked') && $('#cashCert_d').is(':checked'))
                            return 7;
                        else
                            return false;
                    }
                },
                'cashCertNo[b]': {
                    required: function() {
                        return $('#settleKind_gb').is(':checked') && $('#receipt_cash').is(':checked') && $('#cashCert_e').is(':checked');
                    },
                    minlength: function() {
                        if ($('#settleKind_gb').is(':checked') && $('#receipt_cash').is(':checked') && $('#cashCert_e').is(':checked'))
                            return 7;
                        else
                            return false;
                    }
                }
            },
            messages: {
                <!--{ ? gd_is_login() == false }-->
                termAgreeGuest: {
                    required: "{=__('비회원 주문에 대한 개인정보 수집 이용에 동의해 주세요.')}"
                },
                termAgreeAgreement: {
                    required: "{=__('이용약관에 동의해 주세요.')}"
                },
                termAgreePrivate: {
                    required: "{=__('개인정보 수집 이용 약관에 동의해 주세요.')}"
                },
                termAgreeUnder14: {
                    required: "{=__('만 14세 이상임에 동의해 주세요.')}"
                },
                <!--{ / }-->
                <!--{? hasScmGoods}-->
                termAgreePrivateProvider: {
                    required: "{=__('상품 공급사 개인정보 제공에 동의해 주세요.')}"
                },
                <!--{ / }-->
                orderName: {
                    required: "{=__('주문하시는 분 정보를 입력해 주세요.')}"
                },
                orderCellPhone: {
                    required: "{=__('주문하시는 분 휴대폰 번호 정보를 입력해 주세요.')}"
                },
                orderEmail: {
                    required: "{=__('주문하시는 분 이메일 정보를 입력해 주세요.')}"
                },
                receiverName: {
                    required: "{=__('받으실 분 정보를 입력해 주세요.')}"
                },
                receiverZonecode: {
                    required: "{=__('받으실 곳 우편번호 정보를 입력해 주세요.')}",
                    <!--{ ? !gGlobal.isFront }-->
                    number: "{=__('숫자만 입력하실 수 있습니다.')}",
                    <!--{ : }-->
                    alphanumeric: "{=__('알파벳과 숫자로만 구성되어야 합니다.')}",
                    <!--{ / }-->
                },
                receiverAddress: {
                    required: "{=__('받으실 곳 주소 정보를 입력해 주세요.')}"
                },
                receiverAddressSub: {
                    required: "{=__('받으실 곳 주소 정보를 입력해 주세요.')}"
                },
                receiverCellPhone: {
                    required: "{=__('받으실 분 휴대폰 번호 정보를 입력해 주세요.')}"
                },
                shipping: {
                    required: "{=__('배송지 목록에서 배송지를 선택해 주세요.')}"
                },
                directName: {
                    required: "{=__('받으실 분 정보를 입력해 주세요.')}"
                },
                visitName: {
                    required: "{=__('방문자명을 입력해 주세요.')}"
                },
                visitPhone: {
                    required: "{=__('방문자연락처를 입력해 주세요.')}"
                },
                directZonecode: {
                    required: "{=__('받으실 곳 우편번호 정보를 입력해 주세요.')}",
                    <!--{ ? !gGlobal.isFront }-->
                    number: "{=__('숫자만 입력하실 수 있습니다.')}",
                    <!--{ : }-->
                    alphanumeric: "{=__('알파벳과 숫자로만 구성되어야 합니다.')}",
                    <!--{ / }-->
                },
                directAddress: {
                    required: "{=__('받으실 곳 주소 정보를 입력해 주세요.')}"
                },
                directAddressSub: {
                    required: "{=__('받으실 곳 주소 정보를 입력해 주세요.')}"
                },
                directCellPhone: {
                    required: "{=__('받으실 분 휴대폰 번호 정보를 입력해 주세요.')}"
                },
                bankSender: {
                    required: "{=__('입금자명을 입력해주세요.')}"
                },
                bankAccount: {
                    required: "{=__('입금은행을 선택해주세요.')}"
                },
                taxBusiNo: {
                    required: "{=__('[세금계산서] 사업자번호를 입력하세요.')}"
                },
                taxCompany: {
                    required: "{=__('[세금계산서] 회사명을 입력하세요.')}"
                },
                taxCeoNm: {
                    required: "{=__('[세금계산서] 대표자명을 입력하세요.')}"
                },
                taxService: {
                    required: "{=__('[세금계산서] 업태를 입력하세요.')}"
                },
                taxItem: {
                    required: "{=__('[세금계산서] 종목을 입력하세요.')}"
                },
                taxAddress: {
                    required: "{=__('[세금계산서] 사업장주소를 입력하세요.')}"
                },
                'cashCertNo[c]': {
                    required : "{=__('현금영수증을 발행할 번호를 입력해 주세요.')}",
                    minlength: "{=__('[현금영수증]휴대폰 번호은(는) 전화번호형식에 맞지 않습니다.')}"
                },
                'cashCertNo[b]': {
                    required : "{=__('현금영수증을 발행할 번호를 입력해 주세요.')}",
                    minlength: "{=__('[현금영수증]사업자 번호은(는) 전화번호형식에 맞지 않습니다.')}"
                }
            },
            focusInvalid: {
                receiverName: true,
                receiverZonecode: true,
                receiverAddress: true,
                receiverAddressSub: true,
                receiverCellPhone: true,
                directName: true,
                directZonecode: true,
                directAddress: true,
                directAddressSub: true,
                directPhone: true,
                directCellPhone: true,
            }
        });

        <!--{? memberSessionName }-->
        if ($('input[name="orderName"]').val() != '') {
            $('input[name="orderName"]').prop('readonly', true);
            if($('input[name="orderName"]').prop('readonly') === true) {
                $('input[name="orderName"][readonly]').css('background', '#eeeeee');
            }
        }
        <!--{ / }-->
        <!--{? memberSessionPhone }-->
        if ($('input[name="orderCellPhone"]').val() != '') {
            $('input[name="orderCellPhone"]').prop('readonly', true);
            if($('input[name="orderCellPhone"]').prop('readonly') === true) {
                $('input[name="orderCellPhone"][readonly]').css('background', '#eeeeee');
            }
        }
        <!--{ / }-->

        // 일반결제 > 결제수단 선택 클릭 이벤트
        if ($('input[name=settleKind]').length > 0) {
            $('input[name=settleKind]').click(function (e) {
                settlekind_selector($(this).val());
            });
        }

        // 마일리지 체크 이벤트
        <!--{ ? gd_is_login() === true && mileageUse.payUsableFl != 'n' }-->
        mileage_use_check('n', 'n', 'n');
        <!--{ / }-->
        $('input[name=useMileage]').blur(function(e){
            if (!_.isUndefined(e.isTrigger)) {
                mileage_use_check('y', 'y', 'y');
            }
        });

        // 마일리지 쿠폰 중복사용 체크
        $('input[name=useMileage]').change(function (e) {
            // 마일리지 쿠폰 중복사용 체크
            e.preventDefault();
            choose_mileage_coupon('mileage');
        });

        // 예치금 체크 이벤트
        $('input[name=useDeposit]').blur(function(e){
            if (!_.isUndefined(e.isTrigger)) {
                deposit_use_check();
            }
        });

        // 기본배송지 지역별 배송비 이벤트
        $('input[name=receiverAddressSub]').blur(function(e){
            get_delivery_area_charge($('input[name=receiverAddress]').val(), $('input[name=receiverAddressSub]').val());
        });

        // 배송지목록 지역별 배송비 이벤트
        //$('input[name=shippingAddressSub]').blur(function(e){
        $(document).on('blur', 'input[name^=shippingAddressSub]', function(e){
            get_delivery_area_charge($('input[name=shippingAddress]').val(), $('input[name=shippingAddressSub]').val());
        });

        // 해외 배송비 체크
        $('select[name$=CountryCode]').change(function(e){
            get_delivery_country_charge();
        });

        // 페이지 로딩시 우선국가 지정으로 인해 배송비 체크
        $('select[name=receiverCountryCode]').trigger('change');

        // 직접입력시 지역별 배송비 이벤트
        $('input[name=directAddressSub]').blur(function(e){
            <!--{ ? gGlobal.isFront }-->
            get_delivery_country_charge();
            <!--{ : }-->
            get_delivery_area_charge($('input[name=directAddress]').val(), $('input[name=directAddressSub]').val());
            <!--{ / }-->
        });

        // 배송지목록 지역별 배송비
        $(document).on('click', 'input[name=shipping]', function(e){
            <!--{ ? gGlobal.isFront }-->
            get_delivery_country_charge();
            <!--{ : }-->
            get_delivery_area_charge($(this).closest('.delivery-item').find('.shipping-address').text(), $(this).closest('.delivery-item').find('.shipping-addresssub').text());
            <!--{ / }-->
        });

        // 기본배송지 지역별 배송비
        if ($('input[name=receiverAddress]').val() != '') {
            <!--{ ? !gGlobal.isFront }-->
            get_delivery_area_charge($('input[name=receiverAddress]').val(), $('input[name=receiverAddressSub]').val());
            <!--{ / }-->
        }

        // 이메일 도메인 대입
        select_email_domain('orderEmail');
        select_email_domain('taxEmail','taxEmailDomain');

        // 결제 방법 선택
        if ($('input[name=settleKind]').length > 0) {
            settlekind_toggle();
        }

        <!--{ ? receipt['taxFl'] == 'y' && memberInvoiceInfo['tax']['memberTaxInfoFl'] == 'y' }-->
        // 세금계산서 입력 정보 초기화
        $('.tax-info-init').on('click', function (e) {
            e.preventDefault();
            $('#tax_info').find('input').val('');
        });
        <!--{ / }-->

        $('#visitMultiShippingFl').click(function(){
            $('input[name="multiShippingFl"]').trigger('click');
        });

        set_real_settle_price();
    });

    // 지역별 배송비 체크 (우편번호 팝업에서 콜백받는 함수)
    function postcode_callback() {
        if ($('#tab1').hasClass('show')) {
            <!--{ ? gGlobal.isFront }-->
            get_delivery_country_charge();
            <!--{ : }-->
            get_delivery_area_charge($('input[name=receiverAddress]').val(), $('input[name=receiverAddressSub]').val());
            <!--{ / }-->
        } else if($('#tab3').hasClass('show')) {
            <!--{ ? gGlobal.isFront }-->
            get_delivery_country_charge();
            <!--{ : }-->
            get_delivery_area_charge($('input[name=directAddress]').val(), $('input[name=directAddressSub]').val());
            <!--{ / }-->
        } else if($('#tab2').hasClass('show')) {
            <!--{ ? gGlobal.isFront }-->
            get_delivery_country_charge();
            <!--{ : }-->
            get_delivery_area_charge($('input[name=shippingAddress]').val(), $('input[name=shippingAddressSub]').val());
            <!--{ / }-->
        }
    }

    // 주소에 따른 지역별 배송비 가져오기
    function get_delivery_area_charge(address, addressSub) {
        var cartIdx = [];
        $('input[name="cartSno[]"]').each(function(idx){
            cartIdx.push($(this).val());
        });
        var params = {
            mode: 'check_area_delivery',
            cartSno: cartIdx,
            receiverAddress: address,
            receiverAddressSub: addressSub,
            couponApplyOrderNo: $('input:hidden[name="couponApplyOrderNo"]').val(),
            totalCouponOrderDcPrice: $('input:hidden[name="totalCouponOrderDcPrice"]').val(),
        };
        <!--{ ? isUseMultiShipping === true }-->
        if ($('input[name="multiShippingFl"]').prop('checked') === true) {
            params = {
                mode: 'check_multi_area_delivery',
                data: $('#frmOrder').serialize(),
                cartAllSno: cartIdx,
            };
        }
        <!--{ / }-->
        $.post('cart_ps.php', params, function(data){
            $('input[name=deliveryAreaCharge]').val(data.areaDelivery);

            set_real_settle_price();

            <!--{ ? gd_is_login() === true && mileageUse.payUsableFl != 'n' }-->
            mileageUse = data.mileageUse;

            mileage_use_check('y', 'n', 'n');
            <!--{ / }-->
        });
    }

    /**
     * 국가에 따른 해외 배송비 가져오기
     */
    function get_delivery_country_charge()
    {
        // 국제 전화번호 셀렉트
        var countryCode = null;
        if ($('#tab1').hasClass('show')) {
            countryCode = $('select[name=receiverCountryCode]').val();
            $('select[name=receiverPhonePrefixCode]').val($('select[name=receiverCountryCode]').val());
            $('select[name=receiverCellPhonePrefixCode]').val($('select[name=receiverCountryCode]').val());
        } else if($('#tab2').hasClass('show')) {
            countryCode = $('select[name=shippingCountryCode]').val();
        } else if($('#tab3').hasClass('show')) {
            countryCode = $('select[name=directCountryCode]').val();
            $('select[name=directPhonePrefixCode]').val($('select[name=directCountryCode]').val());
            $('select[name=directCellPhonePrefixCode]').val($('select[name=directCountryCode]').val());
        }

        // 배송비 가져오기
        var cartIdx = [];
        $('input[name="cartSno[]"]').each(function(idx){
            cartIdx.push($(this).val());
        });
        var params = {
            mode: 'check_country_delivery',
            countryCode: countryCode,
            cartSno: cartIdx,
        };
        $.post('cart_ps.php', params, function(data){
            // 배송비 계산
            if (data.error === 1) {
                data.overseasDelivery = 0;
                data.overseasInsuranceFee = 0;
                alert(data.message);
            }

            $('#totalDeliveryCharge').text(gd_money_format(data.overseasDelivery));
            $('#totalDeliveryChargeAdd').text(gd_add_money_format(data.overseasDelivery));
            $('input[name=totalDeliveryCharge]').val(data.overseasDelivery);
            $('input[name=deliveryInsuranceFee]').val(data.overseasInsuranceFee);
            $('input[name=deliveryInsuranceFeeAdd]').val(data.overseasInsuranceFee);
            set_real_settle_price();
        });
    }

    //레이어팝업 보이기
    function show_layer(val) {
        var sel_layer = $(val).data('key');

        $("#background").show();
        $(".btm-fix-layer."+sel_layer).css("bottom", "-"+$(".btm-fix-layer."+sel_layer).height()+"px");
        $(".btm-fix-layer."+sel_layer).show();
        $(".btm-fix-layer."+sel_layer).animate({bottom:0}, 300, function(){
        });
    }
    //레이어팝업 숨기기
    function close_layer(val) {

        var sel_layer = $(val).data('key');

        $(".btm-fix-layer." + sel_layer).animate({bottom: $(".btm-fix-layer." + sel_layer).height() - ($(".btm-fix-layer." + sel_layer).height() * 2)}, 300, function () {
            $(".btm-fix-layer." + sel_layer).hide();
            $("#background").hide();
        });
    }


    /**
     * 주문고객 정보와 배송지 정보 동일 처리
     */
    function order_info_same()
    {
        var orderKey = new Array('orderName', 'orderZonecode', 'orderZipcode', 'orderState', 'orderCity', 'orderAddress', 'orderAddressSub', 'orderPhone', 'orderCellPhone');
        var receiverKey = new Array('receiverName', 'receiverZonecode', 'receiverZipcode', 'receiverState', 'receiverCity', 'receiverAddress', 'receiverAddressSub', 'receiverPhone', 'receiverCellPhone');
        var directKey = new Array('directName', 'directZonecode', 'directZipcode', 'directState', 'directCity', 'directAddress', 'directAddressSub', 'directPhone', 'directCellPhone');
        var sameCheck = $('#shippingSameCheck:checked').val();
        var sameKey = receiverKey;
        var sameTitle = 'receiver';

        if (sameCheck == 'on') {
            var standardKey = orderKey;
        } else {
            var standardKey = directKey;
        }

        if ($('input[name=tmpDeliverTab]').val() == 'direct') {
            sameKey = directKey;
            sameTitle = 'direct';
        }

        for (var i = 0; i < standardKey.length; i++) {
            var orderObj = $('select[name=\''+orderKey[i]+'\']:eq(0), input[name=\''+orderKey[i]+'\']:eq(0)');
            var sameObj = $('select[name=\''+sameKey[i]+'\']:eq(0), input[name=\''+sameKey[i]+'\']:eq(0)');
            if (sameCheck == 'on') {
                if (_.isUndefined(orderObj.val())) {
                    continue;
                }
                sameObj.val(orderObj.val());
                if (sameKey[i] == sameTitle + 'Zipcode' && orderObj.val() !='') {
                    $('input[name=' + sameTitle + 'Zipcode]').val(orderObj.val());
                    $('#' + sameTitle + 'ZipcodeText').html('(' + orderObj.val() + ')');
                    $('#' + sameTitle + 'ZipcodeText').show();
                } else if (sameKey[i] == sameTitle + 'Zipcode') {
                    $('#' + sameTitle + 'ZipcodeText').html('');
                    $('#' + sameTitle + 'ZipcodeText').hide();
                }
            } else {
                if (_.isUndefined(sameObj.val())) {
                    continue;
                }console.log(sameObj);
                sameObj.val('');
                if (sameKey[i] == sameTitle + 'Zipcode') {
                    $('#' + sameTitle + 'ZipcodeText').html('');
                    $('#' + sameTitle + 'ZipcodeText').hide();
                }
            }
        }

        if (sameCheck == 'on') {
            get_delivery_area_charge($('input[name=' + sameTitle + 'Address]').val(), $('input[name=' + sameTitle + 'AddressSub]').val());
        }
    }

    /**
     * 현재 결제 금액 체크
     * @param exceptMode 제외할 모드
     */
    function set_real_settle_price(exceptMode)
    {
        // 상품 금액
        var goodsPrice = parseFloat('{=totalGoodsPrice}');
        // 배송비
        <!--{?  gd_is_login() === true && productCouponChangeLimitType == 'n'}-->
        var deliveryPrice = parseFloat($('input[name=totalDeliveryCharge]').val());
        <!--{ : }-->
        var deliveryPrice = parseFloat('{=totalDeliveryCharge}');
        <!--{ / }-->
        <!--{ ? isUseMultiShipping === true }-->
        deliveryPrice = parseFloat(multiShippingPrice(deliveryPrice));
        <!--{ / }-->
        // 전체 금액
        var settlePrice = goodsPrice + deliveryPrice;
        // 상품 할인 차감
        var goodsDcPrice = parseFloat('{=totalGoodsDcPrice}');
        if (goodsDcPrice > 0) {
            settlePrice = settlePrice - goodsDcPrice;
        }
        // 상품 쿠폰 차감
        <!--{? gd_is_login() === true && productCouponChangeLimitType == 'n'}-->
        var goodsCouponDcPrice = parseFloat($('input[name=totalCouponGoodsDcPrice]').val());
        <!--{ : }-->
        var goodsCouponDcPrice = parseFloat('{=totalCouponGoodsDcPrice}');
        <!--{ / }-->
        if (goodsCouponDcPrice > 0) {
            settlePrice = settlePrice - goodsCouponDcPrice;
        }

        // 마이앱 할인 차감
        var myappDcPrice = parseFloat('{=totalMyappDcPrice}');
        if (myappDcPrice > 0) {
            settlePrice = settlePrice - myappDcPrice;
        }

        // 회원 할인 차감
        var totalMemberDcPrice = parseFloat($('input[name=totalMemberDcPrice]').val());
        var totalMemberOverlapDcPrice = parseFloat($('input[name=totalMemberOverlapDcPrice]').val());
        var totalSettlePrice = parseFloat(settlePrice) - totalMemberDcPrice - totalMemberOverlapDcPrice;

        // 실제 결제금액
        var realSettlePrice = totalSettlePrice;

        // 지역별 배송비 합산
        if ($('input[name=deliveryAreaCharge]').val() > 0) {
            var deliveryAreaCharge = parseInt($('input[name=deliveryAreaCharge]').val());
            realSettlePrice += deliveryAreaCharge;
            $('#deliveryAreaCharge').text(numeral(deliveryAreaCharge).format());
            $('#rowDeliverAreaCharge').removeClass('dn');
        } else {
            $('#deliveryAreaCharge').text(numeral(0).format());
            $('#rowDeliverAreaCharge').addClass('dn');
        }

        // 배송비 무료 차감
        <!--{ ? deliveryFree == 'y' }-->
        var deliveryFree = parseInt(deliveryPrice);

        $('.delivery-free').text(numeral(deliveryFree).format());
        $('input[name="totalDeliveryFreePrice"]').val(deliveryFree);
        realSettlePrice -= deliveryFree;
        <!--{ / }-->

        <!--{ ? gGlobal.isFront }-->
        // 해외 배송비 합산 (위에서 기본적으로 배송비가 포함되기 때문에 해외에서만 적용해야 함)
        if ($('input[name=totalDeliveryCharge]').val() > 0) {
            var deliveryOverseasCharge = parseInt($('input[name=totalDeliveryCharge]').val());
            realSettlePrice += deliveryOverseasCharge;
        }
        <!--{ / }-->

        // 해외배송 보험료 합산
        if ($('input[name=deliveryInsuranceFee]').val() > 0) {
            var deliveryInsuranceFee = parseInt($('input[name=deliveryInsuranceFee]').val());
            var deliveryInsuranceFeeAdd = parseInt($('input[name=deliveryInsuranceFeeAdd]').val());
            realSettlePrice += deliveryInsuranceFee;
            $('#deliveryInsuranceFee').text(gd_money_format(deliveryInsuranceFee));
            $('#deliveryInsuranceFeeAdd').text(deliveryInsuranceFeeAdd);
            $('#rowDeliveryInsuranceFee').removeClass('dn');
        } else {
            $('#deliveryInsuranceFee').text(numeral(0).format());
            $('#rowDeliveryInsuranceFee').addClass('dn');
        }

        <!--{ ? couponUse == 'y' }-->
        if (exceptMode != 'coupon') {
            var totalMemberDcPrice = parseInt($('input[name=totalMemberDcPrice]').val());
            var totalMemberOverlapDcPrice = parseInt($('input[name=totalMemberOverlapDcPrice]').val());
            // 쿠폰기본설정에서 쿠폰만 사용일때 처리
            if ($('input[name="chooseCouponMemberUseType"]').val() == 'coupon' && $('input[name="couponApplyOrderNo"]').val() != '') {
                var memberDcPrice = totalMemberDcPrice + totalMemberOverlapDcPrice;
                if (memberDcPrice > 0) {
                    realSettlePrice += memberDcPrice;
                }
            }

            // 주문쿠폰 적용 금액
            if ($('input[name="totalCouponOrderDcPrice"]').val() > 0) {
                var originOrderPrice = {=totalGoodsPrice - totalGoodsDcPrice - totalCouponGoodsDcPrice} - totalMemberDcPrice - totalMemberOverlapDcPrice;
                var originOrderPriceWithoutMember = {=totalGoodsPrice - totalGoodsDcPrice - totalCouponGoodsDcPrice};
                // 쿠폰기본설정에서 쿠폰만 사용일때 처리
                if ($('input[name="chooseCouponMemberUseType"]').val() == 'coupon' && $('input[name="couponApplyOrderNo"]').val() != '') {
                    originOrderPrice = originOrderPriceWithoutMember;
                }

                if (!_.isUndefined(originOrderPrice) && $('input[name="totalCouponOrderPrice"]').val() > originOrderPrice) {
                    var useTotalCouponOrderDcPrice = parseFloat(originOrderPrice);
                } else {
                    var useTotalCouponOrderDcPrice = parseFloat($('input[name="totalCouponOrderPrice"]').val());
                }
                $('input[name="totalCouponOrderDcPrice"]').val(useTotalCouponOrderDcPrice);
                $('#useDisplayCouponDcPrice').text(numeral(useTotalCouponOrderDcPrice).format());
            } else {
                var useTotalCouponOrderDcPrice = 0;
            }

            // 배송비쿠폰 적용 금액
            if ($('input[name="totalCouponDeliveryDcPrice"]').val() > 0) {
                var originDeliveryCharge = numeral().unformat($('#totalDeliveryCharge').text()) + numeral().unformat($('#deliveryAreaCharge').text());
                if (!_.isUndefined($('input[name="deliveryFree"]')) && $('input[name="deliveryFree"]').val() == 'y') {
                    originDeliveryCharge -= numeral().unformat($('#totalDeliveryCharge').text());
                }
                if (!_.isUndefined(originDeliveryCharge) && $('input[name="totalCouponDeliveryPrice"]').val() > originDeliveryCharge) {
                    var useTotalCouponDeliveryDcPrice = parseFloat(originDeliveryCharge);
                } else {
                    var useTotalCouponDeliveryDcPrice = parseFloat($('input[name="totalCouponDeliveryPrice"]').val());
                }
                $('input[name="totalCouponDeliveryDcPrice"]').val(useTotalCouponDeliveryDcPrice);
                $('#useDisplayCouponDelivery').text(numeral(useTotalCouponDeliveryDcPrice).format());
            } else {
                var useTotalCouponDeliveryDcPrice = 0;
            }

            // 실 결제금액
            realSettlePrice -= (useTotalCouponOrderDcPrice + useTotalCouponDeliveryDcPrice);
        }
        <!--{ / }-->

        <!--{ ? gd_is_login() === true && mileageUse.payUsableFl != 'n' }-->
        if (exceptMode != 'mileage') {
            // 구매자가 작성한 마일리지 금액
            if ($('input[name=\'useMileage\']').val() > 0) {
                var useMileage = parseInt($('input[name=\'useMileage\']').val());
            } else {
                var useMileage = 0;
            }

            <!--{ ? mileageGiveExclude == 'n' }-->
            // 적립마일리지 지급 정책 안보이게 처리
            if (useMileage > 0) {
                $('.mileage').hide();
            } else {
                $('.mileage').show();
                $('.m-withoutmember').hide();
            }
            <!--{ / }-->

            realSettlePrice = realSettlePrice - useMileage;
        }
        <!--{ / }-->

        <!--{ ? gd_is_login() === true && depositUse.payUsableFl != 'n' }-->
        if (exceptMode != 'deposit') {
            // 구매자가 작성한 예치금 금액
            if ($('input[name=\'useDeposit\']').val() > 0) {
                var useDeposit = parseInt($('input[name=\'useDeposit\']').val());
            } else {
                var useDeposit = 0;
            }
            realSettlePrice = realSettlePrice - useDeposit;
        }
        <!--{ / }-->

        // 금액 화면 출력
        if (_.isUndefined(exceptMode)) {
            $('#totalSettlePrice').html(gd_money_format(realSettlePrice));
            $('#totalAddSettlePrice').html(gd_add_money_format(realSettlePrice));
            $('#totalSettlePriceView').html(gd_money_format(realSettlePrice));
            $('#totalAddSettlePriceView').html(gd_add_money_format(realSettlePrice));
            $('input[name=settlePrice]').val(realSettlePrice);

            // 해외PG 최종승인 금액 및 통화 설정
            var settleKind = $('input[name=settleKind]:checked').val();
            if (!_.isUndefined(settleKind)) {
                if (settleKind.substring(0, 1) == 'o') {
                    var selectedOverseasSettleKind = $('[id=settlekind_overseas_' + settleKind + ']');
                    var overseasSettlePrice = fx.convert($('input[name=settlePrice]').val(), {to: selectedOverseasSettleKind.data('settle-currency')});
                    var overseasDecimal = selectedOverseasSettleKind.data('settle-decimal');
                    var overseasDecimalFormat = selectedOverseasSettleKind.data('settle-format');
                    $('#overseas_settelprice_' + settleKind).html(selectedOverseasSettleKind.data('settle-symbol') + ' ' + numeral(overseasSettlePrice.toRealFixed(overseasDecimal, overseasDecimalFormat)).format('0,' + overseasDecimalFormat));
                    $('input[name=overseasSettlePrice]').val(overseasSettlePrice.toRealFixed(overseasDecimal, overseasDecimalFormat));
                    $('input[name=overseasSettleCurrency]').val(selectedOverseasSettleKind.data('settle-currency'));
                }
            }

            // 금액이 0원이 되는 경우에 대한 처리
            <!--{ ? receipt['taxZeroFl']  =='y' }-->
            if (realSettlePrice == 0) {
                $('.js-pay-content').hide();
                receipt_selector('zero');
            } else {
                $('.js-pay-content').show();
                receipt_selector();
            }
            <!--{ : }-->
            if (realSettlePrice == 0) {
                $('.how-to-pay').hide();
            } else {
                $('.how-to-pay').show();
            }
            <!--{ / }-->

        }

        return realSettlePrice;
    }

    <!--{ ? gd_is_login() === true && mileageUse.payUsableFl != 'n' }-->
    function mileage_disable_check(disableValue)
    {
        if(disableValue === 'y'){
            //disable 처리
            $('input[name=\'useMileage\'], #useMileageAll').closest('span').addClass('disabled');
            $('input[name=\'useMileage\'], #useMileageAll').attr('disabled', 'disabled');
        }
        else {
            //disable 해제
            $('input[name=\'useMileage\'], #useMileageAll').closest('span').removeClass('disabled');
            $('input[name=\'useMileage\'], #useMileageAll').attr('disabled', false);
        }
    }

    /**
     * 마일리지 안내문구 출력
     */
    function mileage_info_write(message) {
        var prefixMessage = "※ ";
        var addHtml = '<span>';
        for(i=0; i<message.length; i++) {
            addHtml += prefixMessage + message[i] + "<br/>";
        }
        addHtml += '</span>';
        $(".js-mileageInfoArea").html(addHtml);
    }

    /**
     * 마일리지 사용 제한 체크
     */
    function mileage_use_check(setUseOption, setUseCheck, setUseCalculationFl)
    {
        mileageUse.minimumHold = parseInt(mileageUse.minimumHold);
        mileageUse.minimumLimit = parseInt(mileageUse.minimumLimit);
        mileageUse.orderAbleLimit = parseInt(mileageUse.orderAbleLimit);
        mileageUse.orderAbleStandardPrice = parseInt(mileageUse.orderAbleStandardPrice);
        mileageUse.maximumLimit = parseInt(mileageUse.maximumLimit);
        mileageUse.oriMaximumLimit = parseInt(mileageUse.oriMaximumLimit);

        // 회원 보유 마일리지
        var memMileage = parseInt('{=gMemberInfo.mileage}');

        // 현재 결제 금액
        var realSettlePrice = set_real_settle_price('mileage');
        // 배송비가 제외된 금액 (할인등은 포함되어 있는 상태)
        var goodsPrice = get_goodsSalesPrice(realSettlePrice);

        // 배송비 포함 여부를 통해 비교 결제금액을 정의
        if(mileageUse.useDeliveryFl === 'n'){
            var realSettleDeliveryPrice = goodsPrice;
        }
        else {
            var realSettleDeliveryPrice = realSettlePrice;
        }

        // 실제 사용할 수 있는 최소 마일리지
        var realMinMileage = parseInt(Math.min(mileageUse.minimumLimit, realSettleDeliveryPrice));

        // 실제 사용 할 수 있는 최대 마일리지 ( ex: 배송비를 제외한 상품 함계급액이 2000원, 회원 마일리지 5000원일시 2000원 까지 사용 가능)
        var realMaxMileage = parseInt(Math.min(mileageUse.maximumLimit, realSettleDeliveryPrice, memMileage));

        // 마일리지 사용 불가능한 상태의 input 을 입력방지
        if(mileageUse.usableFl === 'n'){
            mileage_disable_check('y');
        }
        else {
            mileage_disable_check('n');
        }

        // 마일리리 사용 가능, 사용 불가 이유 문구 출력 수정을 위함.
        var gdArrMileageWrite =  new Array();

        // 마일리지 "최소 상품구매금액 제한"에 따른 플래그값
        var fl = 'n';

        // 마일리지 "최소 상품구매금액 제한"에 따른 마일리지 사용 조건 체크
        if(mileageUse.orderAbleLimit > 0){
            // orderAbleStandardPrice : 기본설정의 구매금액 기준 + 사용설정의 할인금액 미포함, 포함 가격이 적용된 기준
            if(mileageUse.orderAbleStandardPrice < mileageUse.orderAbleLimit){
                fl = 'y';
            }
        }

        // *** 1. 보유 마일리지에 대한 제한조건 체크

        // 회원 보유 마일리지 체크
        if(memMileage < 1){
            mileage_disable_check('y');
            return;
        }

        // 마일리지 사용설정 - 최소 보유마일리지 제한
        if(mileageUse.minimumHold > 0){
            // '회원 보유마일리지'가 '최소 보유마일리지 제한' 보다 작을 경우
            if(memMileage < mileageUse.minimumHold){
                if(mileageUse.minimumLimit <= mileageUse.minimumHold){
                    gdArrMileageWrite.push("{=__('%s%s이상 보유해야 사용이 가능합니다.', gd_global_money_format(mileageUse.minimumHold), mileage.unit)}");
                }
                else {
                    // '최소 사용마일리지 제한' > '최소 보유마일리지 제한' > 회원 보유 마일리지
                    gdArrMileageWrite.push("{=__('최소 %s%s이상 사용해야 합니다.', gd_global_money_format(mileageUse.minimumLimit), mileage.unit)}");
                }
                if(fl == 'y') {
                    gdArrMileageWrite.push(mileage_goods_total_check_message());
                }
                mileage_info_write(gdArrMileageWrite);
                mileage_disable_check('y');
                return;
            }
        }

        // 마일리지 사용설정 - 최소 사용마일리지 제한
        if(mileageUse.minimumLimit > 0){
            // '회원 마일리지' 보다 '최소 사용마일리지 제한' 보다 작을 경우
            if(memMileage < mileageUse.minimumLimit){
                if(mileageUse.minimumHold <= mileageUse.minimumLimit){
                    gdArrMileageWrite.push("{=__('최소 %s%s이상 사용해야 합니다.', gd_global_money_format(mileageUse.minimumLimit), mileage.unit)}");
                }
                else {
                    // '최소 보유마일리지 제한' > '최소 사용마일리지 제한' > 회원 보유 마일리지
                    gdArrMileageWrite.push("{=__('%s%s이상 보유해야 사용이 가능합니다.', gd_global_money_format(mileageUse.minimumHold), mileage.unit)}");
                }
                if(fl == 'y') {
                    gdArrMileageWrite.push(mileage_goods_total_check_message());
                }
                mileage_info_write(gdArrMileageWrite);
                mileage_disable_check('y');
                return;
            }
        }

        // 마일리지 사용설정 - 최소 사용마일리지 제한
        if(mileageUse.minimumLimit > 0){
            // 결제금액이 '최소 사용마일리지 제한' 보다 작을 경우
            if(realSettleDeliveryPrice < mileageUse.minimumLimit){
                var messageMaxMileage = memMileage;
                if(mileageUse.oriMaximumLimit > 0){
                    if(mileageUse.oriMaximumLimit > realSettleDeliveryPrice){
                        messageMaxMileage = Math.min(mileageUse.oriMaximumLimit, memMileage);
                    }
                }
                gdArrMileageWrite.push(__('%1$s%2$s부터 %3$s%4$s까지 사용 가능합니다.', [numeral(mileageUse.minimumLimit).format(), '{mileage.unit}', numeral(messageMaxMileage).format(), '{mileage.unit}']));
                if(fl == 'y') {
                    gdArrMileageWrite.push(mileage_goods_total_check_message());
                }
                mileage_info_write(gdArrMileageWrite);
                mileage_disable_check('y');
                return;
            }
        }

        // *** 3. 사용가능 마일리지 범위 정보 노출

        if(realMinMileage > realMaxMileage){
            //최소 사용가능 마일리지가 최대 사용가능 마일리지보다 클때
            gdArrMileageWrite.push("{=__('마일리지 사용조건이 충족되지 않아 사용이 불가합니다.')}");
            mileage_info_write(gdArrMileageWrite);
            mileage_disable_check('y');
            return;
        }
        else if(realMinMileage === realMaxMileage){
            //최소 사용가능 마일리지가 최대 사용가능 마일리지와 같을때
            gdArrMileageWrite.push(__('%1$s%2$s만 사용 가능합니다.', [numeral(realMaxMileage).format(), '{mileage.unit}']));
            mileage_disable_check('n');
            if(fl == 'y') {
                gdArrMileageWrite.push(mileage_goods_total_check_message());
                mileage_disable_check('y');
            }
            mileage_info_write(gdArrMileageWrite);
        }
        else {
            //최소 사용가능 마일리지가 최대 사용가능 마일리지보다 작을때
            if(realMinMileage < 1){
                gdArrMileageWrite.push(__('%1$s%2$s까지 사용 가능합니다.', [numeral(realMaxMileage).format(), '{mileage.unit}']));
            }
            else {
                gdArrMileageWrite.push(__('%1$s%2$s부터 %3$s%4$s까지 사용 가능합니다.', [numeral(realMinMileage).format(), '{mileage.unit}', numeral(realMaxMileage).format(), '{mileage.unit}']));
            }
            mileage_disable_check('n');
            if(fl == 'y') {
                gdArrMileageWrite.push(mileage_goods_total_check_message());
                mileage_disable_check('y');
            }
            mileage_info_write(gdArrMileageWrite);
        }

        // *** 4. 사용가능 마일리지 범위 체크 및 결제금액 계산

        if(setUseOption === 'y'){
            var useMileage = parseInt($('input[name=\'useMileage\']').val());

            if(setUseCheck === 'y'){
                if(useMileage < realMinMileage){
                    mileage_abort(__('%1$s 사용은 최소 %2$s%3$s입니다.', ['{mileage.name}', numeral(realMinMileage).format(), '{mileage.unit}']), realMinMileage);
                }
                if(useMileage > realMaxMileage){
                    mileage_abort(__('%1$s 사용은 최대 %2$s%3$s입니다.', ['{mileage.name}', numeral(realMaxMileage).format(), '{mileage.unit}']), realMaxMileage);
                }
            }
            else {
                if(useMileage < realMinMileage){
                    $('input[name=\'useMileage\']').val(realMinMileage);
                }
                else if(useMileage > realMaxMileage){
                    $('input[name=\'useMileage\']').val(realMaxMileage);
                }
                else { }
            }

            if(setUseCalculationFl === 'y'){
                // 결제 금액 계산
                set_recalculation();
                set_real_settle_price();
            }
        }
    }

    /**
     * 마일리지 "최소 상품구매금액 제한" 문구 반복 출력을 위함.
     */
    function mileage_goods_total_check_message()
    {
        return ("{=__('상품 합계 금액이 %s 이상인 경우에만 사용 가능합니다.', gd_global_currency_display(mileageUse.orderAbleLimit))}");
    }

    /**
     * 마일리지를 잘못 입력한 경우 처리
     */
    function mileage_abort(message, useMileage)
    {
        // 경고출력
        if (!_.isUndefined(message) && message !== null) {
            alert(message);
        }

        // 값 대입
        if (_.isUndefined(useMileage)) {
            $('input[name=\'useMileage\']').val('');
        } else {
            $('input[name=\'useMileage\']').val(useMileage);
        }
    }

    /**
     * 마일리지 전액 사용하기
     */
    function mileage_use_all()
    {
        // 마일리지 쿠폰 중복사용 체크
        var checkMileageCoupon = choose_mileage_coupon('mileage');
        if (!checkMileageCoupon) {
            return false;
        }
        var allCheck = $('#useMileageAll:checked').val();

        // 현재 결제 금액
        var realSettlePrice = set_real_settle_price('mileage');
        if(mileageUse.useDeliveryFl === 'n'){
            // 마일리지 사용의 배송비 제외 설정에 따른 배송비 체크
            realSettlePrice = get_goodsSalesPrice(realSettlePrice);
        }

        var memberMileage = parseInt("{=gMemberInfo.mileage}");
        var checkMileage = Math.min(mileageUse.maximumLimit, realSettlePrice, memberMileage);

        if (allCheck == 'on') {
            $('input[name=\'useMileage\']').val(checkMileage);

            mileage_use_check('y', 'y', 'y');
        }
        else {
            $('input[name=\'useMileage\']').val('');

            set_recalculation();
            set_real_settle_price();
        }
    }
    <!--{ / }-->

    <!--{ ? gd_is_login() === true && depositUse['payUsableFl'] != 'n' }-->
    /**
     * 예치금 사용 제한 체크
     */
    function deposit_use_check()
    {
        // 예치금 작성한 금액이 있는지 체크
        if ($('input[name=\'useDeposit\']').val() < 0) {
            return;
        }

        // 현재 결제 금액
        var realSettlePrice = set_real_settle_price('deposit');
        if(mileageUse.useDeliveryFl === 'n'){
            // 마일리지 사용의 배송비 제외 설정에 따른 배송비 체크
            realSettlePrice = get_goodsSalesPrice(realSettlePrice);
        }
        var memberDeposit = parseInt({=gMemberInfo.deposit});
        var ownDeposit = parseInt({=gMemberInfo.deposit});
        var checkDeposit = memberDeposit;

        if (realSettlePrice < memberDeposit) {
            checkDeposit = realSettlePrice;
        }
        if (realSettlePrice > ownDeposit) {
            checkDeposit = ownDeposit;
        }

        // 구매자가 작성한 예치금 금액
        var useDeposit = parseInt($('input[name=\'useDeposit\']').val());

        // 예치금 사용 제한 체크
        if (useDeposit > checkDeposit) {
            $('input[name=\'useDeposit\']').val(checkDeposit);
        }

        // 결제 금액 계산
        set_real_settle_price();
    }

    /**
     * 예치금 전액 사용하기
     */
    function deposit_use_all()
    {
        // 현재 결제 금액
        var realSettlePrice = set_real_settle_price('deposit');
        if(mileageUse.useDeliveryFl === 'n'){
            // 마일리지 사용의 배송비 제외 설정에 따른 배송비 체크
            realSettlePrice = get_goodsSalesPrice(realSettlePrice);
        }
        var allCheck = $('#useDepositAll:checked').val();
        var memberDeposit = parseInt({=gMemberInfo.deposit});
        var checkDeposit = memberDeposit;

        if (realSettlePrice < memberDeposit) {
            checkDeposit = realSettlePrice;
        }

        if (allCheck == 'on') {
            $('input[name=\'useDeposit\']').val(checkDeposit);
        } else {
            $('input[name=\'useDeposit\']').val('');
        }

        // 결제 금액 계산
        set_real_settle_price();
    }
    <!--{ / }-->

    /**
     * 결제 방법에 따른 결제 수단
     */
    function settlekind_toggle()
    {
        // 선택된 주문
        var settleKind = $('input[name=settleKind]:checked').val();
        var paymentCheck = false;

        // 체크된 것이 없고 체크된 결제수단도 없는 경우
        var checkedCnt = $('.how-to-pay input[type=radio][id*=payment]:checked').length;
        if (typeof settleKind == 'undefined' && checkedCnt == '') {
            // 초기 결제수단 처리
            <!--{ ? gGlobal.isFront }-->
            var settleKind = $('#settlekind_overseas').find('input').first().val();
            $('#settlekind_overseas input[name=settleKind]:radio:first').prop('checked', true);
            $('#payment4').prop('checked', true);
            <!--{ : }-->
            <!--{ ? isset(settle.payco) && paycoDefaultUseFl != 'n' && !isset(settle.general.pp) }-->
            var settleKind = $('#settlekind_payco').find('input').first().val();
            <!--{ : }-->
            var settleKind = $('#settlekind_general').find('input').first().val();
            $('#settlekind_general input[name=settleKind]:radio:first').prop('checked', true);
            $('#payment2').prop('checked', true);
            <!--{ / }-->
            <!--{ / }-->
        }

        // 결제 수단 체크
        var payment2 = $('input[id=\'payment2\']:checked').val();
        var payment3 = $('input[id=\'payment3\']:checked').val();
        var payment4 = $('input[id=\'payment4\']:checked').val();

        if (payment2 == 'on') {
            $('#settlekind_general').show();
            $('#settlekind_escrow').hide();
            $('#settlekind_fintech_payco').hide();
            $('#settlekind_overseas').hide();
            $('#settlekind_general input[name=settleKind]:radio:first').prop('checked', true);
            settleKind = $('#settlekind_general input[name=settleKind]:checked').val();
            paymentCheck = true;
        }
        if (payment3 == 'on') {
            $('#settlekind_general').hide();
            $('#settlekind_escrow').show().find(':radio:first').prop('checked', true);
            $('#settlekind_fintech_payco').hide();
            $('#settlekind_overseas').hide();
            $('#settlekind_escrow input[name=settleKind]:radio:first').prop('checked', true);
            settleKind = $('#settlekind_escrow input[name=settleKind]:checked').val();
            paymentCheck = true;
        }
        if (payment4 == 'on') {
            $('#settlekind_general').hide();
            $('#settlekind_escrow').hide();
            $('#settlekind_fintech_payco').hide();
            $('#settlekind_overseas').show();
            $('#settlekind_overseas input[name=settleKind]:radio:first').prop('checked', true);
            settleKind = $('#settlekind_overseas input[name=settleKind]:checked').val();
            paymentCheck = true;
        }

        // PAYCO 인 경우
        if (settleKind.substring(0, 1) == 'f' && paymentCheck == false) {
            // 페이코 선택
            payco_toggle(settleKind);
        } else {
            // 결제 수단을 초기화
            payment_reset();

            // 결제수단 선택
            settlekind_selector(settleKind);
        }
    }

    /**
     * 결제 수단을 초기화
     */
    function payment_reset()
    {
        // 주문 채널을 기본 shop 으로 처리
        $('[name="orderChannelFl"]').val('shop');

        <!--{ @ settle.payco }-->
        // PAYCO 아이콘 전체 리셋
        var checkKey = 'js-payco-icon-';
        $('img[class*=' + checkKey + ']').each(function (idx) {
            var kindName = $(this).attr('class').replace(checkKey, '');
            $(".js-payco-icon-" + kindName).attr('src', $(".js-payco-icon-" + kindName).attr('src').replace('_on', '_off'));
        });
        <!--{ / }-->
    }

    /**
     * 주문 채널을 페이코로 세팅
     */
    function setOrderChannelPayco()
    {
        $('[name="orderChannelFl"]').val('payco');
    }

    /**
     * 결제 수단 체크 박스 클릭시
     */
    function settlekind_toggle_check(toggleKind)
    {
        if (toggleKind == 'payco') {
            payco_toggle('check');
        } else {
            $('.how-to-pay input[type=radio][id*=payment]:first').prop('checked', true);
            settlekind_toggle();
        }
    }

    /**
     * PAYCO 결제 클릭시
     */
    function payco_toggle(settleKind)
    {
        // 초기화
        payment_reset()

        $('#settlekind_general').hide();
        $('#settlekind_escrow').hide();
        $('#settlekind_fintech_payco').show();
        $('#settlekind_overseas').hide();

        setOrderChannelPayco();

        if (settleKind == 'check') {
            settleKind = $('#settlekind_payco').find('input').first().val();
        }

        // 결제 수단 체크 해제
        $('label[for*=payment]').prev('input[type=radio]').prop('checked', false);

        // 해당 주문 체크
        $('#settleKind_payco_' + settleKind).prop('checked', true);

        // 다른 주문 체크 해제
        $('label[for*=settleKind_][class="choice-s on"]').each(function(i, val) {
            $(this).removeClass('on');
        });

        $(".js-payco-icon-" + settleKind).attr('src', $(".js-payco-icon-" + settleKind).attr('src').replace('_off', '_on'));

        // 결제수단 선택
        settlekind_selector(settleKind);
    }

    /**
     * 결제수단 선택
     *
     * @param settleKind
     * @returns {boolean}
     */
    function settlekind_selector(settleKind)
    {
        if (_.isUndefined(settleKind) || _.isNull(settleKind)) {
            settleKind = $('label[for*=settleKind_]').prev('input[type=radio]').val();
            $('label[for=settleKind_' + settleKind + ']').prev('input[type=radio]').prop('checked', true);
        }

        <!--{ ? isset(settle.payco) && !isset(settle.general.pp) }-->
        // 체크 이미지
        if ($('[name="orderChannelFl"]').val() == 'payco') {
            $(".js-payment-check-payco").attr('src', $(".js-payment-check-payco").attr('src').replace('_off', '_on'));
            $(".js-payment-check-general").attr('src', $(".js-payment-check-general").attr('src').replace('_on', '_off'));
        } else {
            $(".js-payment-check-payco").attr('src', $(".js-payment-check-payco").attr('src').replace('_on', '_off'));
            $(".js-payment-check-general").attr('src', $(".js-payment-check-general").attr('src').replace('_off', '_on'));
        }
        <!--{ : }-->
        $(".js-payment-check-general").attr('src', $(".js-payment-check-general").attr('src').replace('_off', '_on'));
        <!--{ / }-->

        // 결제수단 선택에 따른 입력 폼 전환
        $('[id*="settlekind_general_"]').hide();
        $('[id*="settlekind_overseas_"]').hide();

        if ($('[name="orderChannelFl"]').val() == 'shop') {
            if (settleKind == 'pp') {
                setOrderChannelPayco();
            }
            // 일반 PG 안내 / 설정 - 무통장인 경우에만
            if (settleKind == 'gb') {
                $('[id=settlekind_general_' + settleKind + ']').show();
            }

            // 해외PG 최종승인 금액 및 통화 설정 (국가 변경시 배송비 실시간 적용 처리)
            if (settleKind.substring(0, 1) == 'o') {
                // 해외 PG 안내 / 설정
                $('[id=settlekind_overseas_' + settleKind + ']').show();
                set_real_settle_price();
            }
        }

        // 영수증 선택 리셋
        receipt_reset();

        <!--{ ? receipt['cashFl'] == 'y' || receipt['taxFl'] == 'y' }-->
        // 영수증 선택
        receipt_selector();
        <!--{ / }-->
    }

    /**
     * 영수증 선택 리셋
     * - 우선 처리 모드에 따라서 영수증 종류 기본 선택 처리
     */
    function receipt_reset()
    {
        // 선택된 결제 방법
        var strSettleKind = $('input[name=settleKind]:checked').val();

        // 현금영수증 (소득공제/지출증빙) 보이지 않도록 강제 처리
        $('input[name="receiptFl"]').prop('checked', false);

        // 영수증 신청 안함 보이게 처리
        $('#non_receipt_view').show();

        // 사용 안함을 기본 체크 처리
        if (strSettleKind.substring(0, 1) != 'g' || '{=gd_isset(receipt['aboveFl'], 'n')}' == 'n'){
        $('#receipt_non').eq(0).prop('checked', true);
    }

        <!--{ ? receipt['aboveFl'] == 'r' || receipt['aboveFl'] == 't' }-->
        // 결제 방법의 코드가 일반 인 경우
        if (strSettleKind.substring(0, 1) == 'g') {
            // 영수증 신청 안함 안보이게 처리
            $('#non_receipt_view').hide();

            <!--{ ? receipt['aboveFl'] == 'r' }-->
            // 현금영수증을 기본 체크 처리
            $('#receipt_cash').eq(0).prop('checked', true);
            <!--{ / }-->
        }

        <!--{ ? receipt['aboveFl'] == 't' }-->
        // 세금계산서를 기본 체크 처리
        var useReceiptCode = {receipt['useReceiptCode']};
        $.each(useReceiptCode, function(i, val) {
            if (strSettleKind == val) {
                $('#receipt_non').eq(0).prop('checked', false);
                $('#receipt_tax').eq(0).prop('checked', true);
                return false;
            }
        });
        <!--{ / }-->
        <!--{ / }-->
    }

    /**
     * 영수증 선택
     *
     * @param string mode 모드에 따른 처리 (null : 일반 처리, zero : 전액결제 처리)
     */
    function receipt_selector(mode)
    {
        <!--{ ? receipt['cashFl'] == 'y' || receipt['taxFl'] == 'y' }-->
        var useReceiptCode = {receipt['useReceiptCode']};
        var useCashReceiptCode = 'gb';
        var strSettleKind = $('input[name=\'settleKind\']:checked').val();

        $('.js-gd5-receipt-select').hide();
        if (typeof strSettleKind != 'undefined') {
            $.each(useReceiptCode, function(i, val) {
                if (strSettleKind == val) {
                    $('.js-gd5-receipt-select').show();
                    if (strSettleKind != 'gb') $('.js-gd5-cash-receipt-info').hide();
                    return false;
                }
            });
        }

        // 전액 결제인 경우 영수증 항목 보이기
        if (mode == 'zero') {
            $('.js-gd5-receipt-select').show();
        }

        // 영수증 관련 선택
        receipt_display();

        // 현금 영수증 설정 (무통장입금인 경우에만 출력, 계좌이체와 가상계좌는 PG사 창에서 처리)
        if (strSettleKind == useCashReceiptCode) {
            $('#cash_receipt_view').show();
            $('.cash_receipt_non').show();
            $('.cash_receipt_pg').hide();
        } else {
            $('#cash_receipt_view').hide();
            $('.cash_receipt_non').hide();
            $('.cash_receipt_pg').show();
        }

        // 전액 결제인 경우 영수증 항목 보이기
        if(mode == 'zero') {
            $('#cash_receipt_view').hide();
            $('.cash_receipt_non').show();
            $('.cash_receipt_pg').hide();
        }
        <!--{ / }-->
    }

    <!--{ ? receipt['cashFl'] == 'y' || receipt['taxFl'] == 'y' }-->
    /**
     * 영수증 관련 선택
     *
     * @param string clearChecker 해제 관련
     */
    function receipt_display()
    {
        var useCode = {
            t: 'tax_info',
            r: 'cash_receipt_info'
        };
        var checkedBox = $('input:radio[name=receiptFl]:checked');
        var target = eval('useCode.' + checkedBox.val());

        $('.js-receipt').addClass('dn');
        $('#' + target).removeClass('dn');

        if (checkedBox.val() == 'r') {
            cash_receipt_toggle();
        }

        <!--{ ? receipt['taxFl'] == 'y' && memberInvoiceInfo['tax']['memberTaxInfoFl'] == 'y' }-->
        $('.tax-info-init').addClass('dn');
        if (checkedBox.val() == 't') {
            $('.tax-info-init').removeClass('dn');
        }
        <!--{ / }-->
    }
    <!--{ / }-->

    /**
     * 현금영수증 인증방법 선택
     * (소득공제용 - 휴대폰 번호(c), 지출증빙용 - 사업자번호(b))
     */
    function cash_receipt_toggle()
    {
        <!--{ ? receipt['cashFl'] == 'y' }-->
        var certCode = $('input[name=\'cashUseFl\']:checked').val();

        if (certCode == 'd') {
            $('input[name=\'cashCertFl\']').val('c');
            $('#certNo_hp').show();
            $('#certNo_bno').hide();
        } else {
            $('input[name=\'cashCertFl\']').val('b');
            $('#certNo_hp').hide();
            $('#certNo_bno').show();
        }
        <!--{ / }-->
    }

    /**
     * 결제하기 버튼 상태 변경
     */
    function changePaymentButton(state) {
        if (state) {
            $('#payment-btn').prop('disabled', false);
            $('#payment-btn').text("{=__('결제하기')}");
        } else {
            $('#payment-btn').prop('disabled', true);
            $('#payment-btn').text("{=__('결제처리중')}");
        }
    }

    function insertShippingData(data, shippingNo) {
        if (shippingNo > 0) {
            var nameTails = 'Add[' + shippingNo + ']';
        } else {
            var nameTails = '';
            shippingNo = 0;
            $('.order-table-area').show();
        }

        $('input[name="shippingSno' + nameTails + '"]').val(data.sno);
        $('input[name="shippingName' + nameTails + '"]').val(data.shippingName);
        $('input[name="shippingZipcode' + nameTails + '"]').val(data.shippingZipcode);
        $('input[name="shippingZonecode' + nameTails + '"]').val(data.shippingZonecode);
        $('input[name="shippingCountry' + nameTails + '"]').val(data.shippingCountry);
        $('select[name="shippingCountryCode' + nameTails + '"]').val(data.shippingCountryCode);
        $('input[name="shippingState' + nameTails + '"]').val(data.shippingState);
        $('input[name="shippingCity' + nameTails + '"]').val(data.shippingCity);
        $('input[name="shippingAddress' + nameTails + '"]').val(data.shippingAddress);
        $('input[name="shippingAddressSub' + nameTails + '"]').val(data.shippingAddressSub);
        $('input[name="shippingPhonePrefix' + nameTails + '"]').val(data.shippingPhonePrefix);
        $('select[name="shippingPhonePrefixCode' + nameTails + '"]').val(data.shippingPhonePrefixCode);
        $('input[name="shippingPhone' + nameTails + '"]').val(data.shippingPhone);
        $('input[name="shippingCellPhonePrefix' + nameTails + '"]').val(data.shippingCellPhonePrefix);
        $('select[name="shippingCellPhonePrefixCode' + nameTails + '"]').val(data.shippingCellPhonePrefixCode);
        $('input[name="shippingCellPhone' + nameTails + '"]').val(data.shippingCellPhone);
        if (shippingNo > 0) {}
        else {
            if (data.defaultFl == 'y') {
                $('input[name="shippingDefault"]').prop('checked', true).attr('onclick', 'return false');
            } else {
                $('input[name="shippingDefault"]').prop('checked', false).attr('onclick', '');
            }
        }
        $('.delivery-list-add:eq(' + shippingNo + ') .btn-shipping-receiver').each(function(){
            if ($(this).hasClass('selected')) $(this).removeClass('selected');
            if (data.sno == $(this).find('a').data('sno')) $(this).addClass('selected');
        });
        <!--{ ? gGlobal.isFront }-->
        get_delivery_country_charge();
        <!--{ : }-->
        get_delivery_area_charge(data.shippingAddress, data.shippingAddressSub);
        <!--{ / }-->
    }

    /**
     * 마일리지 쿠폰 중복사용 체크
     */
    function choose_mileage_coupon(type) {
        if (type == undefined) {
            return false;
        }

        // 마일리지 쿠폰 중복사용 체크
        if ($('input[name=chooseMileageCoupon]').length > 0) {
            if ($('input[name=chooseMileageCoupon]').val() == 'y') {
                if (type == 'mileage') {
                    // 마일리지 입력시 체크
                    if ($('input[name=totalCouponGoodsDcPrice]').length > 0 && $('input[name=totalCouponGoodsMileage]').length > 0) {
                        var totalCouponGoodsDcPrice = $('input[name=totalCouponGoodsDcPrice]').val();
                        var totalCouponGoodsMileage = $('input[name=totalCouponGoodsMileage]').val();


                        if (totalCouponGoodsDcPrice > 0 || totalCouponGoodsMileage > 0 || ($('input[name=couponApplyOrderNo]').val() != '' && $('input[name=couponApplyOrderNo]').length > 0)) {
                            alert('마일리지와 쿠폰은 동시에 사용하실 수 없습니다.');
                            $('input[name=useMileage]').val('');
                            $("#useMileageAll").attr('checked', false);
                            $('label[for=useMileageAll]').removeClass('on');
                            return false;
                        }
                    }
                } else {
                    // 쿠폰사용 클릭시 체크
                    if ($('input[name=useMileage]').val() != '' && $('input[name=useMileage]').val() != 0) {
                        alert('마일리지와 쿠폰은 동시에 사용하실 수 없습니다.');
                        return false;
                    }
                }
            }
        }

        return true;
    }

    /**
     * validator onkeyup 함수
     * @param element
     * @param event
     * @returns {boolean}
     */
    function onkeyup(element, event) {
        if (check_key_code2(event)) {
            return true;
        }
        if ($.isFunction(replace_keyup[$(element).data('pattern')])) {
            replace_keyup[$(element).data('pattern')](element);
        }
    }

    var regexp_test = function (string, pattern) {
        if (string === undefined || string.length < 1) {
            return false;
        }
        return pattern.test(string);
    };

    var replace_pattern = function (string, pattern, c) {
        if (string === undefined || string.length < 1) {
            return '';
        }
        return string.replace(pattern, c);
    };

    var replace_keyup = {
        gdEngNum: function (element) {
            element.value = replace_pattern(element.value, /[^\da-zA-Z]/g, '');
        },
        gdEngKor: function (element) {
            // IE11에서 초중종성 분리되는 현상때문에 test 후 replace 처리로 변경
            if (regexp_test(element.value, /[^a-zA-Zㄱ-ㅎㅏ-ㅣ가-힣\u119E\u11A2]/)) {
                element.value = replace_pattern(element.value, /[^a-zA-Zㄱ-ㅎㅏ-ㅣ가-힣\u119E\u11A2]/g, '');
            }
        },
        gdEngKorNum: function (element) {
            // IE11에서 초중종성 분리되는 현상때문에 test 후 replace 처리로 변경
            if (regexp_test(element.value, /[^a-zA-Zㄱ-ㅎㅏ-ㅣ가-힣0-9\u119E\u11A2]/)) {
                element.value = replace_pattern(element.value, /[^a-zA-Zㄱ-ㅎㅏ-ㅣ가-힣0-9\u119E\u11A2]/g, '');
            }

        },
        gdNum: function (element) {
            element.value = replace_pattern(element.value, /[^\d]/g, '');
        },
        gdEng: function (element) {
            element.value = replace_pattern(element.value, /[^a-zA-Z]/g, '');
        },
        gdKor: function (element) {
            if (regexp_test(element.value, /[^가-힣ㄱ-ㅎㅏ-ㅣ\u119E\u11A2]/)) {
                element.value = replace_pattern(element.value, /[^가-힣ㄱ-ㅎㅏ-ㅣ\u119E\u11A2]/g, '');
            }
        },
        gdMemberId: function (element) {
            element.value = replace_pattern(element.value, /[^\da-zA-Z\.\-_@]/g, '');
        },
        gdMemberNmGlobal: function (element) {
            // IE11에서 초중종성 분리되는 현상때문에 test 후 replace 처리로 변경
            if (regexp_test(element.value, /[\/\'\"\\\|]/)) {
                element.value = replace_pattern(element.value, /[\/\'\"\\\|]/g, '');
            }
        }
    };

    /**
     * jquery validation의 키 체크 함수
     * @param event
     * @returns {boolean}
     */
    function check_key_code2(event) {
        // Avoid revalidate the field when pressing one of the following keys
        /* Shift       => 16 Ctrl        => 17 Alt         => 18
         Caps lock   => 20 End         => 35 Home        => 36
         Left arrow  => 37 Up arrow    => 38 Right arrow => 39
         Down arrow  => 40 Insert      => 45 Num lock    => 144 AltGr key   => 225*/
        var excludedKeys = [
            16, 17, 18, 20, 35, 36, 37,
            38, 39, 40, 45, 144, 225
        ];

        return event.which === 9 || $.inArray(event.keyCode, excludedKeys) !== -1;
    }

    // 주문서 변경에 따른 상품 금액 정보 변경 처리
    function set_recalculation()
    {
        // 마일리지 사용시 / 주문쿠폰 적용시 재계산
        var cartIdx = [];
        $('input[name="cartSno[]"]').each(function(idx){
            cartIdx.push($(this).val());
        });
        $.ajax({
            method: "POST",
            data: {
                'mode': 'set_recalculation',
                'cartIdx': cartIdx,
                'totalCouponOrderDcPrice': $('input:hidden[name="totalCouponOrderDcPrice"]').val(),
                'deliveryFree': $('input:hidden[name="deliveryFree"]').val(),
                'useMileage': $('input[name="useMileage"]').val(),
                'totalDeliveryCharge' : $('input[name=totalDeliveryCharge]').val(),
                'deliveryAreaCharge' : $('input[name=deliveryAreaCharge]').val(),
            },
            cache: false,
            async: false,
            url: "../order/order_ps.php",
            success: function (data) {
                if (data) {
                    $('input[name=totalMemberDcPrice]').val(data.totalMemberDcPrice);
                    $('input[name=totalMemberOverlapDcPrice]').val(data.totalMemberOverlapDcPrice);
                    $('input[name=totalMemberMileage]').val(data.totalMemberMileage);
                    $('input[name=totalCouponGoodsDcPrice]').val(data.totalCouponGoodsDcPrice);

                    $('.total-member-dc-price').html(numeral(data.totalGoodsDcPrice + data.totalMemberDcPrice + data.totalMemberOverlapDcPrice + data.totalCouponGoodsDcPrice + data.totalMyappDcPrice).format());
                    $('.total-member-dc-price-add').html(numeral(data.totalMemberDcPriceAdd).format());
                    $('.member-dc-price').html(numeral(data.totalMemberDcPrice + data.totalMemberOverlapDcPrice).format());
                    $('.total-member-mileage').html(numeral(data.totalMileage).format());
                    $('.goods-mileage').html(numeral(data.totalGoodsMileage).format());
                    $('.member-mileage').html(numeral(data.totalMemberMileage).format());

                    <!--{? gd_is_login() === true && productCouponChangeLimitType == 'n'}-->
                    var totalDeliveryCharge = data.totalDeliveryCharge;
                    $('.goods-coupon-dc-price').html(numeral(data.totalCouponGoodsDcPrice).format());
                    $('.goods-coupon-add-mileage').html(numeral(data.totalCouponGoodsMileage).format());

                    <!--{ ? couponUse == 'y' && couponConfig['chooseCouponMemberUseType'] != 'member' }-->
                    $('.goods-coupon-dc-price-without-member').html(numeral(data.totalCouponGoodsDcPrice).format());
                    $('.goods-coupon-add-mileage-without-member').html(numeral(data.totalCouponGoodsMileage).format());
                    $('.total-member-dc-price-without-member').html(numeral(data.totalGoodsDcPrice + data.totalCouponGoodsDcPrice + data.totalMyappDcPrice).format());
                    $('.total-member-mileage-without-member').html(numeral(data.totalMileage).format());
                    <!--{ / }-->

                    <!--{ ? deliveryFree != 'y' }-->
                    $('input[name=totalDeliveryCharge]').val(totalDeliveryCharge);
                    $('#totalDeliveryCharge').html(numeral(parseInt(totalDeliveryCharge)).format());
                    <!--{ / }-->
                    <!--{ / }-->

                    <!--{ ? gd_is_login() === true && mileageUse.payUsableFl != 'n' }-->
                    mileageUse = data.mileageUse;
                    <!--{ / }-->
                }
            }
        });
    }

    /**
     * 결제금액에서 상품금액만 구하기 (배송비 제외)
     * @param realSettlePrice
     * @returns {number|*}
     */
    function get_goodsSalesPrice(realSettlePrice)
    {
        var deliveryFreePrice = parseInt($('input[name="totalDeliveryFreePrice"]').val());
        var deliveryPrice = 0;
        if (deliveryFreePrice > 0) {
            var deliveryAreaPrice = parseInt($('input[name="deliveryAreaCharge"]').val());
            var deliveryDcPrice = parseInt($('input[name="totalCouponDeliveryDcPrice"]').val());
            if (deliveryAreaPrice > 0) {
                deliveryPrice = deliveryPrice + deliveryAreaPrice;
            }
            if (deliveryDcPrice > 0) {
                deliveryPrice = deliveryPrice - deliveryDcPrice;
            }
        } else {
            var deliveryBasicPrice = parseInt($('input[name="totalDeliveryCharge"]').val());
            var deliveryAreaPrice = parseInt($('input[name="deliveryAreaCharge"]').val());
            var deliveryDcPrice = parseInt($('input[name="totalCouponDeliveryDcPrice"]').val());
            if (deliveryBasicPrice > 0) {
                deliveryPrice = deliveryPrice + deliveryBasicPrice;
            }
            if (deliveryAreaPrice > 0) {
                deliveryPrice = deliveryPrice + deliveryAreaPrice;
            }
            if (deliveryDcPrice > 0) {
                deliveryPrice = deliveryPrice - deliveryDcPrice;
            }
        }

        realSettlePrice = realSettlePrice - deliveryPrice;

        return realSettlePrice;
    }

    /**
     * 결제 페이지 호출 확인 후 결제
     */
    function pgSettleStartAfterCheck() {
        if (typeof pgSettleStart === 'function') {
            pgSettleStart();
        } else {
            console.log('pgSettle fail');
            return false;
        }
    }

    <!--{ ? (authData['useFl'] == 'y' && authData['useDataModifyFl'] == 'y') || (authData['useFlKcp'] == 'y' && authData['useDataModifyFlKcp'] == 'y') }-->
    $('#memberinfoApplyTr1').hide();
    $('#memberinfoApplyTr2').hide();
    $('#memberinfoApplyTr3').hide();
    <!--{ / }-->

    <!--{ ? isUseMultiShipping === true }-->
    var multiShippingPrice = function(deliveryPrice){
        if ($('input[name="multiShippingFl"]').prop('checked') === true) {
            var multiDelivery = 0;
            var multiShippingText = [];
            $('input[name^="multiDelivery"]').each(function(index){
                var value = $(this).val() ? $(this).val() : 0;
                var html = __('추가 배송지') + index + ' : ';
                if (index <= 0) {
                    html = __('메인 배송지') + ' : ';
                }
                multiShippingText.push(html + '{=gd_global_currency_symbol()}' + numeral(parseInt(value)).format() + '{=gd_global_currency_string()}');
                multiDelivery += parseInt(value);
            });
            $('.multi-shipping-text').html('(' + multiShippingText.join(', ') + ')');
        } else {
            $('.multi-shipping-text').empty();
            multiDelivery = deliveryPrice;
        }
        $('#totalDeliveryCharge').html(numeral(parseInt(multiDelivery)).format());
        $('input[name="totalDeliveryCharge"]').val(multiDelivery);

        return multiDelivery;
    }
    <!--{ / }-->

    var resetMileage = function() {
        var cartIdx = [];
        $('input[name="cartSno[]"]').each(function(idx){
            cartIdx.push($(this).val());
        });
        var param = {
            mode: 'set_mileage',
            cartSno: cartIdx,
            totalDeliveryCharge : $('input[name=totalDeliveryCharge]').val(),
            deliveryAreaCharge : $('input[name=deliveryAreaCharge]').val(),
            totalCouponOrderDcPrice: $('input:hidden[name="totalCouponOrderDcPrice"]').val(),
        };
        $.post('cart_ps.php', param, function(data){
            mileageUse = data.mileageUse;

            mileage_use_check('n', 'n', 'n');
        });
    }

    function set_delivery_visit() {
        var deliveryVisitFl = false;
        var deliveryVisit = 'n';
        var visitAddressUseFl;
        var $infoArea = $('.shipping-info-table');
        $.each($(".order-goods-layout"), function () {
            if ($(this).find('.delivery-method-fl').val() == 'visit' && $(this).find('.visit-address-use-fl').val() == 'y') {
                deliveryVisitFl = true;
                if (visitAddressUseFl !== false) {
                    visitAddressUseFl = true;
                } else {
                    visitAddressUseFl = false;
                }
            } else {
                visitAddressUseFl = false;
            }
        });

        if (deliveryVisitFl === true) {
            var deliveryMethodVisitArea = '';
            var defaultDeliveryMethodVisitArea = '';
            var deliveryMethodVisitCnt = 0;
            $.each($('.delivery-method-fl'), function(key, target){
                if ($(target).val() == 'visit') {
                    if (!deliveryMethodVisitArea && $.trim($('.delivery-method-visit-area').eq(key).val())) {
                        deliveryMethodVisitArea = defaultDeliveryMethodVisitArea = $('.delivery-method-visit-area').eq(key).val();
                    } else {
                        deliveryMethodVisitCnt++;
                    }
                }
            });
            if (deliveryMethodVisitCnt > 0) {
                deliveryMethodVisitArea = deliveryMethodVisitArea + ' 외 ' + deliveryMethodVisitCnt + '건';
            }

            if (visitAddressUseFl === true) {
                $('#visitMultiShippingFl').closest('span').removeClass('dn');
                $('.shipping-info-table:eq(0)').find('h2.my_tit:eq(0)').addClass('dn');
                $infoArea.find('.order-send').addClass('dn');
                deliveryVisit = 'y';
            } else {
                $('#visitMultiShippingFl').closest('span').addClass('dn');
                $infoArea.find('.order-send').removeClass('dn');
                deliveryVisit = 'a';
            }
            $infoArea.find('.order-visit').removeClass('dn');

            $('.delivery-method-visit-area-txt:eq(0)').html(deliveryMethodVisitArea);
            $('input[name="visitAddress"]').val(defaultDeliveryMethodVisitArea);
            $('input[name="visitName"]').val($('input[name="orderName"]').val());
            $('input[name="visitPhone"]').val($('input[name="orderCellPhone"]').val());
        } else {
            $('.shipping-info-table:eq(0)').find('h2.my_tit:eq(0)').removeClass('dn');
            $infoArea.find('.order-visit').addClass('dn');
            $infoArea.find('.order-send').removeClass('dn');
            deliveryVisit = 'n';
        }

        $('input[name="deliveryVisit"]').val(deliveryVisit);

        return deliveryVisit;
    }
    set_delivery_visit();

    function set_shipping_delivery_visit(shippingNo) {
        var deliveryVisitFl = false;
        var deliveryVisit = 'n';
        var visitAddressUseFl;
        var $infoArea = $('.shipping-info-table:eq(' + shippingNo + ')');
        if ($('input[name="selectGoods[' + shippingNo + ']"]').val()) {
            var data = $.parseJSON($('input[name="selectGoods[' + shippingNo + ']"]').val());

            for (var i in data) {
                if (data[i]['goodsCnt'] > 0) {
                    if (data[i]['deliveryMethodFl'] == 'visit' && data[i]['visitAddressUseFl'] == 'y') {
                        deliveryVisitFl = true;
                        if (visitAddressUseFl !== false) {
                            visitAddressUseFl = true;
                        } else {
                            visitAddressUseFl = false;
                        }
                    } else {
                        visitAddressUseFl = false;
                    }
                }
            }
        } else {
            $.each($(".order-goods-layout"), function () {
                if ($(this).find('.delivery-method-fl').val() == 'visit') {
                    deliveryVisitFl = true;
                    if (visitAddressUseFl !== false && $(this).find('.visit-address-use-fl').val() == 'y') {
                        visitAddressUseFl = true;
                    } else {
                        visitAddressUseFl = false;
                    }
                } else {
                    visitAddressUseFl = false;
                }
            });
        }

        if (deliveryVisitFl === true) {
            var deliveryMethodVisitArea = '';
            var defaultDeliveryMethodVisitArea = '';
            var deliveryMethodVisitCnt = 0;
            for (var i in data) {
                if (data[i]['goodsCnt'] > 0 && data[i]['deliveryMethodFl'] == 'visit') {
                    if (!deliveryMethodVisitArea && $.trim(data[i]['deliveryMethodVisitArea'])) {
                        deliveryMethodVisitArea = defaultDeliveryMethodVisitArea = data[i]['deliveryMethodVisitArea'];
                    } else {
                        deliveryMethodVisitCnt++;
                    }
                }
            }
            if (deliveryMethodVisitCnt > 0) {
                deliveryMethodVisitArea += ' 외 ' + deliveryMethodVisitCnt + '건';
            }

            if (visitAddressUseFl === true) {
                $infoArea.find('.order-send').addClass('dn');
                deliveryVisit = 'y';
            } else {
                $infoArea.find('.order-send').removeClass('dn');
                deliveryVisit = 'a';
            }
            $infoArea.find('.order-visit').removeClass('dn');

            $infoArea.find('.delivery-method-visit-area-txt').html(deliveryMethodVisitArea);
            $infoArea.find('input[name^="visitAddress"]').val(defaultDeliveryMethodVisitArea);
        } else {
            $infoArea.find('.order-visit').addClass('dn');
            $infoArea.find('.order-send').removeClass('dn');
            $('input[name^="visitName"]:eq(' + shippingNo + ')').val('');
            $('input[name^="visitPhone"]:eq(' + shippingNo + ')').val('');
            deliveryVisit = 'n';
        }

        if (shippingNo == 0) {
            $('input[name="deliveryVisit"]').val(deliveryVisit);
            $('input[name="visitName"]').val($('input[name="orderName"]').val());
            $('input[name="visitPhone"]').val($('input[name="orderCellPhone"]').val());
        }
        $infoArea.find('.shipping-delivery-visit').val(deliveryVisit);

        return deliveryVisit;
    }

    function set_shipping_btn(shippingNo, deliveryVisit) {

        switch (deliveryVisit) {
            case 'y':
                if (shippingNo == 0) {
                } else {
                    $('.shipping-remove-btn:eq(' + (shippingNo - 1) + ')').addClass('dn');
                    $('.shipping-visit-remove-btn:eq(' + (shippingNo - 1) + ')').removeClass('dn');
                }
                $('.shipping-info-table:eq(' + shippingNo + ') > .my_tit').addClass('dn');
                break;
            case 'a':
            case 'n':
                if (shippingNo == 0) {
                } else {
                    $('.shipping-remove-btn:eq(' + (shippingNo - 1) + ')').removeClass('dn');
                    $('.shipping-visit-remove-btn:eq(' + (shippingNo - 1) + ')').addClass('dn');
                }
                $('.shipping-info-table:eq(' + shippingNo + ') > .my_tit').removeClass('dn');
                break;
        }
    }

    // 14세 이상 동의 설정 사용 시 휴대폰 본인인증 호출
    function authCellPhone() {
        var protocol = location.protocol;
        var callbackUrl = "{=domainUrl}/member/authcellphone/dreamsecurity_result.php";
        window.open(protocol + "//hpauthdream.godo.co.kr/module/Mobile_hpauthDream_Main.php?callType=certGuest&returnUrl={=urlencode(returnUrl)}&shopUrl=" + callbackUrl + "&cpid={=authDataCpCode}&i=1");
    }

    // 14세 이상 동의 설정 사용 시 아이핀 본인인증 호출
    function authCellIpin() {
        window.open("/member/ipin/ipin_main.php?callType=certGuest&returnUrl={=urlencode(returnUrl)}");
    }
    //-->

    // 사은품 데이터갱신
    <!--{? gd_is_plus_shop(c.PLUSSHOP_CODE_GIFT) === true && giftConf.giftFl == 'y'}-->
    function addGift(originalOrderData) {
        var cartIdx = [];
        $('input[name="cartSno[]"]').each(function(idx){
            cartIdx.push($(this).val());
        });
        var presentInfoNo = $('input[name="presentInfoNo"]').val();
        var params = {
            mode: 'getGiftPresntInfo',
            cartIdx: cartIdx,
        };
        $.post('order_ps.php', params, function(data){
            if (data.giftInfo.presentInfoNo) {
                if (data.giftInfo.presentInfoNo != presentInfoNo) {
                    var params = {
                        mode: 'giftApplyOrder',
                        giftInfo: data.giftInfo,
                    };
                    $.post('order_ps.php', params, function(value){
                        alert(__('사은품을 확인해주세요.'));
                        $('input[name="giftCheckCnt"]').val('');
                        $('#add-gift').empty().append(value);
                        document.getElementById('add-gift').scrollIntoView();
                        $('input[name="presentInfoNo"]').val(data.giftInfo.presentInfoNo);
                    });
                    return false;
                }
            } else if (presentInfoNo) {
                if (confirm(__('쿠폰 적용 시 결제금액이 변경되어 선택하신 사은품은 수령이 불가합니다.\n쿠폰을 적용하시겠습니까?'))) {
                    $('#add-gift').empty();
                    $('input[name="presentInfoNo"]').val('');
                    $('input[name="giftSelectCnt"]').val('');
                    $('input[name="giftCheckCnt"]').val('');
                    return false;
                } else {
                    $('input[name="totalCouponOrderPrice"]').val(originalOrderData.totalCouponOrderPrice);
                    $('input[name="totalCouponOrderDcPrice"]').val(originalOrderData.totalCouponOrderDcPrice);
                    $('#useDisplayCouponDcPrice').text(numeral(originalOrderData.totalCouponOrderDcPrice).format());
                    $('input[name="totalCouponOrderMileage"]').val(originalOrderData.totalCouponOrderMileage);
                    $('#useDisplayCouponMileage').text(numeral(originalOrderData.totalCouponOrderMileage).format());
                    $('input[name="totalCouponDeliveryDcPrice"]').val(originalOrderData.totalCouponDeliveryDcPrice);
                    $('#useDisplayCouponDelivery').text(numeral(originalOrderData.totalCouponDeliveryDcPrice).format());
                    $('input[name="totalCouponDeliveryPrice"]').val(originalOrderData.totalCouponDeliveryPrice);
                    $('input[name="couponApplyOrderNo"]').val(originalOrderData.couponApplyOrderNo);
                    var params = {
                        mode: 'goodsCouponOrderApply',
                        cart: originalOrderData.couponApplyGoodsData,
                        cartIdx: cartIdx,
                    };
                    $.post('cart_ps.php', params, function (data) {
                        set_recalculation();
                        set_real_settle_price();
                    });
                }
            }
        });
    }
    <!--{ / }-->
</script>

{ # footer }
