{*** 회원 비밀번호 검증 | mypage/my_page_password.php ***}
{ # header }

<div class="login_bx v2">
    <p class="sns-message2">{messages['info']}</p>
    <form id="formFind" name="formFind" action="../member/user_certification.php" method="post">
        <fieldset>
            <legend>{=__('회원정보 변경')}</legend>
            <!--{ ? useAppleLogin }-->
                <div class="sns-box-img sns-apple"><img src="../img/etc/logo_apple.png" alt="{=__('애플 아이디 로그인')}"></div>
                <button type="submit" id="apple_btn" class="btn myp-password-btn js-btn-apple-login">{=__('인증하기')}</button>
                <div id="appleid-signin" style="display: none"></div>
            <!--{ : usePayco }-->
                <div class="sns-box-img sns-payco"><img src="../img/etc/logo-payco.png" /></div>
                <button type="submit" class="btn myp-password-btn js-btn-payco-login" data-payco-type="my_page_password">{=__('인증하기')}</button>
            <!--{ : useFacebook }-->
                <div class="sns-box-img sns-facebook"><img src="../img/etc/logo-facebook.png" /></div>
                <button type="submit" class="btn myp-password-btn js-btn-facebook-re-auth" data-sns-type="my_page_password" data-re-authentication-url="{=facebookReAuthenticationUrl}">{=__('인증하기')}</button>
            <!--{:useNaver}-->
                <div class="sns-box-img sns-naver"><img src="../img/etc/logo-naver.png" alt="{=__('네이버 아이디 로그인')}" /></div>
                <button type="submit" class="btn myp-password-btn js-btn-naver-login" data-naver-type="{=naverType}">{=__('인증하기')}</button>
            <!--{:useKakao}-->
            <div class="sns-box-img sns-kakao"><img src="../img/etc/logo-kakao.png" alt="{=__('카카오 아이디 로그인')}" /></div>
            <button type="submit" class="btn myp-password-btn js-btn-kakao-login" data-return-url="/mypage/my_page.php" data-kakao-type="{=kakaoType}">{=__('인증하기')}</button>
            <!--{:useWonder}-->
            <div class="sns-box-img sns-wonder"><img src="../img/etc/logo-wonder.png" alt="{=__('위메프 아이디 로그인')}" /></div>
            <button type="submit" class="btn myp-password-btn js-btn-wonder-login" data-return-url="/mypage/my_page.php" data-wonder-url="{=wonderReturnUrl}" data-wonder-type="{=wonderType}">{=__('인증하기')}</button>
            <!--{:useGoogle}-->
            <div class="sns-box-img sns-google"><img src="../img/etc/logo-google.png" alt="{=__('구글 아이디 로그인')}" /></div>
            <button type="submit" class="btn myp-password-btn js-btn-google-login" data-return-url="/mypage/my_page.php" data-google-type="{=googleType}">{=__('인증하기')}</button>
            <!--{ : }-->
                <div class="input-block a h30">
                    <span class="label"><b>{=__('아이디')}</b></span>
                    <span class="value"><b class="c-red">{data['memId']}</b></span>
                </div>
                <div class="inp_tx">
                    <label for="findPassword" class="blind">{=__('아이디')}</label>
                    <input type="password" name="findPassword" id="findPassword" placeholder="{=__('비밀번호')}" />
                </div>
                <p class="dn caution-msg1">{=__('비밀번호가 일치하지 않습니다.')}</p>
                    <button type="submit" class="btn myp-password-btn">{=__('인증하기')}</button>
            <!--{ / }-->
        </fieldset>
    </form>
</div>
<script type="text/javascript">
    $(document).ready(function() {
        $('#formFind').validate({
            dialog: false,
            rules: {
                findPassword: {
                    required: true
                }
            },
            messages: {
                findPassword: {
                    required: "{=__('패스워드를 입력해주세요.')}"
                }
            }, submitHandler: function (form) {
                var $target = $(':password#findPassword', form);
                if (!_.isEmpty($target.val())) {
                    var $ajax = $.ajax('../mypage/my_page_ps.php', {
                        type: "post", data: {
                            memPw: $target.val(),
                            mode: "verifyPassword"
                        }
                    });
                    $ajax.done(function (data, textStatus, jqXHR) {
                        console.log('gd_member ajax', data, textStatus, jqXHR);
                        var code = data.code;
                        var message = data.message;
                        if (_.isUndefined(code) && _.isUndefined(message)) {
                            top.location.href = "../mypage/my_page.php";
                        } else {
                            $(form).find('.caution-msg1').removeClass('dn').text(message);
                        }
                    });
                }
            }
        });

        <!--{ ? useAppleLogin }-->
        $("#apple_btn").on("click", startClicked);
        function startClicked(){
            $("#appleid-signin").click();
        }
        <!--{ / }-->
    });
</script>

<!--{ ? useAppleLogin }-->
<script type="text/javascript" src="https://appleid.cdn-apple.com/appleauth/static/jsapi/appleid/1/en_US/appleid.auth.js"></script>
<script type="text/javascript">
    AppleID.auth.init({
        clientId : '{client_id}',
        scope : 'name email',
        redirectURI: '{redirectURI}',
        state: '{state}',
        // usePopup: true
    });
</script>
<!--{ / }-->
{ # footer }
