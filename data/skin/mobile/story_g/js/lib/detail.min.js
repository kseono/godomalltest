$(function(){var j={infoBn:$(".cont_detail .btn_info"),infoLayer:$(".cont_detail .ly_info"),reviewExpandBn:$(".detail_review .btn_more"),addWishBn:$(".ly_buy_all button"),accordianLst:$(".detail_sub_lst > li"),accordianOverseaLst:$(".detail_glblst > li").not(":eq(0)"),reviewBx:$(".detail_review"),infoTextBx:$(".detail_infotext"),buyDisplayBn:$(".ly_detail_buy .btn_buy"),buyBx:$(".ly_detail_buy .ly_buy"),buyInnerBx:$(".ly_detail_buy .ly_buy .ly_buy_info"),buyBn:$("#btn-buy"),childSelect:$(".option_child_select"),cartBn:$("#btn-cart"),toastPayBn:$("#btn-tstbuy"),reviewMoreBn:$(".review_more button"),reviewMoreCurrent:$(".review_more .current_num")};if(j.childSelect.length){j.childSelect.on("change",function(q){prepareOrder.viewSubOption(goods_no,goods_sub,$(this).val(),option_cnt,select_option)});if(j.childSelect.val()!=""){j.childSelect.trigger("change")}}j.infoBn.on("click",function(q){if($(this).hasClass("selected")){$(this).removeClass("selected");j.infoLayer.hide()}else{$(this).addClass("selected");j.infoLayer.show()}});if(j.accordianOverseaLst.length){j.accordianOverseaLst.find("a").on("click",function(q){if($(this).is("a")){q.preventDefault()}if(q.isTrigger&&$(this).siblings("div").is(":visible")){return}$(this).parent("li").toggleClass("selected");if($(this).parent("li").hasClass("selected")){$(this).siblings("div").show()}else{$(this).siblings("div").hide()}})}j.accordianLst.find(">a,>.js_accordian").on("click",function(q){if($(this).is("a")){q.preventDefault()}if($(this).hasClass("disabled")){return}if(q.isTrigger&&$(this).siblings("div").is(":visible")){return}$(this).parent("li").toggleClass("selected");if($(this).parent("li").hasClass("selected")){$(this).siblings("div").show()}else{$(this).siblings("div").hide()}});var k=function(q){var s=$(q).offset(),r=$("body").scrollTop();return s.top-92};j.infoLayer.find("a").click(function(q){q.preventDefault();if($(this).attr("data-toggle")!="modal"){$($(this).attr("href")+" > a:first").trigger("click");$($(this).attr("href")+" > div.js_accordian").trigger("click");if($(this).find(">span").text()!="(0)"){j.infoBn.trigger("click");$("body").animate({scrollTop:k($(this).attr("href"))},"fast")}}});$(document).on("click",j.reviewExpandBn.selector,function(q){q.preventDefault();$(this).parent("li").toggleClass("selected")});var n=0,h=false,l=false;var e=_.template($("#templateGoodsReviewRow").html());var f=_.template($("#templateGoodsQnaRow").html());var m={page:2};function c(){h=true}function a(s,y){var v,u,x,z,w;l=(s.page_list.current_page==s.page_list.total_page||!s.page_list.list.length);n=s.total;w="";for(v=0,u=s.list.length;v<u;++v){x=s.list[v];x.goods_no=s.goods_no;x.goods_sub=s.goods_sub;if(y=="detail-qna"){x.real_user_id=s.user_id;z=f(x)}else{z=e(x)}w+=z}var r=parseInt($("#"+y).find(".review_more .current_num").text())+5,q=parseInt($("#"+y).find(".review_more .total_num").text());$("#"+y).find(".detail_review>ul").append(w);if(r>q){$("#"+y).find(".review_more .current_num").text(q)}else{$("#"+y).find(".review_more .current_num").text(r)}}function i(){h=false}function p(u,r,t){var q=(t=="detail-review"?"estimate_list":(t=="detail-qna"?"qa_list":"photo_estimate_list")),s=((parseInt($("#"+t).find(".review_more .current_num").text())/5)+1);Net.ajax("/api/"+q+"/"+goods_no+"/"+goods_sub+"/"+s,null,{start:function(){u()},success:function(v){a(v,t)},fail:function(v,w){m.page--;alert("["+v+"]"+w)},end:function(){r()}})}j.reviewMoreBn.on("click",function(r){r.preventDefault();if(h||l){return}var t=$(this).parents("li").attr("id"),q=numeral().unformat($("#"+t).find(".review_more .current_num").text()),s=numeral().unformat($("#"+t).find(".review_more .total_num").text());if(s>q){p(c,i,t);m.page++}});if($("#detail-relative-goods").length){var b=function(){return Math.abs(window.orientation)===90?3:2};if($("#pagination-goods-relative li").length>b()-1){var o=new Swiper("#goods-relative",{wrapperClass:"plst",slideClass:"lstbx",loop:false,autoplay:0,grabCursor:true,slidesPerView:b(),slidesPerGroup:b(),paginationAsRange:false,calculateHeight:true,createPagination:false,pagination:"#pagination-goods-relative",paginationClickable:true,onFirstInit:function(q){var s="";var v=b();var t=parseInt(Math.ceil(q.slides.length/v),10);var u=parseInt((q.activeIndex/v)+1,10);for(var r=0;r<t;r++){s+="<li "+((r/b())+1==u?'class="selected"':"")+'><span class="sp">상품이미지 '+r+"</span></li>"}$("#pagination-goods-relative ul").empty().html(s)}});o.addCallback("SlideChangeEnd",function(q){var r=Math.ceil($(q.activeSlide()).data("index")/b());$(q.paginationContainer).find("li").removeClass("selected");$(q.paginationContainer).find("li:eq("+r+")").addClass("selected")});o.addCallback("Init",function(q){q.fireCallback("FirstInit",q)});$(window).bind("ps.orientation",function(q){o.params.slidesPerView=b();o.params.slidesPerGroup=b();o.reInit()})}else{$("#pagination-goods-relative li").hide()}}j.addWishBn.on("click",function(q){q.preventDefault();prepareOrder.addWishList(option_cnt,goods_no,goods_sub,first_option_cnt)});j.buyDisplayBn.on("click",function(q){q.preventDefault();j.buyBx.css({display:"-webkit-box"});setTimeout(function(){$("html,body").css({overflow:"hidden"});$("#wrap").css({overflow:"hidden"});$("#container").css({height:$(window).height(),overflow:"hidden"});if($(window).height()<j.buyInnerBx.height()){j.buyInnerBx.css({height:$(window).height()-20,overflow:"auto"})}},1)});j.buyBx.on("click",function(r){var q=$(r.target);if(q.context.className=="ly_buy"){j.buyBx.find(".bn_cls").trigger("click")}});j.buyBx.find(".bn_cls").on("click",function(q){$("html,body").css({overflow:"inherit"});$("#wrap").css({overflow:"inherit"});$("#container").css({height:"inherit",overflow:"inherit"});j.buyBx.hide();setTimeout(function(){$("input[name=qty]").blur();$("select[name=option1]").quickChange(function(){});$("select[name=option2]").quickChange(function(){});j.buyInnerBx.css({height:"auto",overflow:"inherit"})},1)});j.cartBn.on("click",function(q){q.preventDefault();prepareOrder.addCart(option_cnt,goods_no,goods_sub,first_option_cnt)});j.buyBn.on("click",function(q){q.preventDefault();prepareOrder.directOrder(option_cnt,goods_no,goods_sub,first_option_cnt)});j.toastPayBn.on("click",function(q){q.preventDefault();prepareOrder.directOrder(option_cnt,goods_no,goods_sub,first_option_cnt,"payco")});$(".ipt_mnt .bn_up").on("click",function(q){prepareOrder.changeQty(option_cnt,goods_no,goods_sub,"plus")});$(".ipt_mnt .bn_down").on("click",function(q){prepareOrder.changeQty(option_cnt,goods_no,goods_sub,"minus")});$(".ipt_mnt input[name=qty]").on("keyup",function(q){var r;r=$(this).val();if(r>0){console.log(r);prepareOrder.inputQty(goods_no,goods_sub,r)}});$(".ipt_mnt input[name=qty]").on("keypress",function(q){if(q.which!=8&&q.which!=0&&(q.which<48||q.which>57)||(q.which==48&&!$(this).val())){return false}else{$(".ipt_mnt input[name=qty]").trigger("keyup")}});var g=function(v,u,t,s,r){var q=new Array();var u=encodeURIComponent(u);var t=encodeURIComponent(t);var s=encodeURIComponent(s);var r=encodeURIComponent(r);q.t="https://twitter.com/intent/tweet?text="+t+"&url="+s;q.f="http://www.facebook.com/sharer.php?u="+s+"&t="+t;q.m="http://me2day.net/plugins/mobile_post/new?new_post[body]="+t+'+++["'+u+'":'+s+"+]&new_post[tags]="+r;q.y="http://yozm.daum.net/api/popup/prePost?sourceid="+s+"&prefix="+t;window.open(q[v])};var d=function(t,s,r,q){Kakao.init("ccab7ac0250164db219e3989706fa01d");Kakao.Link.sendTalkLink({label:s,image:{src:q,width:"500",height:"500"},webButton:{text:"상품바로가기",url:r},fail:function(u){alert("해당 기기는 카카오링크를 지원하지 않습니다.")}})};$(".ly_share li a").on("click",function(q){if($(this).find(".ico").hasClass("ico_tw")){g("t",title,goodsName,goodsUrl,"")}else{if($(this).find(".ico").hasClass("ico_fb")){g("f",title,goodsName,goodsUrl,"")}else{if($(this).find(".ico").hasClass("ico_kt")){d(title,goodsName,goodsUrl,goodsImgUrl)}}}});$(".js_bn_back").on("click",function(q){q.preventDefault();history.back()})});